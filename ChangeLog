commit 48d4b0ae50affd7fa442271046eefba74de7ff2c
Author: Jesse Barnes <jbarnes@virtuousgeek.org>
Date:   Wed Aug 20 15:06:36 2008 -0700

    Don't disable planes in i830_update_dsparb
    
    We need to program DSPARB with only one plane enabled at most, and that's
    guaranteed to be the case when we're called during mode set, so just assert
    that case but otherwise leave the planes alone to avoid flicker on active
    displays during output detection for example.
    
    Fixes bug #17050.
    (cherry picked from commit 5af504166f14f4401818f3b7c27ac2ccba7b9ff5)

commit 7fbbafc8fc2b027ec12215ce13d814e339d01a68
Author: Julien Cristau <jcristau@debian.org>
Date:   Wed Aug 20 15:33:59 2008 +0800

    Don't skip the checks for DRI headers with --enable-dri
    (cherry picked from commit 5eccb5ec7ea78b5800f98decd4216d39b9ebe5ec)

commit dc295d2b3cbdc5b4ca1f46b1c5a8e5f83faeb878
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Tue Aug 19 16:27:12 2008 +0800

      Fix from He Shuang(shuang.he@intel.com),
      XvMCDestroyContext to check pointer valid
    (cherry picked from commit 385dc85881c56e218e7d17d7e1d022568aa29cfb)

commit 70e85e6ce4cd53ab4685440605fcfe65995cb2e4
Author: Jesse Barnes <jbarnes@virtuousgeek.org>
Date:   Mon Aug 18 12:53:33 2008 -0700

    Remove unused VBIOS flag defines
    
    We just use the structure definitions now.
    (cherry picked from commit 078a59dd48ed00a6512d155883956c18752da9ce)

commit 76b19eaaf591f7f55aaa00cf0fd90d9574c500d2
Author: Jesse Barnes <jbarnes@virtuousgeek.org>
Date:   Mon Aug 18 12:51:31 2008 -0700

    Pack bdb_general_definitions block
    
    More correct & consistent with other definitions.
    (cherry picked from commit 7048141254b7c1948fe77b1742b463f8723610d8)

commit d5fd845aab4074ed6d0950551e007ea43fd2d0df
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Aug 19 07:30:01 2008 +0800

    Fix reverted LVDS bios capability dword definition
    
    Issue found by Peter Clifton.
    (cherry picked from commit 0e6759bb6ad7293b6447bd20e3d7d8fdee46aba7)

commit 4281b0116b8aa7201f523c21abf91f63e12cbccf
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Aug 15 13:05:06 2008 +0800

    Bump version 2.4.1

commit 01bbdbc6d83a526654abf501bd6cd203f8373774
Author: Alan Coopersmith <alan.coopersmith@sun.com>
Date:   Thu Jul 31 20:02:21 2008 -0700

    Man page typo fixes
    (cherry picked from commit 27e9506fda86e90fd67de1715fa32d23aaa8a683)

commit 4ac91c2eb6b539fa23d218ca714cadf998ae8eb6
Author: Jesse Barnes <jbarnes@eee.(none)>
Date:   Thu Jul 31 19:21:36 2008 -0700

    Update man page
    
    Add example dual head config, add info on bug reporting.
    (cherry picked from commit da2eb83fb9a52291ea98f3285aee7bee2d55e0ca)

commit 280be2a193063c9e2f062cbab9fa967a408dc290
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Aug 15 10:10:43 2008 +0800

    Always check and free driver private in LVDS destroy
    (cherry picked from commit ed7269e0a377b3135b06cacecc59119f06958feb)

commit 1f558fab4eef3b54de4853bc5247fbd0d24b68bf
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Aug 15 10:02:44 2008 +0800

    Make skip_panel_detect clear for its meaning
    (cherry picked from commit f4cb9a135dca9279af8186a9b18bf62ef7351019)

commit 532e47a4a169e829ad34fdc8bb85e4eb81721af3
Author: Jesse Barnes <jbarnes@virtuousgeek.org>
Date:   Thu Aug 14 16:02:37 2008 -0700

    Fix pipe A force quirk
    
    Last commit introduced a logic buglet, we went from (foo & BLAH) -> (!foo &
    BLAH) rather than !(foo & BLAH), so fix it up to make my laptop work again.
    (cherry picked from commit 22918f62c89a4314fb5d01c58f22fee5b9a15a27)

commit ac740398569dfa02d3d26a2abeb5c848717e6c03
Author: Olivier Fourdan <ofourdan@redhat.com>
Date:   Mon Aug 11 12:07:32 2008 -0400

    Fix DPMS off in the presence of the pipe A quirk.
    
    Still turn off the VGA plane, and also handle the DRI path at the end.
    (cherry picked from commit 9ec36e0c8bd8a4bd7c40569412fc1a21219b5af9)

commit 9b03fd49b0f27c9add19dece55d00a58ed73c978
Author: Olivier Fourdan <ofourdan@redhat.com>
Date:   Mon Aug 11 11:30:51 2008 -0400

    Apply pipe A quirk to 845 as well.
    (cherry picked from commit 445c2e9ef8fc1d49bbb03e07bf36e0339be16a80)

commit d1b47cf0cb66fb1b7c991fbd4f4518c6ccdbc643
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Aug 8 16:35:25 2008 -0700

    Set lvds_ddc_mode before use to avoid a segfault on mac mini.
    (cherry picked from commit fe90c0522f65f60c4c431787c889b7fb639ab61b)

commit 86b10601e8798974240ae17539b413c1798d34e1
Author: Jesse Barnes <jbarnes@jbarnes-t61.(none)>
Date:   Tue Aug 5 13:37:38 2008 -0700

    Reorganize VBIOS code
    
    Make VBT parsing happen at driver init time rather than in each output init
    function, to save time and better separate VBIOS code into i830_bios.[ch].  The
    changes end up touching the output files due to field name changes, and allow
    us to reorder & simplify our LFP mode detection code.
    (cherry picked from commit a21d4794b6812ce05d08f06dc47b26c4fb1c1fef)

commit 81bd24d8b1a3cdb8a539f4ca0c5f546e4c8070ed
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Aug 11 15:16:44 2008 +0800

    Fix possible spurious interrupts in hotplug detect on 4 series chip
    (cherry picked from commit d592eabc806b752053ade3c18e9dd8e0f39b45a3)

commit 02844d4dc0995f07dd438997ecc39bd9e3c4779b
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Aug 11 15:16:09 2008 +0800

    Disable display clock gating for 4 series chips
    (cherry picked from commit d0018a96064ee0adfe87c2d50c341bf7d2e45eb0)

commit 2b0705993a151b24c82d7955eed1c9c17ee0d8bd
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Aug 6 16:19:29 2008 +0800

    Fix SDVO HDMI encoding detect (#16920)
    
    Check return value of get supported encode command and current
    encoding mode, which could be DVI or HDMI.
    (cherry picked from commit f91134795b545c8baebf218975b261c76a0e5873)

commit 6aeea1a7abd05745fab666b8fadab94caed6d53a
Author: Julien Cristau <jcristau@debian.org>
Date:   Mon Aug 4 12:18:12 2008 +0200

    Fix up the HP Pavilion ze4944ea quirk
    
    The chip is 855GM, not GM45.
    (cherry picked from commit 1a59cc6b9acf312de1755d67757bf7f1967342e4)

commit dbb288d55a071a44eed1c9e21f5f835f416327be
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jul 31 16:59:43 2008 +0800

    Fix SDVO reg definition
    
    Remove wrong set tv resolution command, adding HDMI regs in dump.
    (cherry picked from commit 76eb8e6f1f0c6962b23550564f4273f392567857)

commit 01bbbd8c6c73229b5cb0c88e8eb2ac9b49a5dad8
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jul 31 13:13:45 2008 +0800

    Don't program dsparb on new Intel chip
    
    On new chip, DSPARB is controlled by hardware only.

commit 42e96f1d02ef6d842db6ba68353558a11d7d66e9
Author: Tomas Carnecky <tom@dbservice.com>
Date:   Sun Jun 15 14:27:16 2008 +0200

    Reorder visuals reported by the intel driver
    
    The root window visual can not be changed. Neither at runtime nor
    through the configuration file. The xserver simply selects the first one
    that matches the class (usually TrueColor). I need a root window visual
    with stencil buffer because my compiz plugin uses the it for some
    operations. This patch reorders the visuals that the 3D driver reports
    and puts the one with stencil (and depth) bits as first.
    (cherry picked from commit 42fb06f3f14fbec070350cf48361be4a0be0af04)

commit c0c63c9d8329d93288dc12a05fe0ba3cf71fd5af
Author: Jesse Barnes <jbarnes@hobbes.lan>
Date:   Thu Jul 31 13:07:20 2008 -0700

    Update DSPARB while planes are still off
    
    This avoids the flickering people reported in the 2.4.0 release.

commit f3b72c59e5000bcdb07cbdf080e09c55b9826eff
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jul 23 16:02:02 2008 +0800

    Bump version 2.4.0

commit 5c447fa50ecd4fe7f971b1e6deb8908e98afa61b
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jul 23 15:10:07 2008 +0800

    shut up gcc warning
    (cherry picked from commit 6ac352f146bafe3b4bb5832340eb0ccb730565d2)

commit e6d0586db95cab1cdf2f8485a1a1a895f18118e4
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jul 23 15:07:48 2008 +0800

    Fix distcheck for clean doltcompile
    (cherry picked from commit 075cf7fce57da4e51acafb3bfd3d61ba1a8096d5)

commit fe9fba38e9c4bdb1b242760b9e565852f717de09
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jul 23 11:16:14 2008 +0800

    Fix HDMI output number
    
    Output 33 is confusing.
    (cherry picked from commit 29d982c6bf873c6685bd0e395a8b0e5e3b1063e0)

commit 3f5c9bd512907238a2fd6746a41d8703aefe39e9
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 6 13:59:06 2008 -0800

    Add little hotplug detector app.
    (cherry picked from commit b60bbbfd7b7dcf31726ad615a493f34f17cc6309)

commit 202811e253be85c4415bba3eaae13508b1e2ce71
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 6 14:00:18 2008 -0800

    Remove VGA regs from debug output.
    (cherry picked from commit 52a414d1158aa7512fb79560dc220e2a78456a2d)

commit b9250913ab57ecade1c3011415c666e8516fce47
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jul 22 15:29:34 2008 +0800

    Bug #16801: fix X crash when NoAccel on 965
    (cherry picked from commit fd060ce89d86f6e8ff742d5b287abe8ecea32927)

commit 0403234dd1cdf4aa02709c1fbd815f002e1ace63
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jul 22 15:14:14 2008 +0800

    only check pipe underrun if vtSema is true.
    (cherry picked from commit 577c4d1a0c753fb46d43be05a9781d2e204fac45)

commit e7533a253178a867a9ad37f5fd3789b21ff38162
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jul 22 15:08:57 2008 +0800

    SSC is LVDS only
    
    Fix regression on my 855GM for VGA output.
    (cherry picked from commit 04bbed2248e3e8f86efd64225abf2db8eb552653)

commit 7f040c63bbfef0b577eeac2052c1951bdbfa3386
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jul 22 10:51:01 2008 +0800

    Check underrun on enabled pipe
    (cherry picked from commit 7defa4f1f0eba82f39e74f96d2ad7ed2481b537e)

commit 06c5a72a496fabace408fbb8733f299a408d1c7c
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jul 22 09:51:54 2008 +0800

    Thinkpad R60e TV quirk via DMI info
    (cherry picked from commit b7765b0837af4cc80f1257ba04495140ef5d536e)

commit 13959ee3984d5f34c976287c8f5406393ceacc30
Author: Jesse Barnes <jbarnes@hobbes.lan>
Date:   Mon Jul 21 11:48:38 2008 -0700

    Add no LVDS quirk for Transtec Senyo 610 mini PC
    
    Fixes FDO #16757.
    (cherry picked from commit ed0fbd016b8fbcf01eddfd17fd25e745e7af2ba4)

commit fe4e1376dbb143665d7d98b04cd9ee2309911b54
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Jul 18 14:50:08 2008 -0700

    Fix distcheck.
    (cherry picked from commit 62a037b0585d6ecb43daac9d4eb0927a4618a367)

commit c5df5912025b432476d9c8bcafd669974ec296c7
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Jul 18 14:56:18 2008 -0700

    Fix uninitialized-use warning in i830_debug.c ring dumping.
    (cherry picked from commit 3cbfc6c76bcd2bc9194a944092f6ce0881ff9da2)

commit 139659f722c20525bb24879528dc90e0e09af49f
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Jul 18 14:53:26 2008 -0700

    Get prototype for i830_bios_get_tv().
    (cherry picked from commit 1b1c4975768f63ed0f3933ec384d24c324a383b3)

commit 37848925c4557385f154443ffbb917a8203506f8
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Thu Jul 17 14:41:51 2008 -0700

    Choose a split for DSPARB based on the configured modes for both planes.
    
    Previously, we were attempting to give both planes equal space in the FIFO
    to be fair.  However, larger modes require more fifo space, so split it based
    on the relative HDisplay of the modes.  This should resolve some fifo underrun
    issues with differently-sized displays, or single large ones.
    
    Bug #16169.
    (cherry picked from commit b8ca1c747a679c931267363639fc0bc690cae2d6)

commit 91cbb5b8ad1fbc22dd77c0329fc3962b1ca99b9e
Author: Jesse Barnes <jbarnes@hobbes.lan>
Date:   Thu Jul 17 12:30:57 2008 -0700

    Don't disable pipe A on 855 chips
    
    It needs to stay enabled or we may see hangs when trying to re-enable it (say
    at VT switch time).
    
    Fixes FDO bug #15168.
    (cherry picked from commit b37a2a8ca82279468e3806dcf77d5fa7bdd0e874)

commit a0e7b79b34940d646949512bd24c96372031888d
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jul 16 10:45:28 2008 +0800

    Only initialize integrated TV encoder for mobile chips
    (cherry picked from commit c4565a9811487402d899d0933cc63e27ffe1ff08)

commit a4845dcdcb9b7becf8e47d3a781ecce74527d7c0
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jul 15 13:35:21 2008 +0800

    xvmc: use vector based structure
    
    This is more clear to read MV components.
    (cherry picked from commit bca316863b79148b2f51a97d58b94e52ba3eae9f)

commit 607a68a81d28d49ebcb0f6a8b9267f1d85d7bac5
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jul 15 13:29:33 2008 +0800

    move FBC register dump out of display registers
    
    This makes it easier to read.
    (cherry picked from commit 0c67219d0e6cfc858af2eb375c2f9473d0f6db60)

commit 5d0f981ee00fbcdee44d38d94acfd2c68f9082d3
Author: lipeng <peng.li@linux.intel.com>
Date:   Tue Jul 15 10:26:33 2008 -0700

    Fix GPIO pin usage for DDC on second HDMI port.
    (cherry picked from commit a76ae7cab3001ce6639ae23fb0769c4e46b57e71)

commit 4709bf48bdc61666fcdf0e13e863f1f5f9131882
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jul 14 13:43:31 2008 -0700

    Fix DSPARB setting on 845/865, which have only the AEND field and 96 entries.
    (cherry picked from commit 5054a86b1b362f3f63310afb9ef2d37c9f1cfca5)

commit 0a7b753d70e1fd494430c496e19fb672258b5ac6
Author: Julien Cristau <jcristau@debian.org>
Date:   Fri Jun 6 13:40:20 2008 +0200

    Link the driver with -lpciaccess and -ldrm if needed
    
    This makes sure the driver ends up with a DT_NEEDED reference to
    the libraries it's using.
    (cherry picked from commit 8ac00ca97995e36514ff593fec3c0f0d316ed138)

commit b27776f498c23787629a229f5d9c07eb3b383333
Author: Julien Cristau <jcristau@debian.org>
Date:   Sun Jul 6 12:00:52 2008 +0200

    Fix gen4asm rule to work with a build dir
    (cherry picked from commit d61182511b1520b04133d28480e1ffaacbaeb753)

commit 618968c3dc88b16b079061066c5772754ebeaa26
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Jul 7 15:58:27 2008 -0700

    Use up to 256 separate vertex buffers
    
    This allows us to only call i830WaitSync once every 128 calls to composite
    rather than on every call. However, we do need to also call MI_FLUSH to
    avoid the vertex cache getting in our way, (since our "separate" buffers
    are all allocated as one contiguous chunk).
    (cherry picked from commit 757c00927a6f5760135136450b8d02d0f999ac1c)

commit bfcc2957023f74e8167f9c501245492feaa5ae76
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Jul 7 14:01:15 2008 -0700

    Allow for multiple vertex buffers (though only use one for now)
    
    Using more than one (in the future) will allow for doing less frequent calls
    to i830WaitSync.
    (cherry picked from commit 0c548cd040d0c5e1812470ccdf6de86b6a2926d7)

commit 7dfebaa4f749869914feb1db9a2fa1ab9762c640
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Jul 7 13:25:42 2008 -0700

    Move VERTEX_BUFFERS setup from prepare_composite to composite
    
    This is in preparation for having larger (or multiple) vertex buffers
    in the future.
    (cherry picked from commit cc2249333cd462b4d99d110a12c454ca141b2be8)

commit 891a25c2f7b24668dff59940d0b989a5cd23478f
Author: Jesse Barnes <jbarnes@jbarnes-t61.(none)>
Date:   Thu Jul 10 12:57:25 2008 -0700

    Add VBIOS based TV connector detection
    
    Now that the VBIOS code supports it, we can use the general features block to
    detect whether a TV connector is present on a given platform.
    
    Reviewed by Nanhai Zou.
    (cherry picked from commit 3c0f2bcc9965155fecab606edae68874427d3423)

commit e1ef5fc04907e02a38c518c868f39a897f81cd1e
Author: Jesse Barnes <jbarnes@jbarnes-t61.(none)>
Date:   Thu Jul 10 12:55:12 2008 -0700

    Improve VBIOS feature detection, add SSC support
    
    Improve the VBIOS feature detection and use it to find whether the platform
    supports spread spectrum clocking.  Use the specified reference clock, but
    disable SSC if multiple heads are active, since it can cause problems in cloned
    configurations.
    
    Reviewed by Nanhai Zou.
    (cherry picked from commit e00d9435609bcff1afb71aa6638a6b42a64f5178)

commit 7d1aa118a24195833466a4a4342c71f37db673f8
Author: Jesse Barnes <jbarnes@jbarnes-t61.(none)>
Date:   Mon Jul 7 10:48:56 2008 -0700

    Improve FBC size checking
    
    In hindsight, this is obvious, since nowhere do we tell the FBC unit how much
    memory it has available.  We need to make sure the compressed buffer is big
    enough to handle the uncompresed buffer, both in terms of vertical size and
    total framebuffer size, or the compressor could overwrite the memory
    immediately following the compressed buffer.
    (cherry picked from commit 7332132a79e5b5c208d43e93dfe0c8b12eb1728d)

commit 92ec2fc750ce17b1ec36493e8d731ef4b0bb772d
Author: Stefan Dirsch <sndirsch@suse.de>
Date:   Thu Jul 3 23:12:13 2008 +0200

    Add pipea force enable quirk for another 855GM machine.
    
    Fixes Novell Bug #406123, thanks Christoph.
    (cherry picked from commit f2ec3fd8f2c63b1bc0745802dcf737eda4bb42b6)

commit 483cba52ef62565fff3b21eb8ca2b00ab3075fa6
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jul 3 01:03:14 2008 +0800

    Fix official name for GM45 chipset
    (cherry picked from commit a34a4e3f6420e2b06bbdaa124fe0ccb1bc6a0bd9)

commit cb4c1fa7499d82beb01566aaf1f323a03ebc1ae4
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jul 2 11:12:54 2008 +0800

    Give asus and eeepc backlight method higher priority
    
    On #16418, Evgeniy Manachkin <sfstudio@mail.ru> reported that
    last asus and eeepc backlight patch is wrong, as acpi_video0 method
    will take priority and doesn't work.
    (cherry picked from commit 6506ac7aa008436158db4f4196802cab462f3446)

commit 1bfafe075b1db12d42ce40393d0be2137644489a
Author: Dave Airlie <airlied@linux.ie>
Date:   Tue Jul 1 18:51:18 2008 +1000

    intel: fix drm check.
    
    The -mm check is broken now that 2.3.1 is out.. make it 2.4.0, to be fixed
    with GEM etc.
    (cherry picked from commit 55678c64bc6e3ed613ea6db14c105c18a0cf28ce)

commit 696f9783cc0e269ac8c5c65d8889f22524b5c5e4
Author: Roland Test-tools Bär <roland@verifysoft.de>
Date:   Mon Jun 30 10:32:42 2008 -0700

    i810: Remove an effectively unused variable (only used in an incorrect free())
    
    Bug #15401.
    (cherry picked from commit 0597d94001afe0a9a34104285ce4dffc75b68071)

commit 8fea51cf37c613881a2655ea7a57a5b500b63770
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Jun 27 11:21:59 2008 +0800

    Fix SDVOC typo
    (cherry picked from commit 37661d916e8384f537d5ed8cbec66a93795c6a05)

commit 6b661fd325408156d563e192d0ea3456b77c1256
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Jun 27 09:54:35 2008 +0800

    xvmc: fix motion_type dump for frame/field picture
    (cherry picked from commit 7834a3b118ae4e034f064257762d5c25ada5fe52)

commit ed051008e77536dc3ab55b1343d0248f121416c1
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Jun 27 09:39:02 2008 +0800

    xvmc: Don't copy on xvmc surface in PutImage
    
    As xvmc rendering result has already been in fb, we shouldn't
    do extra copy on it. Although special care is required for i915
    xvmc surface pitch alignment, which must be at least 1KB aligned.
    So video display function should take it into acount instead of
    always setting Y pitch to be double of U/V pitch.
    (cherry picked from commit 989ec9e8a69f909cb64f17e4465982613b4b054d)

commit eae16b3b3e46177f882555c15751ff1219701e7c
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jun 26 14:22:34 2008 +0800

    xvmc: enlarge batch buffer size
    (cherry picked from commit 550082070a3fdb951e3cf08974dc56276c0a739c)

commit a5867a55abca1d16ff57c0e39008e7c7738a724c
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jun 26 14:20:05 2008 +0800

    xvmc: only allocate memory requiring physical address on 915G
    
    Later 945-ish chipset can use graphics address instead.
    (cherry picked from commit d50cec6ef9e2178ea663e58d548390f0f3da7692)

commit 35a40f3df2d8707f61a3f9f0d3357bfe6bd57ed6
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jun 26 10:05:21 2008 +0800

    xvmc: init mc render load indirect command once
    (cherry picked from commit d1c34d8c0e7ae2a1d952791343e131837fbfda99)

commit a5959d3dd31b33e81e4bca85ace377001b0f2cfe
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jun 26 09:47:28 2008 +0800

    xvmc: init dest and reference buffer once
    
    Init them right after context create, and only update buffer address
    info later.
    (cherry picked from commit 75e38fa8348198ba151afa37e10be3b0b0b468f8)

commit 9d08874d309132444b92f333963aa3fe5a2340ca
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jun 25 14:27:16 2008 +0800

    xvmc: init one-time mc context once
    
    Don't setup one-time mc context everytime, as the content is always
    unchanged. And several structs got packed layout inside to ease static
    state initialization.
    (cherry picked from commit b4d8ca8b38e495b56bb3b4143e5dfe91ee651f15)

commit 3f57fd5fef6bb6baefa3d157d4e5d9c6154c67d5
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Jun 23 15:51:49 2008 +0800

    xvmc: environ debug option support
    
    export INTEL_XVMC_DEBUG=1
    (cherry picked from commit 54f3f528e4804b958936ac773e7a507b2676f815)

commit 736bed6734cf1a070fc7da6a1384edc5fd466887
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Jun 23 15:49:29 2008 +0800

    xvmc: formalize surface type definition
    
    We should also carefully select surface type id.
    (cherry picked from commit 7a705081788bf957409e17baa5f189241589057c)

commit c61480f420445f7e3341305362b8cea656b0f7a2
Author: Jesse Barnes <jbarnes@jbarnes-t61.(none)>
Date:   Fri Jun 27 13:39:31 2008 -0700

    Add pipea force enable quirk for HP Pavilion ze4944ea
    
    Fixes bug #16540, thanks Bryce.
    (cherry picked from commit 0283d22f510ba47dfdac2806a58e46649c26580b)

commit 9869cd11549cd608593fea111880502192e93fd5
Author: Jesse Barnes <jbarnes@jbarnes-t61.(none)>
Date:   Fri Jun 27 13:37:10 2008 -0700

    Add pipe a force enable quirk for Lenovo T60
    
    Fixes bug #16494.
    (cherry picked from commit 08903abe4dc0295c7ed7d1ff1a22e0e579540c15)

commit 45c1da56891723dd85153853885dd3b52a23c117
Author: Hong Liu <hong.liu@intel.com>
Date:   Fri Jun 20 10:57:14 2008 +0800

    Fix SDVO HDMI output.
    
    While some cards had enough initialized at startup to work already, others
    required that the driver actually initialize the required AVI info frame.
    (cherry picked from commit 05df8c0b31721a9ccc7215fb1cda1115758367c7)

commit 894fbc9d124e4c9dd982e14b83d47f51c479d5b6
Author: Jesse Barnes <jbarnes@jbarnes-t61.(none)>
Date:   Tue Jun 24 11:01:46 2008 -0700

    Remove ErrorF debugging from modeset ioctl
    
    Oops.
    (cherry picked from commit 59f39e0ea0ad48c52d9b8f7afb6e04ce95db717e)

commit 21a63e9e193b91345cdab077a8ec80b3d8a80690
Author: Jesse Barnes <jbarnes@jbarnes-t61.(none)>
Date:   Tue Jun 24 10:41:46 2008 -0700

    Add support for keeping vblank counters sane across mode setting
    
    The DRM supports disabling of vblank interrupts when not in use, but in order
    to function properly it must also be aware of mode setting, which will reset
    the frame counter to 0.  Add code to call into the DRM before and after mode
    setting, so that it can account for any lost vblank events.
    (cherry picked from commit 65eee25d7d2ca979205f3776d620dbb36bf68a13)

commit 313e9383121d74f448d4d26910085c0915163d8a
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 19 15:01:00 2008 -0700

    Fix a crash in i830_sdvo_init error paths by setting up dev_priv earlier.
    (cherry picked from commit 6b6be2b2a7179c1c9fa12989e16076aae105f4e2)

commit a8f9957b30eb94120c4217a9722c19684fecebb3
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 19 14:27:30 2008 -0700

    Automatically detect the presence of HDMI.
    
    Now, SDVO is only probed if the SDVO detected bit is set.  If the SDVO probe
    fails, but the detect bit is set, assume that it's an HDMI output.
    (cherry picked from commit 65ad29d78793c7804f133a58de80ffaa0404ca28)

commit f8ca634b38229e1eeae026747ee0b6688b7a71a0
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 19 14:10:29 2008 -0700

    Fix hdmi POSTING_READ to use the register number instead of the register value.
    
    We won't dwell too long on how this ever worked.
    (cherry picked from commit ea0d21006ec71bc56acde7291e5f8d28e54b83fe)

commit babedc600f8758b7e436adb93ffe8a5f2d7124ae
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 20 15:14:46 2008 -0700

    Get HDMI output working.
    
    HDMI, despite claiming to have pixel multiply support, actually doesn't
    want it, at least in the way that SDVO did.  Disable it.
    
    Also disable the NULL_PACKETS_DURING_VSYNC bit.  Despite the docs telling us
    to set it, the output doesn't like it when you do that, and the BIOS doesn't
    set it.
    
    Also add a posting read to SDVOx setting.  Without it, half the X starts
    wouldn't get anything on the screen.  (interestingly, it was every other
    startup, not just a chance).
    (cherry picked from commit 2fa9240a3b685a0c3d0e2644fc144c927b67b6b3)

commit dcc841756f94ef61a1f1a991949efc917378baf1
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 20 13:49:47 2008 -0700

    Set the sync active bits like we're supposed to, matching the BIOS.
    (cherry picked from commit dc8ab9d35b261b6105a62949cfb47a3554531d0b)

commit a927099505391efff6ef64d299ccbf14c28f7b5f
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 10 11:51:05 2008 -0700

    Add pixel multiplier support for HDMI
    (cherry picked from commit af13826ed063b60a1e4179101e8889b4ab7a9d0b)

commit 82300116af8b01fc3c071d9c8625ffea122431fa
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 10 11:47:15 2008 -0700

    The phase shift its are now reserved, and add HDMI clock limits.
    (cherry picked from commit 9a05662918223477eb1cf6f80ffac08712721c70)

commit 56f5a189df288b87f6596804d9bc38a8308d0848
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 6 16:05:17 2008 -0800

    Initial HDMI work.  Not currently hooked up at startup.
    (cherry picked from commit beba1dd3561e38573ed9f507328caf7f8fb9f84a)

commit 9381703787069aa348dccb955839a0058db55c0b
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 6 14:57:57 2008 -0800

    Add DisplayPort registers.
    (cherry picked from commit da58dc3b02999f3244d0eaf77180b828d85bd609)

commit 093f65fd04c38e6c1f19889074f9316749959c7a
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jun 17 12:39:28 2008 -0700

    Add support for Intel 4 series chipsets.
    (cherry picked from commit 1cfe769c74d1a3a392bf1aaaf5c2dcc8273daf66)

commit 289790c0467d27e96b537598a6589fc6a36da8b8
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jun 17 09:46:12 2008 +0800

    Fix compiling with server master in LVDS backlight patch

commit 66418cc99cfd360e303efcdf74a9ee31d435ff15
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jun 12 14:04:41 2008 +0800

    Fix compiler warning when disable xvmc config
    (cherry picked from commit df0bbdc7cbb6ff357a81ed28d12e56c9c7d643f7)

commit 078d05865884ca5784b532c0a79c8440632002ac
Author: Shuang He <shuang.he@intel.com>
Date:   Mon May 26 09:20:53 2008 +0800

    Fix typo in xvmc block destroy
    (cherry picked from commit 87ace420a34df7425641d089f71830e44fced098)

commit 4c4ef27779aebf4df90b6233de05be2bb972de4c
Author: Lukas Hejtmanek <xhejtman@ics.muni.cz>
Date:   Mon Jun 16 02:49:41 2008 +0800

    Fix maximum backlight issue

commit 79f94ee3c4652019395b9c329d94f7779c558571
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Jun 10 11:31:22 2008 -0700

    Set up/restore PWRCTXA from enter/leavevt not server start/exit.
    
    This should improve behavior in the presence of VT switching, but also avoids
    a crash on X exit from writing the register after unmapping mmio.

commit 231a302013981cc597ba09ee89b367c8ab56e8ba
Author: Bryce Harrington <bryce@bryceharrington.org>
Date:   Tue Jun 10 14:10:39 2008 +0800

    Two more Dell quirks
    
    fd.o #16160

commit 1142be53eb8d2ee8a9b60ace5d49f0ba27332275
Author: Jesse Barnes <jbarnes@hobbes.lan>
Date:   Mon Jun 9 08:52:59 2008 -0700

    Fix TV programming:  add vblank wait after TV_CTL writes
    
    Fxies FDO bug #14000; we need to wait for vblank after writing TV_CTL or followi
    ng "DPMS on" calls may not actually enable the output.

commit 64a8f2433d7774d06119793b57cec6d3be6389c1
Author: Robert Lowery <rglowery@exemail.com.au>
Date:   Tue May 20 21:09:23 2008 +1000

    Fix TV out connection type detection
    
    Make sure we wait for vblank when using the TV DAC to detect the connection
    type.
    
    Fixes FDO bug #14000.

commit a993a8f3ce3a2079c5b5ebaca2ec2564047d7d4e
Author: Tomas Carnecky <tom@dbservice.com>
Date:   Fri Jun 6 10:03:23 2008 +0800

    Fix compile error in LeaveVT

commit bff180e6cac4452ef491c81855eb12bfa03d0bf3
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 5 14:55:23 2008 -0700

    Move debug clock printout from ErrorF to X_INFO.

commit ad459b21b7de4a79552ac155803d5930432fb84b
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 5 14:37:59 2008 -0700

    Remove SVG_WORK_CONTROL init.
    
    The bit set is now reserved -- used to be a workaround for early revisions.

commit e41dc98a0aeec389b221038753056c725ecee1c5
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 5 14:37:26 2008 -0700

    Initialize clock gating from EnterVT and save/restore it appropriately.

commit 8061e5ac27a5f61f940bccc940be922999cc1d3f
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 5 14:09:45 2008 -0700

    Move BIOS scratch register setup to EnterVT instead of PreInit.
    
    We want these to always be set when our driver's in control.  They are
    already appropriately save/restored at leave/entervt.

commit b61cb9283185eb5211e84eb7d8e68beea607c2eb
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 5 13:57:54 2008 -0700

    Remove gratuitous wait_ring_idle after I830Sync.  Syncing implies that.

commit b65f67b74ff99aea1490d52f170ef4fe80cef6c7
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 5 13:40:55 2008 -0700

    Move the remaining two lines of SetHWOperatingState to the caller.

commit adb4f5a5e826e584ab212d23fc8d474c3e7bb8e8
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 5 13:39:08 2008 -0700

    Remove duplicated i830_stop_ring()/SetHWOperatingState() in EnterVT().

commit c2e2fe48113667c683c6e1e9b1237635c41c61c3
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 5 13:21:55 2008 -0700

    Move DSPARB setup into a separate function, and save/restore it at VT switch.

commit 7e51384c973a96366b02ea646392c43574674111
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 5 11:56:42 2008 -0700

    Replace a couple of wait-for-ring-idles with a single function to do so.

commit 65306cdd71dad71e4ca7229764f81a0880dd70bf
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jun 5 11:26:02 2008 -0700

    Just remove the mprotect kludge.
    
    Besides not being #ifdef __linux__ed as requested, some linux kernels break
    in exciting new ways when you try to mprotect from PROT_NONE back to
    PROT_READ|PROT_WRITE.  Yes, there are bugs in the code we're calling in a
    bug-exploiting bug workaround.
    
    If you want this workaround for the original bug exposed when moving to
    libpciaccess, it's already in libpciaccess.

commit beb72ae5aa053303f5cc419e9c9d7c6db964f160
Author: Hong Liu <hong.liu@intel.com>
Date:   Wed Jun 4 16:58:05 2008 +0800

    Set SDVO sync polarity to default on 965
    
    Fix fd.o bug 15766

commit c7fee208fd46e143965ea173984d284e1eec2a9b
Author: Hong Liu <hong.liu@intel.com>
Date:   Wed Jun 4 16:56:50 2008 +0800

    Fix DSPARB change on 965G
    
    From the spec, only 965GM and IGD_GM have 128 FIFO entries.
    With DSPARB change introduced by commit bd137a, I've got PIPE B
    underrun when dual-headed on G35 platform.

commit 64ccc8a036a1d80fc918e9b124d24ce0d26bdbbb
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jun 4 22:30:04 2008 +0800

    xvmc: add render dump function

commit 1729a4f29dd52346a9fa997f818d57884047657f
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jun 4 22:25:39 2008 +0800

    xvmc: move block size lookup helper to generic

commit 3cc8876db7ba82fa18e8fab4f267ac6e87964c47
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jun 3 16:15:36 2008 +0800

    xvmc: a little cleanup
    
    Also safe check context size to not exceed surface max.

commit 96955003557686469c7ae9f7d42620d2851e6fad
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jun 3 16:13:52 2008 +0800

    xvmc: remove unused dri drawable

commit bd137a19dc29dd466eac030e040f729ed0807e3f
Author: Jesse Barnes <jbarnes@hobbes.lan>
Date:   Wed May 28 15:47:47 2008 -0700

    Fixup DSPARB for 855 & 945
    
    It turns out 855 has a different DSPARB layout than 915+.  And 945+ have more
    FIFO entries, so we have to allocate things differently.  So on 855 split the
    FIFO evenly again between A & B planes, and do the same on 945, where we have a
    larger FIFO.  Fixes an issue reported by Daniel Stone with the previous default
    value.

commit 363ccc3dfbf8ab91608d502e0376a43653581856
Author: Jesse Barnes <jbarnes@hobbes.lan>
Date:   Mon May 26 09:43:40 2008 -0700

    Fixup FIFO comment
    
    What I originally checked in was a bit misleading.

commit 2e1425246ccc75216247b0c2fa6fce2635db472b
Author: Jesse Barnes <jbarnes@hobbes.lan>
Date:   Mon May 26 09:40:10 2008 -0700

    Handle display FIFOs better
    
    Add some debug code to catch FIFO underruns, which are normally bugs (unless
    they occur during mode setting) and remove any plane C FIFO allocations, since
    we don't use that plane at all.  We may eventually need to be a little smarter
    about this on platforms that use plane C for the popup.

commit 89bb53cc7a853d88fc34a0ca65ae2b6227a8dd24
Author: Jesse Barnes <jbarnes@hobbes.lan>
Date:   Mon May 26 09:34:34 2008 -0700

    Fixup power saving registers
    
    Update clock gating disable bits to match docs and allocate a power context
    memory area so that newer chips can save state and power down the render unit.

commit 165c0865d849b7d280a3a119fe9ae0ad34637df0
Author: Alan Coopersmith <alan.coopersmith@sun.com>
Date:   Wed May 21 14:56:27 2008 -0700

    Define DEFFILEMODE for OS'es that don't have it

commit 71180653825a1b141a08590e4b767d33d9b5d8c1
Author: Jesse Barnes <jbarnes@hobbes.(none)>
Date:   Wed May 21 11:51:55 2008 -0700

    Revert "Disable FBC by default on 965GM"
    
    This reverts commit 53e3693ef13f31f3fc33bcff7286ab2b03b2d430.
    
    Conflicts:
    
    	src/i830_driver.c - default FBC on for 965+

commit 740a73dad1d9a9b0ebf1cc7d6f2a056abad57aaf
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue May 20 08:54:01 2008 +0800

    Revert "Add FIFO watermark regs to register dumper"
    
    This reverts commit 0c00a638ef57aa9d6a3047176b0bfad733f781f0.
    
    Those FIFO watermark regs are 945-ish, and cause problem
    on G35.

commit e9532f3abf1e0b62b2569d4aae60a5a63add571f
Author: Rémi Cardona <remi@gentoo.org>
Date:   Wed May 14 14:52:37 2008 +0800

    Add glproto to DRI dependencies

commit fe455a38cbac8d47a5c82b3eeb3cc6a59a6e8443
Author: Eric Anholt <eric@anholt.net>
Date:   Tue May 13 11:56:10 2008 -0700

    Formatting fixes for intel_idle.

commit 5c1720ecbc5528c40bb48084dc68ef233e9bb43b
Author: Eric Anholt <eric@anholt.net>
Date:   Mon May 12 16:48:05 2008 -0700

    Add i915 support to intel_idle.

commit 5103e5a39a4869a714b8a59da8bf51ecc8c65e4f
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Mon May 12 10:58:24 2008 -0700

    Panel fitting:  fix letterbox modes
    
    In full_aspect mode, we try to preserve the aspect ratio by adding
    either top & bottom or left & right borders.  In the letterbox case (top
    & bottom borders) we were miscalculating the top border which led to
    programming a bad mode.  Fix the calculation and bug #15559.

commit f280c50dd5d29c5717adc6da2368363cb3d0adbb
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon May 12 08:57:56 2008 +0800

    Revert last HP 965GM pipe A quirk
    
    Seems not resolve the issue (fdo bug #15885).

commit d91d9e6a2f2ba18b35cb6fd7bc3fe8bc617eb44f
Author: Bryce Harrington <bryce@bryceharrington.org>
Date:   Sat May 10 07:58:59 2008 +0800

    More Pipe A force quirks

commit 548d4c0f979a72eac5d0c9c76da12f0bd05e64e1
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu May 8 12:43:30 2008 +0800

    Fix i965 render getting dest format error
    
    Depend on value returned by function within assert is wrong.
    Fixed weird render corrupt on i965.

commit 9f324860431ff8199a78d19bbaa74046e1476b89
Author: Mike Isely <isely@pobox.com>
Date:   Thu May 8 10:00:17 2008 +0800

    Implement option to ignore external fixed mode settings
    
    The Intel xorg driver tries mightily to determine the native fixed
    panel mode settings for the LVDS output.  It does this through various
    means, including scanning video BIOS tables, and noticing if the pipe
    in question has already been set up by somebody else (and adopting
    those timings).  This strategy works well for say a laptop where the
    LCD panel is an integral part of the machine.  But for other
    applications where the display is unrelated to the system's BIOS or
    other software, then the BIOS will likely have no clue how to
    configure the LVDS output.  Worse still, the BIOS can simply "get it
    wrong", leaving the pipe misconfigured.  Unfortunately the Intel
    driver can potentially notice this, adopt the same settings, leaving a
    messed up display.
    
    All of this complexity normally happens independently, behind the
    scenes, from the mode timings that might otherwise be specified by the
    user.  This driver has a concept of fixed, i.e. "native" mode, and
    then user-specified mode.  If the corresponding resolutions between
    those concepts don't match, then the driver in theory will arrange for
    scaling to take place while adhering to the actual native mode of the
    panel.  Said another way, if the user says 800x600 but the driver
    mistakenly (see above) thinks the native mode is 640x480, then 640x480
    is the mode set with scaling to an 800x600 frame buffer.  If the
    driver gets the wrong native mode, then the result is a miserable mess
    with no way for the user to override what the driver thinks is right.
    
    This patch provides a means to override the driver.  This implements a
    new driver option, "LVDSFixedMode" which defaults to true (the normal,
    probe-what-I-need behavior).  However when set to false, then all the
    guessing is skipped and the driver will assume no fixed, i.e. "native"
    mode for the display device.  Instead with this option set to false,
    the driver will directly set the timings specified by the user,
    providing an escape hatch for situations where the driver can't
    correctly figure out the right mode.
    
    Under most scenarios of course, this option should not be needed.  But
    in situations where the Intel video BIOS is hopelessly fouled up
    related to the LVDS output, this option provides the escape hatch for
    the user to get a working display in spite of the BIOS situation.
    
    Signed-off-by: Mike Isely <isely@pobox.com>

commit 33f033cbf346c13a687e469e8879579fcd5bb2fb
Author: Jesse Barnes <jbarnes@hobbes.lan>
Date:   Wed May 7 14:46:52 2008 -0700

    Save/restore cursor registers
    
    There are lots of good reasons for doing this, one of them is fdo bug #11305.

commit a7188b1f2dd9a69fa7daefe478d283735226f9f3
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed May 7 14:21:59 2008 +0800

    Use I830FALLBACK when check pitch for debug

commit 79fde3ad7a949fb7f0dc9907cb6eea6ca9a910ae
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Sat Apr 19 08:54:38 2008 +0800

    Check pitch for EXA operation
    
    2D pitch limit applys to all chips. Pre-965 chip has
    8KB pitch limit for 3D. 965 supports max pitch by current
    exa (128KB).
    (cherry picked from commit 8187a5a16f8bd8f0ba5e7f5357f355928b3b8f07)

commit 36ec93300926084fb2951d69b001e4c67bc6ff79
Author: Eric Anholt <eric@anholt.net>
Date:   Tue May 6 18:48:20 2008 -0700

    Bug #15807: Fix use of the ring while VT-switched, hit by fast user switching.
    
    The fix for flushing at blockhandler with no DRI on 965 was broken and would
    try to flush the chip even when the driver wasn't in control of the VT.
    Hilarity ensued.

commit 0c00a638ef57aa9d6a3047176b0bfad733f781f0
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Tue May 6 14:38:48 2008 -0700

    Add FIFO watermark regs to register dumper

commit c81a4687fca80bf7367d7f0e9a00a6a09737c5bb
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue May 6 13:52:22 2008 +0800

    Only check xvmc lib when xvmc is enabled.
    
    Don't check xvmc lib if user has already wanted to disable it.
    Fix fdo bug #15762.

commit be746a90a87d7a9807fa4243493e7e4d48f7f1c0
Author: Bryce Harrington <bryce@bryceharrington.org>
Date:   Tue May 6 13:51:46 2008 +0800

    More quirks from ubuntu/dell

commit a0ced923bb793aa22e6bfbeeec0888d3b42ce176
Author: Jesse Barnes <jbarnes@hobbes.lan>
Date:   Tue Apr 29 13:19:02 2008 -0700

    Add a new quirk for BIOSes that reprogram regs at lid close/open time
    
    Dell Latitude D500s seem to have this problem.  At lid close/open, the DSPABASE
    reg gets reset to 0, so we either need to keep the framebuffer at offset 0 or
    make sure we reprogram the CRTCs after the lid opens again.  Since we can't
    make sure the former is always true (buffer resize, etc.), this patch adds a
    quirk to reset the modes at lid open time.
    
    Fixes FDO bug #14890.

commit fff17b9d1b58cb53032d153094826dd306836d59
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Apr 29 10:32:14 2008 -0700

    Use new xf86RotateFreeShadow function to clean up shadow buffers.
    
    This simply moves code from the driver up into the X server; use it where
    available.

commit 1d467a8038946a37844795e8860be113d43219ac
Author: Keith Packard <keithp@keithp.com>
Date:   Wed Apr 23 11:08:38 2008 -0700

    Overlay video doesn't require that the target pixmap be in video memory.
    
    I830PutImage was checking to make sure the target pixmap resided in video
    memory, but this isn't necessary when using the overlay. Test

commit 40e0a03af57d7b3180d7066bcb15e03dcc9ca295
Author: Keith Packard <keithp@keithp.com>
Date:   Mon Apr 21 01:03:22 2008 -0700

    Dump batch buffers found from main ring

commit c8ae3b781f0d8e325876a74c91cd0a685d34454b
Author: Keith Packard <keithp@keithp.com>
Date:   Sun Apr 20 02:11:15 2008 -0700

    Add a bunch of 965 ring stuff to the debug dump

commit 2c135ef8ac40f8e7cd071de7414adfae019f9198
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Apr 16 21:39:58 2008 -0700

    Make the binding table and surface state be arrays to reduce syncing.

commit c3fb62df4e60b63295f94c99b3c5de70dbf94e1c
Author: Keith Packard <keithp@keithp.com>
Date:   Thu Apr 17 10:04:55 2008 -0700

    Add a kludge-around to fix cd/wt bits in fb ptes on linux.
    
    Mmap from /sys/devices/pci* on linux forces the cache-disable and
    write-through bits, which turns our write-combining map into an
    uncached-map, seriously impacting performance. It turns out that a bug in
    mprotect allows us to fix this by disabling access to those pages and then
    immediately re-enabling them.

commit 0ae283582d21776d3317d5fc1c25751d50d562c7
Author: Hong Liu <hong.liu@intel.com>
Date:   Thu Apr 17 10:57:34 2008 +0800

    fix possible segfault in I830FreeScreen
    
    pI830 may point to NULL if I830PreInit fails

commit 7008eac855302fd467e001495483c2dccfddf68f
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Apr 16 12:09:41 2008 -0700

    Update dolt from git, fixing fallback to libtool.

commit 23d1df22d177e54bfc46304053d8115047ff85d4
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 14 16:46:17 2008 -0700

    Abstract surface setup into a separate function.

commit e27ce4238f748d024635835824c120eb298b84b2
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 14 23:30:21 2008 -0700

    Move the vertex buffer to the state structure as well.

commit 69709fe36cfdb59c140f5cba233dcb606f8dbc85
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 14 18:34:13 2008 -0700

    Move the binding table for 965 to the state structure.

commit 049d057dfd73b6c191a8ba5d73eddb77cf7748e7
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 14 17:09:22 2008 -0700

    Move the 965 static variables local to the function they're used in.

commit 092962c962fdf3e33a8d387221448fe7c8c36376
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 14 14:02:58 2008 -0700

    Make the VS unit state static for 965 render.

commit 4bbdd7096d4927fe48673006fff7df922972f116
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 14 13:53:36 2008 -0700

    Rename some variables in i965_render.c for clarity.
    
    The gen4_render_state is now always called "render_state" (i965_render.c
    bookkeeping) and gen4_state_t is now always called "card_state" (the buffer
    for state used by the chip).

commit 456bb529335c28cf60f3b6e5900b804efa5c185a
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Nov 9 17:24:21 2007 -0800

    Associate one sf_state object with each sf_kernel
    
    (cherry picked from a2b5c23184d19b386fdfd04f578a55566df60132 commit)

commit 90d6b178473ba32cf66e6e654e608cb4374e4a19
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Apr 14 16:31:03 2008 +0800

    Change default panel fitting mode to origin
    
    i8xx currently only works in FULL mode.
    (cherry picked from commit 33ffd781bbca3d0dee8c1b47e7b90be5824b9a4f)

commit c1ad0a1a344a87a537aa5f93f6c774997a3189e4
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Apr 14 10:02:00 2008 +0800

    Remove old sf/wm program from Makefile
    
    Fix distcheck
    (cherry picked from commit 1d8383923bebf38ab8ada6a262cb4fc8c30e074a)

commit 18ef4158e5574bfc6621b268821532f13e261d13
Author: Keith Packard <keithp@keithp.com>
Date:   Sun Apr 13 21:37:49 2008 -0700

    Only use FOURCC_XVMC when INTEL_XVMC is defined
    
    The XVMC code uses a magic FOURCC code to signal frame updates, but that
    code is only defined when the XVMC code is used.

commit 269809030ee9d08b56ad0178a7a9c0194e25785e
Author: Keith Packard <keithp@keithp.com>
Date:   Sun Apr 13 12:47:02 2008 -0700

    Move wm_scratch first to meet alignment requirements

commit 08d3206f3b891e611e3e16c9eb79cfca21ab8a51
Author: Keith Packard <keithp@keithp.com>
Date:   Sun Apr 13 12:35:14 2008 -0700

    Kludge to make planar video work - duplicate sampler state
    
    This patch duplicates all of the surface sampler state needed to read from
    the separate YUV surfaces and then has the planar sampler read from samplers
    0, 2, 4 instead of 0, 1, 2. This appears to make things work, instead of
    having the samplers break at random. I do not understand why this works.

commit 6366e4de540c4713cbc8402c89516464bbdc35b9
Author: Keith Packard <keithp@keithp.com>
Date:   Sat Apr 12 16:39:00 2008 -0700

    Skip copying on FOURCC_XVMC surfaces

commit 0fec42b64ee529eb7ec15febdaa5e4986ec1ab17
Author: Keith Packard <keithp@keithp.com>
Date:   Sat Apr 12 11:01:14 2008 -0700

    Set some mask bits to try and get yuv conversion working

commit 91d3e19786e22061f4b617cf39a3cd713139a2d9
Author: Keith Packard <keithp@keithp.com>
Date:   Sat Apr 12 11:00:51 2008 -0700

    Use compressed instructions for yuv conversion

commit 03836067b77606c134c71b30c7078d09d77c95fa
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Apr 11 12:17:28 2008 -0700

    Fix the offset to sampler default color, and a compiler warning.

commit d3138d9ff0f821fb3adbd27684b0c22a8a910c3e
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Nov 13 12:37:13 2007 -0800

    Enumerate all possible wm_state objects
    
    We have a collection of wm_state objects for each ps kernel,
    (one for each combination of src and mask extend and repeat
    values).
    
    Thanks to Dave Airlie for noticing an errant write through a
    wild wm_state pointer in an early version of this commit.
    
    (cherry picked from 7763706a93d3021907273f9b330750ba110e2fc3 commit)
    
    This cherry-pick required more reformatting than most, due to the
    projective texturing merge.

commit 2293a3677d1dcf294de6a8712bf0d2f65b50dcc3
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Nov 12 16:09:00 2007 -0800

    Enumerate all possible src,mask sampler state pairs
    
    This will eventually allow for the elimination of sampler state
    updates while compositing---and initializing everything in the
    initialization function.
    
    (cherry picked from commit d0874697be8086cd64740c24698df8cd4d31c76f)

commit da85d1b822dcb31698e9c5ab85a7bb27ad745eee
Author: Keith Packard <keithp@keithp.com>
Date:   Fri Apr 11 11:22:29 2008 -0700

    Revert "remove '#line NUM ...' in macro process"
    
    This reverts commit f47486fab3dffcbb03e7ad89f777abba1e887299.
    
    Sorry for failing to push the #line processing changes to intel-gen4asm;
    those are now pushed, so this change should no longer be necessary. Having
    correct file name and line numbers in the error messages is awfully nice
    though.

commit f47486fab3dffcbb03e7ad89f777abba1e887299
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Apr 11 10:12:40 2008 +0800

    remove '#line NUM ...' in macro process
    
    intel-gen4asm doesn't allow '#' line

commit 5c9cde37e769287fb7bf4e08c3600a33c2e92dce
Author: Hong Liu <hong.liu@intel.com>
Date:   Fri Apr 11 09:54:34 2008 +0800

    Bug #14935: Fix i9xx reference clock for spread spectrum.

commit 152a50703aa5e9ebaa9abbe448518742734a5eb7
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Apr 10 16:06:41 2008 -0700

    Fix compiler warning from 24-bit lvds change.

commit baa55ffe3b67ca952e4d1ef7087335d76eb2f24b
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Nov 13 12:56:13 2007 -0800

    Enumerate all possible cc_state objects
    
    We need one for each possible combination of src and dst
    blend_factors. Again, as with recent changes, this eliminates
    state updates from prepare_composite and allows that function
    to instead simply reference an existing object initialized
    within gen4_state_init.
    
    Thanks to Dave Airlie (and git-bisect) for pointing out that with
    gnome-terminal all text was appearing as solid black with an early
    version of this commit. As expected the bug was an alignment issue.
    
    (cherry picked from 0c0ab52c2d100c47f38c7ef826ef585c8b9815e9 commit)
    
    Performance is approximately equivalent on text tests, but may be
    around +2%.

commit d5a80e1e3ab5724d34b20f9ee6f830efd0f5b076
Author: Keith Packard <keithp@keithp.com>
Date:   Wed Apr 9 16:27:40 2008 -0500

    Single memcpy when pitches align on planar image transfer

commit ac97f2b1487df5574875350a9cded958dae33afa
Author: Keith Packard <keithp@keithp.com>
Date:   Wed Apr 9 16:27:23 2008 -0500

    Use available symbolic register name

commit f270456e5612cb88933e6aabcd9a816c5c292229
Author: Keith Packard <keithp@keithp.com>
Date:   Wed Apr 9 10:00:08 2008 -0500

    Remove .g4b files on clean

commit fb6ed8b8b59e9dd18801afef5d7c62042ad176d7
Author: Keith Packard <keithp@keithp.com>
Date:   Wed Apr 9 09:58:44 2008 -0500

    Update yuv->rgb conversion programs to write to src_sample regs
    
    The YUV->RGB code was written to write directly to the dataport registers,
    but that didn't work for the compositing functions (cause still unknown).
    This change makes that code write RGB values to the src_sample registers as
    with the other sample computation fragments.

commit b01d582e23fc99e32bc47a395e9caa366731372a
Author: Keith Packard <keithp@keithp.com>
Date:   Wed Apr 9 09:30:35 2008 -0500

    Revert "Compute pixel values directly into data port"
    
    This reverts commit 346cf57deabb4c336612df4c13650a87b5ef6775.
    
    Mixing randr transforms and video caused screen corruption for Render
    operations. No, I don't understand why.

commit 3fc3d1a701bae257b70aa7b7654c722f30e71399
Author: Keith Packard <keithp@keithp.com>
Date:   Wed Apr 9 02:02:56 2008 -0500

    Remove sync after 965 video put.
    
    The hardware has been marked as needing a sync, so the next video put will
    block waiting for the previous one to complete. Adding a sync here just
    stalls the video playback for no good reason.

commit 825d9e50c59450f07178a54fed2616e551dc0455
Author: Keith Packard <keithp@keithp.com>
Date:   Wed Apr 9 00:09:34 2008 -0500

    Add planer video decode kernel
    
    Support for planar video reduces bus bandwidth by 25% and also reduces CPU
    usage during planar->packed conversion.

commit a03eaaa67b33c57530e92c53d28917e2563b4427
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Apr 8 16:24:55 2008 -0500

    Use shared exa_wm code for packed yuv decode
    
    Eliminate special video sf and ps programs.

commit 32ef98518394d29cb87405005c660278489396bb
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Apr 8 16:21:55 2008 -0500

    Compute pixel values directly into data port
    
    Instead of leaving pixel values in src_sample registers, compute the pixel
    values directl to the data port to save 8 moves. This cannot work when no
    computation is done as there is both no way to wait for the sampler to
    finish and because the sampler returns data in a different order from that
    required by the data port (sigh).

commit b68d9f4245d0ebe3371c179401ff145f1a4d101b
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Apr 8 16:09:00 2008 -0500

    Use symbolic names for channels in YUV code

commit 781be9d47289713b0a8fcd95c769a9c6241d62e9
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Apr 8 16:08:20 2008 -0500

    Rename src/mask/data registers to indicate channel

commit 2871ac8eefd0192080bb0569140c3f5d0e1d9b44
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Apr 10 13:34:13 2008 -0700

    Statically allocate the sampler default color, which we never change.
    
    Performance change is in the noise.  Also from Carl Worth.

commit 80dd784e33847e431403d4659a7b8d8425b2676f
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Apr 10 13:24:51 2008 -0700

    Add copyright information for recent editors of this file.

commit b606278db83ec84b1db562a2d65697c50561b169
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Apr 10 13:17:58 2008 -0700

    Keep static copies of the 965 render programs in video memory.
    
    This reduces the CPU overhead of memcpying them in every time, for a speedup
    in aa24text of around 30%.  This is based on work by Carl Worth which is
    in the intel-batchbuffer branch.

commit bd41d2bb858770c109d5013274a4354e8e6ae32d
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Apr 10 10:24:48 2008 -0700

    Add dolt to speed up compile time and reduce insanity.
    
    Hopefully some day we can be rid of libtool entirely.

commit 96ae9a9f0abc582e45ff4e17dd213c8739c24cb3
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Apr 9 14:17:29 2008 -0700

    SDVO: Rename output_dtd variable to input_dtd, which is its new job.

commit 72c3995d5158286d20e97296f4552697f32f935f
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Apr 8 15:00:18 2008 -0700

    SDVO: Set adjusted_mode in mode_fixup from the preferred input timings for TV.

commit b61178524bece756dc0fd4f798c6c7743b5725db
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Apr 8 14:11:42 2008 -0700

    SDVO: Fix lols TV mode list handling.

commit 5db73f18d2badec37523850024b9aa824e4e6bd8
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Apr 8 13:53:51 2008 -0700

    SDVO: Use the TV reference clock for SDVO TV outputs.
    
    Based on a patch by Will Wiseman.

commit e031cc02e65acfbafb48136dad414751e04425c5
Author: Mike Isely <isely@pobox.com>
Date:   Wed Apr 9 14:15:03 2008 +0800

    Implement support for 24 bit pixel format
    
    The Intel driver appears to be coded to only work with displays
    expecting 18 bit pixels.  However I have an application using a LCD
    display that expects pixel data in 24 bit format.  The difference is
    only 2 bits in a single GPU register.  This patch implements that
    change, controlled by a new driver option, "LVDS24Bit".  The default
    value is false, which is the previous behavior.  When set to true,
    then 24 bit panels should work (at least the one I'm testing here
    does).
    
    Fd.o bug #15201
    
    Signed-off-by: Mike Isely <isely@pobox.com>

commit 79b18980ac9f60b1978abe421352df965aed1681
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Apr 9 14:03:45 2008 +0800

    Include <stdint.h> in i810.h for integer types definition

commit 2b720262e1235f1c9da860ba3e9181f0c377aa5e
Author: Jesse Barnes <jbarnes@virtuousgeek.org>
Date:   Wed Apr 9 17:34:17 2008 +0800

    Fix LVDS regression
    
    Disable panel fitting on 855GM, and fix dither setting.

commit af92f4f885c8eae2211d09080b2289aa5bab9ec1
Author: David Schleef <ds@schleef.org>
Date:   Tue Apr 8 12:43:20 2008 -0700

    Bug #15219: Fix default overlay CSC factors, and use BT709 if available.
    
    Using the updated factors even when BT709 conversion isn't available
    (non-965) should still give us better color reproduction.  Tested on a
    945GM, examining the +/-5% of black bars of videotestsrc.

commit 37bc23660a8c346f1eaa6c93ed2c7a840828f0b0
Author: Bryce Harrington <bryce@bryceharrington.org>
Date:   Mon Apr 7 17:26:49 2008 +0800

    Quirks from Ubuntu/Dell
    
    FD bug #15353. Launchpad bug ID is available for reference.
    (cherry picked from commit 24248097988775d62f6c416f2988e74d31c91cd0)

commit dcbdc901d64d2fab489292ef1c9ca1490bdd1e94
Merge: 0147c1c... 13563bd...
Author: Keith Packard <keithp@keithp.com>
Date:   Fri Apr 4 19:19:35 2008 -0700

    Merge commit 'origin/master' into projective-965

commit 0147c1c84872f7a109721a53d88a539932d9be81
Author: Keith Packard <keithp@keithp.com>
Date:   Fri Apr 4 19:17:55 2008 -0700

    Forgot to build exa_wm_src_sample_argb.g4b

commit 13563bd65cbbbb3e697dacd814efa3517e1493dc
Author: Hong Liu <hong.liu@intel.com>
Date:   Wed Apr 2 16:05:43 2008 -0700

    SDVO: Fix DDC bus selection based on output priority list.

commit 6ad2d6ba86689674876f5f4c473f11e39243ac38
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Apr 2 15:16:17 2008 -0700

    SDVO: Fix mixups with input and output channels.
    
    The 2-bit input_mask was actually an input count -- in0 is always there, and
    in1 is optional.
    
    The output flags weren't being reported in the log, so I mistakenly took
    controlled_output == RGB0 to mean that the device only reported an RGB0,
    while it actually reported RGB0|SVID0|YPRPB0|misc|other.  Move SVID0 up
    in priority and remove the RGB-is-it-really-TV hack I had just come up with.
    
    Finally, set the input/output mapping at mode set time.  We're always
    supposed to do this, but haven't had to so far as we've never handled
    devices with more than one output.

commit 3a17400dc67534f0eb474ece080f01061469569c
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Apr 2 14:21:23 2008 -0700

    SDVO: Handle RGB outputs that are really TV outputs, and select a TV format.
    
    Still doesn't light anything up.

commit 3c1701797b61afaae826a78455079e2115483053
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 31 10:04:18 2008 -0700

    Add WIP SDVO TV-out support.
    
    Doesn't include properties for selecting TV formats or picture enhancements,
    and totally untested.

commit 9d5ba26fb5c337388920b45eadda85e43bc564fa
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 28 14:28:28 2008 -0700

    Add SDVO TV-out registers.

commit 90886f9a602d58b754e9a8d0f1a9c40803d34fa2
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Apr 1 00:54:13 2008 -0700

    Remove extra flushing

commit 0836373dc6e2f8612f120074980561f7ac11f6f7
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Apr 1 00:16:05 2008 -0700

    Add projective versions of the PS kernels

commit bfd803e085e938866efb45c67a79facef78ec399
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Apr 1 00:06:08 2008 -0700

    Shrink WM thread to 32 registers and 1024 scratch space.
    
    Saving registers means we can run more in parallel.

commit a6492661ae07310128eb73c3ef037c42ce7ab184
Author: Keith Packard <keithp@keithp.com>
Date:   Mon Mar 31 23:50:20 2008 -0700

    Fix composite with mask using new compositing thread code
    
    Clean up register allocation to never overlap
    Always write 4 values for each texture vertex.

commit f8081178eb6fda0e405967cbacad532561619262
Author: Keith Packard <keithp@keithp.com>
Date:   Mon Mar 31 12:06:37 2008 -0700

    remove old shader source files

commit 879f8717b09f79156b218ee9cc2107700190d586
Author: Keith Packard <keithp@keithp.com>
Date:   Mon Mar 31 12:05:56 2008 -0700

    remove old monolithic shaders

commit 6db8faeb754897b21af045d00f50db9640b080bb
Author: Keith Packard <keithp@keithp.com>
Date:   Mon Mar 31 12:04:00 2008 -0700

    remove old monolithic shaders

commit 6bb92213374f278387c539bbe05b773e87e11b90
Author: Keith Packard <keithp@keithp.com>
Date:   Mon Mar 31 11:59:14 2008 -0700

    Back to new shaders, fix urb read length

commit 05710145b6fc4ed2c528128b2e6022591a53d050
Author: Keith Packard <keithp@keithp.com>
Date:   Mon Mar 31 11:31:31 2008 -0700

    Dont set the compr bit on 8-unit sends

commit 08500507284f13ad7084eb231b43e117e9728129
Author: Keith Packard <keithp@keithp.com>
Date:   Mon Mar 31 02:20:43 2008 -0700

    Use m4 to clean up gen4 asm progs. Start adding projective transform support.
    
    Use macros for register names, modularize functions into separate files.

commit 949d73271d7100c1f028fd60f185f4929461304e
Author: Keith Packard <keithp@keithp.com>
Date:   Sun Mar 30 19:19:46 2008 -0700

    Remove rotation sf and wm progs

commit 492ff1494f782240e6ca68919b2d0b9aa400fc53
Author: Keith Packard <keithp@keithp.com>
Date:   Sun Mar 30 19:14:18 2008 -0700

    Fix the sf_mask program to compute and pass corrected uvw cooefficients
    
    sf_mask is the same as sf except that it must compute both src and mask uvw
    cooefficients, which are conveniently adjacent in the same registers, and so
    need only an extended execution width

commit 6304b38423f99190a5e54f1a7dcaa75adfad4f2a
Author: Keith Packard <keithp@keithp.com>
Date:   Sun Mar 30 00:54:51 2008 -0700

    Reimplement wm program for nomask case to handle affine transforms
    
    This involves correctly computing u/v locations based on x/y vectors and
    line constants computed in new sf program.
    
    Also, use fewer instructions to make this go a bit faster (2X for 500x500
    composite).

commit 771a56b1ed0df69345c723cb62a73b6842cd8227
Author: Keith Packard <keithp@keithp.com>
Date:   Sun Mar 30 00:54:07 2008 -0700

    Clarify comment in exa_sf program

commit 4f469189fed541549e5d470b2529275a29cc2f20
Author: Keith Packard <keithp@keithp.com>
Date:   Sat Mar 29 14:28:05 2008 -0700

    Compute du/dv/dw in no-mask SF prog

commit 7dcb6e627449c80cea9812462ce6a3e125bd1240
Author: Keith Packard <keithp@keithp.com>
Date:   Sat Mar 29 14:27:35 2008 -0700

    Disable cursors while switching modes

commit d50264fc7c4e0f80d9cc68dfdf322f68520a0f1e
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 28 15:15:26 2008 -0700

    Add a "total" field to intel_idle output (set when any unit is busy).

commit 1450acd046d47e1739a3ffbd146c73ad2974a935
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Fri Mar 28 13:23:02 2008 -0700

    Use combo backlight control rather than pure legacy
    
    If the legacy bit is set, use both the BLC_PWM_CTL and LBB regs to control the
    backlight, rather than just LBB.  Looks like more platforms want that than what
    the current code does.  Note that kernel provided interfaces will always be
    used if available, so this shouldn't affect users with /sys/class/backlight
    interfaces at all.
    
    Fixes #14721.

commit 49f409fef5e8b04a8595309ba8959ca36b2e41b1
Author: Matthias Hopf <mhopf@suse.de>
Date:   Wed Jan 9 16:31:41 2008 +0100

    Include missing stdlib.h for free()

commit 3414313ac9d0faa95797ee18cc33afa231ec7581
Author: Matthias Hopf <mhopf@suse.de>
Date:   Wed Jan 9 16:08:57 2008 +0100

    Fix obviously wrong verification of DRI_SUPPORTS_CLIP_NOTIFY.

commit c40f195f2dc3467259b4588e087aac9741003ebf
Author: Matthias Hopf <mhopf@suse.de>
Date:   Wed Jan 9 14:40:49 2008 +0100

    Fix obviously stray '(' in non-I830_USE_EXA case.

commit 7bba2c13310ed5ac22a355a3cc0ec8b7afaa79cf
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Mar 28 11:41:24 2008 +0800

    Disable DRI earlier if fb width > 2048

commit b1f358ba97473b792ec2b7ed5170152faebe7262
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Mar 28 11:29:40 2008 +0800

    Disable overlay on new mobile chipset
    
    It's gone, really.

commit 588371ba15afffa9343629f0ea7ce530586eef0b
Merge: 52d6ced... c13efdd...
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Mar 26 14:53:15 2008 -0700

    Merge branch 'master' into pfit

commit c13efdd3d6d3846078766814b57306a7519bce18
Author: Paulo Cesar Pereira de Andrade <pcpa@mandriva.com.br>
Date:   Wed Mar 26 10:11:36 2008 +0800

    More compile warning fixes.
    
    o Check for RANDR_GET_CRTC_INTERFACE before defining functions that
      are used only if it is defined.
    o Declare a variable before code, and rename it from ret to xvmc_status
      to better describe it.
    o if 0 some static functions not used.
    o Don't declare some unused variables.
    o Declare as static some functions that are used only in the file defining it.
    o Add a default/fallback return True to the Bool function
      src/xvmc/intel_batchbuffer.c:intelInitBatchBuffer().
    o Ansify src/xvmc/xf86dri.c.
    o Add missing prototype to src/xvmc/xf86dri.h and follow pattern of other
      headers by adding "extern" before function prototype.

commit 8cdbd55f8075cd18b563badde35815665d7d053e
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 25 10:06:14 2008 -0700

    Fix 965+ rendering issues with DRI disabled.
    
    The new chips no longer automatically flush the rendering cache, so if we
    don't flush the RC at blockhandler, the last rendering done may not
    appear on the screen.  This was particularly noticable with a bare Xorg with
    some missing root weave, and terminals where the last character wouldn't
    appear until the cursor blinked.  A flush in the DRI blockhandler path had
    hidden this issue for most people.

commit c02ab432dd7058c700c35eecf6215daf5f262c51
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 24 13:48:20 2008 -0700

    Revert "Use mprotect on unbound AGP memory to attempt to catch use while unbound."
    
    While I still like the idea, the mprotect calls themselves are failing on
    Linux and causing more trouble than they're worth.
    
    This reverts commit a1612b7728d4153499fe86b6713a13c8702cc7d9.
    
    Conflicts:
    
    	src/i830_driver.c
    	src/i830_memory.c

commit 552a1b824db31a234d7c5cb71057ed0e0ce64477
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 24 13:25:37 2008 -0700

    Disable a bunch of clock gating disables on IGD_GM, which doesn't need them.
    
    Besides our driver having fallen through to the GM965 path for
    RENCLK_GATE_D1, the BIOS was turning some of these on.  It may be relevant
    for previous platforms as well to zero out the fields that should be zero
    in the other registers.

commit c1a2bc357fc122d3718eca771530367ba2915815
Author: Julien Cristau <jcristau@debian.org>
Date:   Mon Mar 24 13:29:24 2008 +0800

    Don't try to build XvMC if DRI is disabled
    
    Instead of failing the build, don't even try unless --enable-xvmc was used.

commit 5fcc002f77ebb66c1dc0f901a377ccf9bbc1d0bd
Author: Maxim Levitsky <maximlevitsky@gmail.com>
Date:   Mon Mar 24 13:24:12 2008 +0800

    Fix crash triggered by dpms low power mode with hardware overlay running
    
    When overlay switch crtc, it ignores current crtc dpms mode which
    might lead to hang.

commit 645980596450ed21c3b8927410a6bfe38a0c55d1
Author: Keith Packard <keithp@keithp.com>
Date:   Fri Mar 21 03:08:24 2008 -0700

    Transformed coord computed using floats. Don't move bilinear composite dst.
    
    The homogeneous coordinate computation in the core server cannot be used for
    many legal matrices as it overflows. Just use floats in the driver; faster
    and avoids troubles.
    
    When compositing with bilinear filter, don't push the dst coordinates around
    as that makes the output blurry when pixels are aligned.

commit bf725b92cf93d74a6f414f81f319dddbc2c78525
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Mar 21 11:50:27 2008 +0800

    xvmc: fix distcheck
    
    Add i915 headers in Makefile.am

commit e8da1a5418ab240ae7b1ef95bfea6bee22f1e0c1
Author: Joerg Sonnenberger <joerg@britannica.bec.de>
Date:   Fri Mar 21 11:41:49 2008 +0800

    Fix DRI config for NetBSD
    
    Reported by Joerg. This does a little more clearn up.

commit 224c36cc14a7552bc5df793ad582f0ea5349eb1e
Merge: 4b9b7b0... 03ccffd...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Mar 20 10:31:57 2008 +0800

    Merge branch 'xvmc'

commit 52d6ced652059989e6d9780a149488ccd16e3a22
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Mar 19 11:59:15 2008 -0700

    Fixup backlight control and panel fitting property names
    
    They should be listed as lower case, since that's what you'd pass to xrandr.

commit 4b9b7b007d729f94b01b0031d8ae478134b501da
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Mar 18 14:08:19 2008 -0700

    Handle projective transforms on 9xx for Composite.
    
    Projective transforms require un-normalized texture coordinates and the use
    of the texldp instruction. The coordinates are passed as x/y/z/w (the z is
    unused, but there isn't a vertext format for just x/y/w).

commit f699389818f1f11f3edddcdddcd0a43be21ba4c0
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Mar 18 14:06:47 2008 -0700

    Add i830_transform_is_affine and i830_get_transformed_coordinates_3d.
    
    These are needed to deal with projective transforms in the composite
    operation.

commit a55974b435224fe5726fa44298d051c71e4056a5
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Mar 18 13:47:20 2008 -0700

    Add defines for 9xx S3 word in 3D_STATE_LOAD_STATE_IMMEDIATE
    
    These aren't used at this point, but what the heck.

commit 4f5500abe209b92b39ae1f2d7a1118362ac95034
Author: Keith Packard <keithp@keithp.com>
Date:   Tue Mar 18 13:45:46 2008 -0700

    8xx/9xx can handle textures to 2kx2k. 965 can do 8kx8k

commit b1b173d03b3acd300c3b0f0ceffeddf1a8137839
Author: Julien Cristau <jcristau@debian.org>
Date:   Tue Mar 18 12:02:25 2008 +0100

    Add i8[13]0_ring.h to _SOURCES to fix distcheck
    
    Thanks to Bruno <bonbons67@internet.lu>.

commit 03ccffd5b9b8108166ea143884a1a0a6417f3236
Merge: ac76363... d72e18c...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Mar 18 16:54:15 2008 +0800

    Merge branch 'master' into xvmc

commit ac763634069fe070b3afc073ce437959612d39fe
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Mar 18 16:52:29 2008 +0800

    Disable XvMC if DRI is not enabled.
    
    Default XvMC to disabled.

commit d72e18c10995079121eded758a60ed99b5b8ce1a
Author: Paulo Cesar Pereira de Andrade <pcpa@mandriva.com.br>
Date:   Mon Mar 17 16:59:12 2008 +0800

    Compile warning fixes.
    
    Move some declarations and don't declare an extra variable with the
    same name, to fix warnings about mixed declarations and code.

commit 81df48d8d151907c2e9dd33a729860c39aa78175
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Mar 17 10:05:57 2008 +0800

    bug 15060: Dell Latitude X300 needs pipe A quirk

commit ffb5a115cc62ed63110f77815b7f04976f720065
Merge: 05cf070... 24e6eb2...
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Mon Mar 17 15:19:05 2008 -0700

    Merge branch 'master' into pfit

commit 24e6eb2ae683ed6614ac79c0d7811ac9fe94209f
Author: Jesse Barnes <jbarnes@jbarnes-t61.(none)>
Date:   Mon Mar 17 14:17:27 2008 -0700

    Add support for new ->get_crtc output callbacks
    
    Using the new interface allows the server to avoid some flicker at startup.

commit 69fbc17441d0f894d17b058e65ae22300cd2a54c
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 14 10:04:18 2008 -0700

    Change OUT_RING and similar calls to OUT_BATCH for batchbuffer merge

commit 65f92cfb7a05c9c028cf73ce1221cc0a651b50b3
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 14 10:03:11 2008 -0700

    Remove h0h0 UploadToScreen implementation that used pattern blits.
    
    It never worked and was never that hot of an idea.  Most of the motivation is
    gone with glyph pixmaps anyway.

commit 05cf07071e25f84dec3476a9bed7235ed50cd249
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Thu Mar 13 18:12:00 2008 -0700

    Initial panel fitting changes
    
    Basic support for panel fitting.

commit 402fbd36221d2ed27913850f6bfcce768b970fe8
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Thu Mar 13 16:12:20 2008 -0700

    Remove fbc enable/disable messages
    
    Tired of them filling up my logs.

commit c20d78a7bc512219fa36dfc9707fe65f66ab80f1
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 10 17:27:45 2008 -0700

    Add workarounds for 830/845's lack of a8/x8r8g8b8/x8b8g8r8 support.
    
    When we have unset channels (color for a8, or alpha for x8*), force them
    to the appropriate value in the texture combiner rather than relying on getting
    the desired results from teture mapping.  Performance is the same on 865, so
    multiple paths aren't necessary and we can use the less friendly texture
    formats everywhere.

commit f425181695b1b3864373e1919cf651229f19fa69
Merge: f4cfc98... 1c0e495...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Mar 13 23:58:56 2008 +0800

    Merge branch 'master' into xvmc

commit f4cfc98ab038af4d5d52af12e4d60ded62cf4a6e
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Mar 13 23:56:48 2008 +0800

    nuke unneed error_base and event_base

commit f269c69b4e7be076dc9838d0e0801c940ccdba08
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Mar 13 23:41:22 2008 +0800

    remove unused init/fini hooks for xvmc driver

commit 1c0e4958564588162bc22a980567436dfc9d1e56
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Mar 13 10:15:55 2008 +0800

    Always bind memory after agp aperture allocation
    
    This fixed the crash appearing for Xv buffer memory, which appears
    allocation and free happening in stolen memory. We should always
    try to bind for stolen memory for correct protect setup, otherwise
    we might get fault that stolen memory protect reverted to non-r/w
    after previous free and unbind.
    
    Credit goes to Lukas Hejtmanek to identify the real problem of Xv
    crash!

commit 2e2372912ed9bc0d86e8960653ef0bfce5cf99ab
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Mar 12 11:38:56 2008 -0700

    Eliminate local variables defined in i830 BEGIN_LP_RING().
    
    This lets us get better sanity asserts, and avoid mysterious braces when you
    do two BEGIN_LP_RING()s in a single function.  Potential minor performance
    loss isn't too exciting, as ring access is about to become a compat path
    anyway.  This change also removes the requirement for ring emits to be aligned
    to dwords.

commit abf11a274e14535630742fe4c41cc0ae92555293
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Mar 12 11:03:26 2008 -0700

    Separate i810 and i830 ring macros out into separate files.
    
    I want to hack on i830 for changing it into a compat path for batchbuffer
    without having to worry about the i810 stuff getting broken.

commit e04908853db74dc76718f6bc0dfb23b5ab3c5837
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Mar 12 15:44:58 2008 -0700

    Add sysfs backlight support for Fujitsu laptops
    
    Tested by Dan Williams.

commit 907399660b83b3939aab3dc7d0697197441e4ec8
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Wed Mar 12 12:33:36 2008 -0700

    Add stdint.h to DVO drivers
    
    Fixes the build for me (just following the git development guide on a
    new machine).

commit 8563effc96195116c96f89a801c1de6ab982630a
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Mar 12 11:14:17 2008 -0700

    Add stdint.h to i830_bios.h
    
    Needed for new uint* usage.

commit c82d8e51c6ff9522ad0deb33399d13f3d6fef19d
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Mar 12 11:13:50 2008 -0700

    Add pipe A force quirk for Thinkpad R31
    
    Fixes #15036.

commit a8f4108bea0966406b0fcae8d062ae1cfb4afbb3
Author: Hong Liu <hong.liu@intel.com>
Date:   Wed Mar 12 21:55:56 2008 +0800

    Fix rotation mem with kernel memory manager in VT switch
    
    Unbind and bind a DRM BO may change the buffer offset, thus
    crtc may reference a wrong rotated memory after a VT switch cycle.
    Destroying it here will cause its reallocation when entering VT.

commit cd73c6a5a78eac726b14ef242b8452c559c4c003
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Mar 12 20:37:41 2008 +0800

    Pass default visual in dri context create

commit 21580add63307ca68790bf911243b8675f5f7c64
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Mar 12 20:37:17 2008 +0800

    disable memory alloc debug

commit 5f272471878c896038b2c3f2bf704655d908828d
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 11 12:14:51 2008 -0700

    Nuke more CARD* types from i810 driver.  Untested.

commit 9a62d3b598cca3c28fa8b6313bba82983cc29ecf
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 11 12:07:52 2008 -0700

    Remove i830+ driver's use of CARD*/INT* types for great justice.
    
    Several uses are actually left, which are determined by the X Server
    interfaces we're implementing.

commit 15f17aa682129c57d3864a355834edff06e91540
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 11 11:27:10 2008 -0700

    Cleanse DVO drivers of CARD* types.

commit 642ba6278876ec945ad687c2b9624e532cd3f629
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 11 09:59:16 2008 -0700

    Add support for brightness control to i915 textured video output.

commit ecdb5963ef6873ab82998dca6ca5186644666ec8
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Tue Mar 11 11:08:25 2008 -0700

    Add pipe A force enable quirk for Toshiba Portege R205-S209
    
    Fixes #14944.

commit 4ea67e9b853e9ed61557780b87bd184fc81fd731
Author: Kristian Høgsberg <krh@redhat.com>
Date:   Tue Mar 11 13:54:33 2008 -0400

    Crack down on warnings.
    
    Fix printf formatting warnings, wrap a couple of long lines, nuke
    unused variables, add missing #include <unistd.h>.

commit 9fd13e6773371c82b9799a5bda7c96ffa5cafe8c
Author: Kristian Høgsberg <krh@redhat.com>
Date:   Tue Mar 11 13:48:07 2008 -0400

    Silence warnings about possible uninitialize use of dst_format.
    
    Whoa, gcc got a lot smarter about warnings.  If iXXX_get_dest_format()
    doesn't support the picture format passed in it won't initialize the
    uint32_t pointed to by dst_format and return FALSE.
    
    What gcc now can detect is if dst_format is used without checking the
    return value, it might be used uninitialized.  This patch makes sure
    we always check the return value before using dst_format.

commit 31654f52b084ebb32f69854dfb1c342c9da07928
Merge: a03aca1... 02c0ffb...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Mar 11 14:37:41 2008 +0800

    Merge branch 'master' into xvmc
    
    Conflicts:
    
    	man/intel.man
    	src/i830_driver.c

commit 02c0ffb1d8112a6fb03f9c8eae9ec1a1fca123ef
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Mon Mar 10 11:51:37 2008 -0700

    Add pipe A force enable quirk for Dell Latitude D500
    
    Fixes #14888.

commit a1cd37f94cb8efbde84ba0a46839fb8735dd3595
Author: Dave Airlie <airlied@clockmaker.usersys.redhat.com>
Date:   Mon Mar 10 14:43:24 2008 +1000

    quirk: add DVO ivch quirk

commit f2b9f387af7f618ad083b1ec8bee513ff2157d06
Author: Matthieu Herrb <matthieu.herrb@laas.fr>
Date:   Sat Mar 8 23:36:56 2008 +0100

    Makefile.am: nuke RCS Id

commit bf6d59ee98127ac6447848c4202c54d861a510d4
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 7 14:26:22 2008 -0800

    Avoid setting reserved bits in SDVOx on everything 965-class.
    
    This will likely fix SDVO outputs on G35 hardware.

commit 5915c75422c5277d530e7f8ecbdfe94654706efd
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Fri Mar 7 13:18:09 2008 -0800

    Enable hardware overlay on 965
    
    Based on Maxim Levitsky's patch for the same.  Many thanks to Maxim for
    discovering that this features still works in recent hardware!

commit 13ae79b415d944891cfdc2cd2d5397fec36a4e8e
Author: Dave Airlie <airlied@redhat.com>
Date:   Fri Mar 7 08:04:37 2008 +1000

    fixup pciaccess version detect

commit be08b61540e1edbb7673f0b6add0f1e32b136b3c
Author: Jesse Barnes <jbarnes@jbarnes-t61.(none)>
Date:   Thu Mar 6 13:55:13 2008 -0800

    Implement new get_property feature for backlight control
    
    This should keep the backlight value reported by xrandr --prop & xbacklight
    consistent with changes by other software in the system (like the hotkey driver
    or kernel backlight driver).

commit 502e41f6dff91393cfeaf08c9ba312781d1b7267
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Mar 6 19:32:29 2008 +0800

    remove extra dri checking
    
    And directRenderingDisabled already has config check result.

commit ea58d66cf778c0477c30e5bfe3142b64e8b971d5
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Mar 6 19:31:33 2008 +0800

    No ring, no sync

commit c823fb00a20f523f50a2779c36aa1c014ba01535
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Thu Mar 6 19:29:22 2008 +0800

    Pull chipset detection out of PreInit into its own function

commit 6b16cee0786b636dc849826193b26e898832a73c
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Thu Mar 6 19:27:42 2008 +0800

    Account for FBC LL cache in memory reservation
    
    When we reserve memory (memory that won't be managed by the kernel) make
    sure to reserve space for the FBC LL cache as well.

commit 6f04d02471f1cebc76eab637a9a78c4004fd3cc9
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Thu Mar 6 19:27:07 2008 +0800

    Move MTRR fixup to its own routine

commit 750beb9232b51223d8e650878ce8dad071f0d0b3
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Thu Mar 6 19:24:47 2008 +0800

    Refactor memory allocation into a separate function
    
    This simplifies the memory allocation code and fixes a number of bugs.
    Prior to this change, some flags may have been set after memory
    allocation occurred, meaning they had no effect.  It should also make
    the allocation logic clearer.

commit d466b25d09bbe85abe84d9d7714ffb65fafe7593
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Mar 5 13:38:58 2008 +0800

    Really print adjusted_mode for mode debug

commit d767eabe534be7f7bdcbf00614a8901124ac911f
Author: Hong Liu <hong.liu@intel.com>
Date:   Thu Feb 28 13:51:18 2008 +0800

    Fix DPLL programming in CRTC mode set
    
    The following patch fixes the display problem on internal development machines.
    The code in commit 3c22ed633be2ac96eea7bc533839e956f1f31b84 (Jesse's force pipe
    A enable patch) broke DPLL programming.  Moving the DPLL set back up in the
    function solves the problem.
    
    Fix for internal bug #309.

commit 4936e097028b91f4bdc2d9101dc49f6fe586e718
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Tue Mar 4 08:52:40 2008 -0800

    Change FBC idle mode back to default
    
    Use the "immediate idle" mode for FBC.  Rather than waiting for the current
    compression pass to finish before signalling to the CPU that it's idle, this
    mode should stop any current compression pass and tell the CPU that the GPU is
    idle right away.
    
    Seems to fix #13326.

commit 02a3b80ee8341968dbce5b7cb871b187db5ff805
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Feb 29 11:13:34 2008 +0800

    Bug 14591: comment out MI_DISPLAY_POWER_DOWN as for 965GM only

commit ea7c7d088e0a3c3b7ab2bdd0475aa13379764bf4
Author: Peng Li <peng.li@intel.com>
Date:   Wed Feb 27 11:56:55 2008 +0800

    HP Compaq 6730s has no TV output

commit fdc25cb0ca7d479051cee66a032f9ee1b68db98a
Author: Mark Kettenis <mark.kettenis@xs4all.nl>
Date:   Tue Feb 26 17:26:50 2008 -0800

    Bug #14649: Fix build if pciaccess headers are not with other xorg headers.
    
    We failed to include the pciaccess header flags in our build.  Even if the
    server was to include those flags for us, it would leave us broken for the
    tools-only case, and it's easier to just put the flags everywhere so we avoid
    future copy'n'paste mistakes.

commit e55d86f654aa9dd4951b441636c8ca4b37786daf
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Feb 26 12:26:23 2008 -0800

    Fix SDVO I2C access on Mac Mini in EFI mode.
    
    The GMBUS was being left in SDVO pin access mode, which blocked our bit-banging
    access to those pins.  Thanks to Peter Jones for quick debugging turnaround
    in getting this fixed.

commit 6935c732c351585f31e2094c4201a00e3d5529b3
Author: Julien Cristau <jcristau@debian.org>
Date:   Mon Feb 25 14:47:02 2008 +0100

    Look for src/{modes,parser} in $srcdir, not in objdir
    
    This makes the detection work in case configure is run from another directory.

commit 66cdccb021a4748b2af41e415c36ed58ca808df6
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Feb 25 14:29:09 2008 +0800

    Fix overlay rotation
    
    Track current covered crtc rotation in port's private,
    and fix overlay rotation transform to be against crtc mode
    coordinate.

commit 975d7833bc844485c7043538336bddcba7f7f90e
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Fri Feb 22 11:41:25 2008 -0800

    Add quirk for DVO channel selection
    
    Some machines want DVOA, some DVOB.  We can use this quirk to differentiate
    them until we come up with a better solution.  Patch from Hong Liu.
    
    Fixes #13722.

commit 33802b6ee3c298bae4d2b6f464ee5cc730a58506
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Feb 21 08:43:34 2008 -0800

    Add pipe A force enable quirk for ThinkPad X40
    
    ThinkPad X40s need this quirk or they'll crash frequently.
    
    Fixes #14521.

commit 444984a578aae92ff55c06da897ea1d23679e706
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Feb 21 08:37:42 2008 -0800

    Remove side effects from VGA debug code
    
    The VGA register dumping code was leaving ARX in data mode rather than index
    mode, which could cause problems for later software accessing AR* registers.
    Fix it to make sure it's in index mode when we're done.
    
    Fixes #14434.

commit 28049540d8a9f79401fcfeb90784f5a528e7b34f
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Feb 20 13:08:27 2008 -0800

    Fix DSP*CNTR restoration
    
    When checking which pipe a given plane was associated with, we weren't properly
    masking the pipe selection bits.  Fixes #14481 and should allow the driver to
    work with vesafb again.

commit 293120bfc40a5b828567551954d8312639e73578
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Feb 19 21:13:45 2008 +0800

    Don't leak memory if no DMI info is provided by kernel

commit cdc5cb7c3d24f36a30fb931b43ec6df8294709e2
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Feb 19 08:51:53 2008 +0800

    Fix last 8XX clock's p2 value commit
    
    My fault to change Hong's origin patch reversely.

commit be0591880f20bdcbae159d5ab47113b6cc6fbffe
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Feb 18 14:35:06 2008 +0800

    Fix Lenovo X60 TV quirk
    
    Z61 has same subsys ids with X60, but does have one S-video
    TV out. Use DMI info instead to quirk TV on X60, X60s.

commit d5e564c5f24b0d9320bc4908693d37e7e6d68bc6
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Feb 18 14:32:32 2008 +0800

    Add DMI info for i830 quirks
    
    Linux kernel has CONFIG_DMIID to export dmi info
    through sysfs.

commit 4a42b01f5ee5a673716d6959dfe0e693b037eb48
Author: Keith Packard <keithp@keithp.com>
Date:   Sat Feb 16 18:16:12 2008 -0800

    Decode DSPCLK_GATE, dump PIPE*STAT, MI_MODE, MI_DISPLAY_POWER_DOWN, MI_ARB_STATE, MI_RDRET_STATE, ECOSKPD

commit 663313559873208c00c3d3748b99d837949ecdf2
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Feb 15 13:20:22 2008 +0800

    Bug #14440: fix stolen mem size mask on i830M
    
    For i830M stolen mem size mask should always be 0x70.
    Use 0xF0 for later chipsets should be ok, so behavior is
    identical to kernel agp.

commit 8c8ca16120927fc2d3cf8bcd5212a4227a280708
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Feb 8 11:34:04 2008 -0800

    Add a little program to output the stepping information for several chipsets.

commit f5896dcd1f5a964dce024ab8887ac8a79f7093a1
Author: Jesse Barnes <root@nietzche.virtuousgeek.org>
Date:   Thu Feb 7 11:56:28 2008 -0800

    Add CACHE_MODE_0 register to dump output

commit d59eaa8b1e6eeb9775c9d21c7a5fd28f25b2bc3a
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Feb 6 09:35:43 2008 -0800

    Only disable FBC if registers are available
    
    The call to disable FBC should only occur if the FBC feature is actually
    present or we may end up hanging on a read from a non-existent register.

commit 83a071e2c01eb71462273f25d86d77159ac51114
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Tue Feb 5 17:09:19 2008 -0800

    Fix build warnings on 64 bit
    
    Use PRIx32 for printing CARD32 types, and PRIx64 for portably printing uint64_t
    types.  Requires the addition of a new include, inttypes.h, to work.  Hope C99
    is ok with everybody...

commit abf4b0cafa038e97bd7a6e5ba107b822117b9ccc
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Tue Feb 5 13:30:51 2008 -0800

    Only enable FBC if one pipe is active
    
    Some chips can't support FBC if multiple pipes are active.  So if more than one
    pipe is on or we're going from one->two pipes enabled, make sure FBC is
    disabled.
    
    Intended to fix 13418, 13326, 13152.

commit f79a585d57c61fbe9af5684a336918e1fe3e8416
Author: liuhong <liuhong@devlinux-hong.sh.intel.com>
Date:   Tue Feb 5 11:04:34 2008 +0800

    xf86-video-intel: fix ivch using wrong dvo register
    
    We use the wrong DVO output register for ivch which is used for DVO LVDS.
    Vbios enables DVOB and driver never touches it, so everything seems
    working correctly now.

commit cabed67b6a0e4dd408eeb8d2083269100a65933c
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Tue Feb 5 11:36:24 2008 -0800

    Program FBC fence offset register
    
    Just a partial fix for some of the FBC issues people have been seeing.  The
    other half is to disable FBC if both pipes are running.

commit 332587081fb05d284864aabe608dd9988eee3d44
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Feb 5 10:34:55 2008 +0800

    Fix last commit on i8xx debug p2 value

commit 2d18a299cf39f2ecf9bd3ba8407f892566b2edcc
Author: Hong Liu <hong.liu@intel.com>
Date:   Tue Feb 5 09:10:48 2008 +0800

    Fix PLL reference clk debug dump

commit 9536515d7717969795edc1b80d6e6a36820dd575
Author: Hong Liu <hong.liu@intel.com>
Date:   Tue Feb 5 09:06:14 2008 +0800

    Allow non-strict free order for bo_list

commit 11de831cb706025c003e98fef6d666d273192bcd
Author: Hong Liu <hong.liu@intel.com>
Date:   Tue Feb 5 08:58:44 2008 +0800

    Bug 10584: Mac Mini EDID data assigned to TMDS output
    
    EDID data for TMDS output got from crt should be applied
    to TMDS output on mac mini.

commit 95327571134d8ebb9d936d80b70c2f642393aa9f
Author: Hong Liu <hong.liu@intel.com>
Date:   Mon Feb 4 17:14:23 2008 +0800

    Bug 10773: fix i8xx pll p2 value in i830_crtc_clock_get()
    
    Also fix debug dump, slightly modified to use macro instead.

commit be1b568bc2379856c3eaaed365002512bebc218c
Author: Paulo Cesar Pereira de Andrade <pcpa@mandriva.com>
Date:   Thu Jan 31 22:47:18 2008 -0200

    Make sure symbols used by other modules are public.
    
    These symbols must be explicitly exported, otherwise if compiled with
    hidden symbols, LoaderSymbol (and dlopen) will fail to find them.

commit cc1031a834b81aa6f835c282ad86deddabe229a0
Author: Mark Kettenis <mark.kettenis@xs4all.nl>
Date:   Thu Jan 31 21:02:48 2008 -0800

    Bug #14246: Fix biuld on OpenBSD.

commit b1e1c7cd993ab4f1935d750eb8852e74be757e53
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 30 23:01:04 2008 -0800

    Add detail on different units to intel_idle.

commit aa3ac79759581b5eb05293a8cbcf89eb5b76712c
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jan 31 18:26:46 2008 +0800

    Don't crash if SW cursor
    
    In case of device option or hw cursor allocation fails.

commit 2e43bec8731ba1b172f7a0bf867bbb5c1adbda2d
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Wed Jan 30 18:59:12 2008 +0800

    Frame buffer compression support on new chipset

commit bf629466a46c4037ec7b7cc5ee16be947618bd68
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jan 30 18:55:20 2008 +0800

    hardware status page initialization rework
    
    Order hardware status page setup more reasonable after
    all memory bound, in case new chipset requires non-stolen
    page and that could be bound then.
    
    Also clean up drm irq handler install function, and put
    first install in starting stage later than status page setup,
    so we won't make device cry for uninitialized status page.

commit 04032dad28baab80131edbe8fe58aade8149bb71
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jan 30 18:52:32 2008 +0800

    Wrap up chipsets which needs graphics address for status page
    
    Also add support on new chipset.

commit b9c3fa79d9fd48c34536f92e6c1c70fe3a619410
Author: Keith Packard <keithp@keithp.com>
Date:   Fri Jan 11 15:51:00 2008 -0800

    Add intel_idle to measure GPU load ratio.
    
    Samples GPU idle register to detect when the GPU is busy; prints out the
    number of busy samples per 100 total samples once per second.

commit 5d9e67aec3ce458d22b7febd3819542abb360534
Author: Erik Andren <erik.andren@gmail.com>
Date:   Fri Jan 25 11:06:01 2008 +0800

    Clevo M720R has no TV-out

commit 6bf53eb48f40ad0c8ea9679ee634447410821b4f
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Jan 25 16:59:13 2008 +0800

    Set vtSema before EnterVT
    
    Which was missing in our ScreenInit and initial EnterVT.
    This not only causes failure in initial rotation with TTM,
    as we won't bind in rotate_mem alloc in this case, and hide
    another bug that we call randr12 function in I830LoadPalete
    before we call xf86RandR12Init.

commit 94a18fa1f8141837bdab32e545da7a7aed1cc396
Author: Julien Cristau <jcristau@debian.org>
Date:   Thu Jan 24 15:24:40 2008 +0100

    Don't build reg_dumper if we don't have pciaccess 0.10.0
    
    The pci_device_map_range() function was added in libpciaccess 0.10.0, and
    is used by the reg_dumper tool.  Don't try to build it if we have an older
    libpciaccess.
    Also make sure that util-macros >= 1.1.3 is available when running autoconf,
    because it's required for the PACKAGE_VERSION_* macros.

commit d341e41c863f1212bf2c6b84782a7e472b6612a1
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jan 24 10:40:18 2008 +0800

    Clear shadow memory after allocation

commit 88a1041c5361964d37107c22d77feaa1b2160656
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jan 24 10:36:06 2008 +0800

    Fix i830 block handler wrap
    
    which was observed in rotation crash with stack overflow.

commit db0a7c569e383436a2725e1e74f35fb426da1196
Author: Andreas Stawinoga <a.stawinoga@gmx.de>
Date:   Thu Jan 24 08:51:09 2008 +0800

    Samsung Q45 has no TV output

commit f54bba7600647c76fe3bd2d0133edc06dbea6a05
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Jan 22 00:48:23 2008 +0800

    Add missing i830M and 845G pci ids info

commit 633dbd28218fd8a746c1735fd44a14f35bd07faa
Author: Julien Cristau <jcristau@debian.org>
Date:   Thu Jan 17 22:34:21 2008 +0800

    Bug 14032: i810, set default depth to 16
    
    X fails to start without an xorg.conf on i810, because the default depth set by
    the server (32) is not supported by the driver.  I think the driver should
    default to 16 bits (it supports 24, but when I tested it that didn't seem to
    work very well, and dri is disabled at 24 bits depth anyway) instead of letting
    the server use 32 and failing later on.

commit 4fec18e07f2b23306e885d63c74661ae0e4b04d9
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Jan 11 10:28:59 2008 -0800

    Turn on backlight when LVDS panel is powered up
    
    In some configurations, the LVDS may be off at startup along with the
    backlight.  So when turning the LVDS on for the first time, we may also need to
    set the backlight to a non-zero value.  So try to use the saved value if
    possible, but if it's zero, make the backlight full brightness when turning on
    the LVDS.
    
    Note that this is slightly sub-optimal for configurations where zero is a valid backlight brightness.
    
    Fixes fdo bz #13958.

commit b5cf8faf8102e6313c23de87a680cc327ac95478
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Jan 10 14:25:18 2008 -0800

    Remove unnecessary quirk code in CRT probing
    
    Since we return early in the CRTC DPMS code, keeping the pipes & clocks
    enabled, this code is no longer necessary.  As an added bonus, VGA connections
    should be reported correctly even when the pipe A quirk is active.
    
    Updates fix for fdo bz #11432.

commit 3c22ed633be2ac96eea7bc533839e956f1f31b84
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Jan 9 09:47:38 2008 -0800

    Add pipe A force enable quirk
    
    On some platforms, the firmware may read & write GPU registers on lid close,
    suspend/resume time or during various SMM events.  If one of the graphics pipes
    is disabled at that time, the GPU may hang due to the programming dependencies
    of the various registers.
    
    This patch adds a quirk to force the driver to keep pipe A enabled if
    necessary, through user configuration in xorg.conf or via a platform specific
    quirk.  Leaving the pipe enabled comes at a power cost however, so the quirk
    should only be enabled when strictly necessary.
    
    Fixes https://bugs.freedesktop.org/show_bug.cgi?id=11432.

commit d3b41bcf231a6ffd289c128c06aa619f554a776c
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jan 9 21:28:25 2008 +0800

    Disable frame buffer compression on new chipset now.

commit 2f0c0427dc4113bac64cda07c6365df1f0637697
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jan 9 21:27:42 2008 +0800

    Update PIPELINE_SELECT instruction and surface state format for new chipset

commit 139e9affdd49dcbe08e260a0a2bd001de16566e6
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jan 9 21:26:57 2008 +0800

    GTT access change for new integrated graphics device

commit 4f288ff2d1e7d28bf49167f073fbce21492a7c32
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jan 9 21:25:47 2008 +0800

    Add new integrated graphics chipset ids

commit f089942689df622b1af00569eade4883a84eb7a3
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Jan 3 11:28:18 2008 +0800

    Change origin i965G_1 to chipset market name G35.

commit 71143200ed66cb9dcc1f9edf98128be80b05619c
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Fri Jan 4 15:01:25 2008 -0800

    Don't modify low bit of BLC_PWM_CTL when using combo backlight control
    
    On some platforms, the low bit of BLC_PWM_CTL is wired as a 'max brightness'
    flag, rather than a regular part of the backlight duty cycle.  So when in the
    combo mode, divide the total number of backlight levels available by two
    (tossing one bit) and adjust the programming in the set_brightness routine.
    
    Note that platforms with this behavior may need quirks added so that they work
    by default.

commit b434bf4029d1a405216454629bcea717c779ae5a
Author: hulifox008 <hulifox008@163.com>
Date:   Fri Jan 4 02:46:54 2008 -0800

    Fix copy'n'paste-o in unused airlied i2c code.

commit f2ffc0f6e038357dda268363e52c11ada1d0b810
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Jan 3 11:16:15 2008 -0800

    Fix compilation error when not using DRI
    
    This patch complements 88f8b688e2316ae4a1f7485f0010ce90de54783a which
    added uint64_t typed variables to avoid unsigned long overflows in
    32-bit architectures but didn't include <stdint.h> with the required
    definition.
    
    When XF86DRI and _XF86DRI_SERVER_ are defined this header gets
    indirectly included through "i830_dri.h", thanks to "i830_common.h"
    which masquerades this problem as released in 2.1.0 and that manifests
    with :
    
    In file included from i810_driver.c:88:
    i830.h:137: error: expected specifier-qualifier-list before 'uint64_t'
    i830.h:240: error: expected specifier-qualifier-list before 'uint64_t'
    
    Patch from Carlo Marcelo Arenas Belon <carenas@sajinet.com.pe>

commit a03aca101d4d51ed2279a99d1137ce3b7ef364e2
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jan 2 14:11:31 2008 +0800

    xvmc: setup driver info for XvMCGetDRInfo request
    
    User don't need to have XvMCConfig file then, if ld.so can
    find libIntelXvMC.so in ld path.

commit 0fd769b5882058e5ebf17ee1c1e35b4a3d46e6b0
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Jan 2 13:57:23 2008 +0800

    xvmc: add context id info in debug/trace

commit 83d304c61ad5fdc58b0a9309dbd1e5a3f6cd9b01
Author: Nanhai Zou <nanhai.zou@intel.com>
Date:   Wed Jan 2 10:50:44 2008 +0800

    TV: fix 576p refresh rate

commit a2bb2afd24c95e056b801c85dc12daeac54b37f0
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Dec 28 15:52:12 2007 +0800

    xvmc: move drmOpen earlier
    
    remove wrong comments

commit 96246c27cb836bae8ee02c46c68a1f2102efd14b
Author: Joakim <elupus@ecce.se>
Date:   Thu Dec 27 17:09:02 2007 +0800

    Aopen Minipc 965GM LVDS quirk

commit 666e01bd426a553f23eeb5040ecbc28b4abb87da
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Dec 26 09:51:09 2007 +0800

    xvmc: add info in intel.man

commit e75d0c20e3b02f649b62ac9da7f41bb43d0f3d80
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Dec 26 09:37:34 2007 +0800

    xvmc: make XvMC default on

commit ed9ff6f30fff33fe2d60715f1b503047f8e1ef01
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Dec 25 08:32:47 2007 +0800

    xvmc: consolidate put surface interfaces
    
    Make surface list track like context list, and move
    generic PutSurface code out of i915. So MC driver just
    needs to fill specific the command params, and we can
    get one single type of intel xvmc command to issue,
    ddx driver's put_image_size got removed.
    
    Fix last commit with missing XvMCContext assignment.
    
    Fix priv_data free with apropriate X11 XFree.

commit f0ced5edaeec3e7741828eab728417843326d56f
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Dec 24 10:53:57 2007 +0800

    xvmc: store XvMCContext pointer instead of context_id in internal ctx list

commit 216ad7398742f2f80b5477e89f827acb351b4d72
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Dec 20 13:39:32 2007 +0800

    xvmc: add disable xvmc build support
    
    Move xvmc source files under XVMC config

commit a811ca30659e8c477027ea9c91fb9fc516fdabc7
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Dec 20 13:08:07 2007 +0800

    xvmc: handle surface create/destory in generic code

commit 5f961f28310a1cd19967df2034b0452bf4446394
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Dec 20 12:51:06 2007 +0800

    xvmc: move dri context handling to generic code
    
    Use XvMCContext's context_id for dri context handling instead
    of driver private id. Remove unnecessary field for i915 private
    structs.

commit 73827e78357ab3f30a21f159ecdfb26dd0ea889b
Merge: 3cf8627... f69b48f...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Dec 19 22:47:02 2007 +0800

    Merge branch 'master' into xvmc

commit f69b48fe24ef94dac44b8123884ca71df675be4b
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Tue Dec 18 18:10:33 2007 -0800

    Unconditionally restore pipe configuration
    
    This is a partial fix for #13196, which covers both leaving pipes disabled at
    server exit time and problems with restoring the pipe configuration on certain
    chipsets.  It restores the pipe configuration unconditionally (previously we
    made sure the PLL was running and we weren't in VGA mode) but also adds some
    additional PLL settle time to the PLL register write paths.

commit 4757a218d733af12d04674455fc6e1fad48a1cd0
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Dec 18 19:37:46 2007 +0100

    Always set pPriv->buf to NULL after freeing the memory it pointed to.
    
    Fixes https://bugs.freedesktop.org/show_bug.cgi?id=13108 .

commit 5cbb4110116f6d4187fd27660a78203caa1da46b
Author: Adam Jackson <ajax@redhat.com>
Date:   Thu Dec 13 15:10:43 2007 -0500

    i830_sdvo_mode_valid: Fix return values to match what we actually check.

commit e03bc385e924222d3d5f3c9a8d65e1ef63b858dc
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Tue Dec 11 13:28:01 2007 -0800

    Add cscope files to .gitignore

commit e720ae4476c3f986f623ce0f0ab9775b8b9b7e05
Author: Jesse Barnes <jbarnes@jbarnes-mobile.amr.corp.intel.com>
Date:   Mon Dec 10 13:00:14 2007 -0800

    CRT hotplug detection improvements
    
    Patch from Hong Liu.
    
    Fixup CRT detection by making sure the pipe is enabled before CRT
    detection actually occurs.  Fixes bugs Hong was seeing on G35 and other
    machines.

commit d9df93578b74785c08ba860b4c9aa23b0c89c91c
Author: Dave Airlie <airlied@linux.ie>
Date:   Mon Dec 10 16:41:24 2007 +1000

    ivch: fails on address mismatch as I seem to get this on my 865 system

commit cd6f83519c69f72f146fea59afbd6a3542da783a
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Dec 10 05:49:58 2007 +0800

    Fix tv quirk for Dell Latitude X1
    
    which is actually 915GM, reported by
    Andreas Schildbach <andreas@schildbach.de>

commit 13ec9c8141a9f794258869a04a6bab59dac5eefa
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Sun Dec 9 00:52:13 2007 +0800

    exa: fix rendering issue on some 855GM laptops
    
    This trys to initialize more 3d states on i830 like mesa
    code, which fixes exa rendering failure for some 855GM users.

commit e2d9fd6425584119f28768d85c4b7d106ecf8742
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Fri Dec 7 16:30:46 2007 -0800

    Describe output properties in more detail
    
    Add descriptions for LVDS and TV output properties and also mention the EDID
    property a new output configuration section.

commit 6f92200db39a790c95c1fac64baf0bd41a70e481
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Dec 5 08:10:17 2007 -0800

    Fix backlight setting save/restore
    
    We need to save the current backlight value at LVDS init time, as well as when
    we change the DPMS setting.  Also, since 0 is a valid backlight value, don't
    set the backlight value to maximum at startup if the value happens to be zero.
    
    These fixes should make the backlight user experience much more consistent and
    hopefully less frustrating.

commit 4c1fa5235555c9ef3de1eebd006c4e91283362bf
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Tue Dec 4 18:27:24 2007 -0800

    Add BCM_ to backlight control method enums
    
    Avoids polluting the global namespace with such generic terms.

commit 30d74f1b1f30e751d2c47aa63a4a2043e71467dc
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Tue Dec 4 18:23:44 2007 -0800

    Use "LEGACY" backlight method if backlight control is such
    
    This may regress the user experience a bit (fewer backlight levels) on machines
    where both the LBB and native registers work, but it's better that it work for
    everyone than work extra well for some and not at all for others.

commit 0e554e6dd4da56be24d2f971ff4cd4d585936724
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 4 10:32:45 2007 -0800

    Remove extra have_libpciaccess=no that broke tools build with old servers.

commit 3cf862717688aa679b5e667cd041ddd6f5db0b58
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 29 23:12:16 2007 +0800

    xvmc: add "XvMC" option, default is false.

commit 6da4b7a80cdf730018435fe84485ecdad62bc860
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 29 22:56:13 2007 +0800

    xvmc: move batch buffer init/fini code into generic

commit 75ef3e669dac1259d282dcc8f54b197fc19f22b3
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Nov 28 22:13:55 2007 +0800

    Replace ALLOCATE_LOCAL/DEALLOCATE_LOCAL with xalloc/xfree

commit df47b7ba57f3e7dc8bac1898679186d9d48639ac
Merge: df718a7... 7f9ceff...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Nov 27 01:13:43 2007 +0800

    Merge branch 'master' into xvmc

commit 7f9cefffbf44a2d07b51cc13aaf2d54fcd8f2f22
Author: Alan Hourihane <alanh@tungstengraphics.com>
Date:   Fri Nov 16 15:56:08 2007 +0000

    vendor is CARD8

commit df718a77c854c9110a81c2bc2a32a9aac85850f2
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Nov 16 16:08:06 2007 +0800

    xvmc: add xvmc decoder type string

commit a03a758db0df615fbb44dae1ab6910bfeaeb54f9
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Nov 16 15:49:10 2007 +0800

    xvmc: move some i915 context destroy code to generic function

commit 7bfbcb4dc7806ae7543f230373e67f35ba30668d
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Nov 16 15:43:04 2007 +0800

    xvmc: clean batch buffer finish

commit a6e8f4ef0481c66fda4f22fcc4bb0ef9c000f0cd
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Nov 16 13:51:44 2007 +0800

    xvmc: remove i915 drm map type

commit 4a2b0f340357c4ca58dc9586fad1337b83966362
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Nov 15 18:36:54 2007 -0800

    Fix typo in 1920x1080 resolution entry

commit 6c68fcc93917565712b6a9386df54d0204e4ea8f
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Nov 16 10:04:46 2007 +0800

    xvmc: more i915 xvmc cleanups

commit 04b60b6d3436fb57163c23acf335364f0ea2f79c
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Nov 15 11:49:53 2007 -0800

    Bump version to 2.2.0

commit 6eecef4fed8a21dfdabef42eb69fd150b96167b2
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Nov 15 10:10:59 2007 -0800

    Adjust default TV out paramaters
    
    According to several users, a default brightness of 0 results in much better TV
    output.  Improved control of these parameters will be provided by Randr1.3,
    which will standardize several output properties across various chips.

commit 7552d80e367fe38bbc594fe94abd649917fe54d5
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Nov 15 10:07:34 2007 -0800

    Add 1920x1080 mode to TV out
    
    Allows users to use 1080p modes on TV out, see bug #13034.

commit e56c166ceb8c1ceddd5020e8de2d0b9d51f535a4
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 18:34:18 2007 +0800

    remove unnecessary i830_reg.h includes
    
    i830_reg.h only contains 3d engine cmds for 8XX chips.

commit 6f3de19159cd7a2d73ed212add909edb3aedce9c
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 18:33:27 2007 +0800

    Move fb compression reg definition into i810_reg.h
    
    where we put MMIO control reg in, and shared with intel_reg_dump
    program.

commit 1ff97991a4954d508cc260dda82b7678010d13c9
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 17:01:31 2007 +0800

    xvmc: intel_xvmc.c cleanups

commit 1cfdf192882b856bfc93b735cfb9cb813cac3fdb
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 16:38:21 2007 +0800

    xvmc: remove unused SAREAPTR macro

commit d9ea2fbdcce3c7c91428846eff43b65ac340f38d
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 15:25:35 2007 +0800

    xvmc: i915 rename files

commit 06c0579df8d45f7f04b96956353d5f86cf59148f
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 15:01:56 2007 +0800

    xvmc: some code clean up

commit 4983e3401390654098dbf99dcfb45bab060b068c
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 13:56:24 2007 +0800

    xvmc: move locking code into generic place

commit bcd656c8dfe7309a5cf02ce1da8bc747ccd6e21c
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 11:18:38 2007 +0800

    xvmc: oops, should first map batch buffer before init

commit 0464af581b0fcfc4d1c7fec8160d812262086177
Merge: 2256519... e56c166...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 11:05:44 2007 +0800

    Merge branch 'master' into xvmc

commit 22565198b360826ba10e7ca05d272c419054dc08
Merge: 619044b... e64f492...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 18:53:22 2007 +0800

    Merge branch 'master' into xvmc

commit e64f4929690a57701241334fbca17e95b39ba3d4
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Wed Nov 14 16:44:34 2007 -0800

    Backlight fixes
    
    Open the "actual_brightness" file as read only, since we only read from it.
    Also set an initial backlight_duty_cycle at init time so we don't set the
    brightness to 0 at startup.

commit 53e3693ef13f31f3fc33bcff7286ab2b03b2d430
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Nov 14 16:24:56 2007 -0800

    Disable FBC by default on 965GM
    
    Several people have reported that they see frequent FBC related display
    corruption on 965GM, so disable it for now.  Users wanting to enable it can use
    the driver option "Framebuffercompression" to override the default.

commit b2726899bc6ebd108aa4a5dd66fe1d881bb778b3
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Nov 14 15:49:41 2007 -0800

    Add more FBC regs
    
    Needed for the new debug code

commit b7bc694c6b98dac17763426d905a22d3ae17a018
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Nov 14 15:46:57 2007 -0800

    Fix kernel get_brightness function
    
    We need to look at "actual_brightness" rather than "brightness".  The former
    contains the brightness value the kernel driver has actually set, while the
    latter is merely what the user requested.

commit 9ee96ed02aacd953ab58288fddf0fa60f60b668e
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Nov 14 15:44:56 2007 -0800

    Correct FBC debug message
    
    To be consistent, it should say 'plane' rather than 'pipe'.

commit 675b9471d84059496ca41d427a4f95d419f82be9
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Nov 14 15:17:05 2007 -0800

    Add FBC registers to register dump output
    
    Just for completeness.

commit a2a0821e74a61f53cc7f0c41ce629644ad712114
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Wed Nov 14 11:30:20 2007 -0800

    Don't stop ring before restoring hw state
    
    Some of the hw state restoration callbacks may want to use the ring for various
    things like stopping video playback, so leave the ring enabled until we get
    back from RestoreHWState.  Also rename the functions so that their purpose is
    clearer and remove a couple of redundant lines.

commit 619044b242d4abf605b42cfff538b63f445fe709
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 02:23:07 2007 +0800

    xvmc: move batch buffer init/fini to intel_batchbuffer.c

commit ae805ac379ccfdae9ee272896665e73f5bc7d2cf
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 15 02:13:07 2007 +0800

    xvmc: take out batch buffer handling code

commit ad3bc0158d37e98fcbbe6a8e31413c142a260424
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Nov 14 22:46:46 2007 +0800

    Don't enable fbc with XAA or tiling is off.
    
    This slightly reworks my last fbc patch. We don't
    support tiled front buffer with XAA now, so also
    disable fbc on it. If tiled alloc failed, disable
    fbc too.

commit 26194e19e1c80615697016e25640d4c8c244353f
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Tue Nov 13 22:26:40 2007 -0800

    Review PLL spreadsheet and update register ranges.
    
    The PLL spreadsheet makes the precise register ranges allowed for each mode
    quite clear, and shows a few inaccuracies in the b-spec. In particular, the
    N register value may range from 1 to 6 instead of 3 to 8. This should close
    the gap we've seen in the reachable frequencies.

commit 581509321e51becb8ee6ddcfaa15a2a713c9ef8e
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Nov 14 22:16:04 2007 +0800

    Remove one redundant line.

commit 8cea3c8cfa86600b5f2c3e1f21c19d4b2a320fd4
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Nov 14 22:13:30 2007 +0800

    Don't setup fb compression if fb is not tiling

commit 539b669d6e23833a917a9b0d3a355d4283e0b76a
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Tue Nov 13 17:59:54 2007 -0800

    Remove harmless error message
    
    This really isn't an error in general.  If vblank pipe setup really fails for
    some reason, it'll be obvious enough when the user tries to use vblank events
    for something.
    
    Patch from Hong Liu.

commit e8db8584ae4860aa991c916126335b287a972d5b
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Nov 14 00:11:20 2007 +0800

    xvmc: attempt to move batch buffer code out of i915 private

commit 11c0e0dbef42f1ae77a77d534870d3e9821fb017
Merge: c838f72... 43fbc54...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Nov 13 22:44:06 2007 +0800

    Merge branch 'master' into xvmc

commit 43fbc547786cf26514f95bce79fab58a66c291bf
Author: Jesse Barnes <jbarnes@jbarnes-mobile.amr.corp.intel.com>
Date:   Mon Nov 12 12:23:41 2007 -0800

    Improve backlight control
    
    This commit fixes backlight support for several platforms.
    
    Except on recent machines supporting the IGD OpRegion specification,
    backlight control is rather platform specific.  In some cases, we can
    program the native backlight control regsiters directly without any
    trouble.  On others, we need to use the legacy backlight control
    register.  On still others, we need a combination of the two.  And on
    some platforms, none of the above will work, so we go through the
    kernel backlight interface, which provides a platform specific driver
    for backlight control.

commit 10988c5e6ec0f3c40d56bbf209b7976627cca706
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Mon Nov 12 09:19:22 2007 -0800

    Fix typo in PLL enable check
    
    Check against DPLL_A instead of DPLL_B before writing PIPEACONF.
    
    Thanks to Colin Guthrie for his sharp eyes.

commit ab2055ebb20aa6de121fa377e488ce91913035ae
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Fri Nov 9 13:55:46 2007 -0800

    Add 'ret' variable to i830_allocator_init
    
    Needed in the XF86DRI_MM case.

commit 24280edbdf54e9559b26ea27c1b005eea73f51bc
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Fri Nov 9 13:53:58 2007 -0800

    Fixup warnings
    
    Remove unused 'ret' variable, move pI830 under #ifdef XF86DRI_MM in
    i830_allocate_memory.

commit 4fe507957bf826d81a71cd63af17c5547d1023a1
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Fri Nov 9 13:51:11 2007 -0800

    Remove unused 'palette_enable' variable

commit 62404a9c9c0d98efb69ac96209dea17331e0489c
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Fri Nov 9 07:55:01 2007 -0800

    Update man page to reflect EXA by default

commit c838f7297f675ea9d82678ed37715955cb0a8a78
Merge: a9449ff... 6f53568...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Nov 9 19:37:07 2007 +0800

    Merge branch 'xvmc' of git+ssh://zhen@people.freedesktop.org/~zhen/xf86-video-intel into xvmc

commit a9449fff4be8e6b3cc82914376420e3a66b960f5
Merge: a470f6b... 177924e...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Nov 9 19:36:25 2007 +0800

    Merge branch 'master' into xvmc

commit 177924e879564b7e9e70fd607141978bfd053fff
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Thu Nov 8 18:16:48 2007 -0800

    Bump driver version to 2.1.99 in preparation for 2.2 release

commit cb4e5796f0537ea5e0e646d473930c7b826c85d8
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Thu Nov 8 18:13:47 2007 -0800

    Default to EXA
    
    If EXA is compiled into the driver, default to using it for acceleration.
    Hopefully we can remove XAA entirely one day.

commit 43a59ab26b09fcc24de1ed7bd770bb622f899ceb
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Nov 8 16:52:41 2007 -0800

    Clear current video crtc on DPMS off
    
    When calling the video DPMS off function, make sure we zero out the current
    crtc so that it will be properly re-set up next time video is turned on.
    
    Fix from Peter Clifton with changes by Keith Packard.

commit e784e152a8e84b6e447b55a5c7019e7b47e17621
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Nov 8 16:37:53 2007 -0800

    Fix overlay destination clamping
    
    The overlay width & height scaling clamp check was reversed.  Fix that and
    update the comment.

commit b8770f710729d616b3ac72544aa522161a78f819
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Nov 8 16:19:01 2007 -0800

    Setup 3D state at EnterVT time
    
    In the absence of full suspend/resume support in the kernel, we have to
    save/restore state in Enter/LeaveVT.  For 8xx chips, 3D state may be lost
    during suspend/resume, so re-emit the basic setup at EnterVT time.
    
    Patch from Peter Clifton.

commit 5f92b4c2db9712496b829ee239468e3d14e27d2f
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 8 13:31:51 2007 -0800

    Bug #12059: Add ch7019 to the list of supported devices for ch7017.
    
    While I'm here, fix the chip description to be LVDS instead of TMDS in i2c
    device.

commit eecd3ccedee6c4acf101591f7e60673660379e62
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Thu Nov 8 09:31:08 2007 -0800

    Check DPLL status before writing PIPEnCONF regs
    
    If the DPLL isn't enabled or is in VGA mode, writing the PIPEnCONF registers
    may cause a hang or crash.  So ensure the DPLL is in the proper state before
    writing them.
    
    Another excellent fix from Peter Clifton.

commit b434c1a437c407de88396b219560649c2dae82b2
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Thu Nov 1 12:06:07 2007 -0700

    Framebuffer compression fix: front buffer may not be at fence 0
    
    Fix a long standing bug in the framebuffer compression code (thanks to
    Pierre Willenbrock!) that prevented FBC from working correctly if the front
    buffer was anywhere but fence register 0.

commit 50d3693a6862028e50bc5ba8c788e7ea573c3eb8
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Nov 1 22:22:27 2007 +0800

    Fix allocation reset for really not free BO allocator

commit ecd995d533d28b622afc71a20504d47c33ff5b8d
Author: Alan Coopersmith <alan.coopersmith@sun.com>
Date:   Tue Oct 30 18:20:49 2007 -0700

    Fix builds without DRI

commit 7c88b58a93fce9fda59b6344acb87af16336e287
Author: Alan Coopersmith <alan.coopersmith@sun.com>
Date:   Tue Oct 30 18:20:15 2007 -0700

    Clear compiler error: "void functions cannot return values"

commit a470f6b2ca291e305979dd9223885a50dc0b334b
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Oct 26 22:40:47 2007 +0800

    try to move some fields to xvmc driver structure
    
    Still a lot of things to move include batch buffer, lock, context,
    surface resource handling, etc.

commit 6f53568cd2aeeec6bd8c1f1d9f9c5ecadc5c62f9
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Oct 26 14:58:43 2007 +0800

    Fix DRI context creation for XvMC

commit d2c78f82c20f33fc9c22cab8a7ca161e57a34bf8
Author: Thomas Hellstrom <thomas-at-tungstengraphics-dot-com>
Date:   Wed Oct 24 19:34:12 2007 +0200

    Adapt to DRM Lockfree and setStatus changes.

commit 78aaec0ffc711742bf8ad77757ed8c15cc3f7a9f
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Oct 24 11:50:54 2007 -0700

    Fix typo in my hand-application of rglowery's patch.

commit 021265fbec9fd4ee31bdc9767c0c0453479ea22c
Author: Rob <rglowery@exemail.com.au>
Date:   Wed Oct 24 11:06:53 2007 -0700

    Fix a crash in TV mode handling by initializing the prev field of modes.

commit ce9802edd25255f6c9c11e512b2ef905384b914d
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Oct 24 00:31:53 2007 +0800

    fix xvmc return values
    
    Use values defined by xvmc lib spec

commit 9c84543eb0fde4643eb7529eb6b08eacf57c12d0
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Oct 23 22:16:55 2007 +0800

    add missing license header for new files

commit 87345e820d20f1a98216c52e156c2e18c15ffa44
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Mon Oct 22 14:22:37 2007 -0700

    intel_reg_dumper - dump VGA AR registers too
    
    Add a VGA AR dumping function so we can debug text mode problems too.

commit 90e4eafdf59edd966ed626107c3909b24737da8d
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Oct 22 17:09:15 2007 +0800

    revert xvmc memory allocation hacks

commit 167c56bcf82f0a6d72151b202e6d56f6e0d627f6
Merge: fc9368c... 78e251d...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Oct 23 00:12:22 2007 +0800

    Merge branch 'master' into xvmc

commit fc9368ce7dacd52ef222559d20188ddcf2a85df5
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Oct 23 00:09:06 2007 +0800

    split xvmc user lib chipset drivers

commit 78e251db671e21bc859c9b505d391b70babee2dc
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Oct 19 15:04:10 2007 -0700

    In the clock graph, draw the VCO as erasures in the lines representing clocks.
    
    This shows one of the reasons for the gaps: with the other settings, the VCO
    is too low inside the gap.  However, it also points out another issue: we
    aren't using the high end of the VCO range due to some other limits being hit.

commit 9f9b888525b274036d301d6e06351583d0415f9e
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 18 11:25:24 2007 -0700

    Warn in the log if we choose a PLL clock that's way out of line.

commit 1f8bf110394cc1df66aae9acf5c818145ae19b52
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 18 11:17:38 2007 -0700

    Add some nickle scripts for looking at PLL issues.
    
    While here, move similar nickle scripts under src/scripts/

commit 79636b8c776ae024518103c9fa137c8498c21d48
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Oct 17 17:10:24 2007 -0700

    Bump pciaccess version requirement for  new API usage.

commit c824c45e72908b5b3fa832fec91c7b47f305180c
Author: Dave Airlie <airlied@optimus.(none)>
Date:   Wed Oct 17 16:35:29 2007 +1000

    intel: make block handler hook happen no matter what video is in use
    
    This shouldn't make a difference now, but for upcoming EXA/batch changes it
    will be more useful

commit aa88d23e615e7f154cf850927a0a7bb9fbb0d2f9
Author: Rob <rglowery@exemail.com.au>
Date:   Wed Oct 17 09:19:19 2007 +0800

    AOpen 965GM mini pc has no LVDS

commit 38900f55e2b50ea383f78adb016e3a02c3bd17ad
Author: Kyle McMartin <kyle@freedesktop.org>
Date:   Tue Oct 16 16:38:28 2007 -0400

    toshiba satellite u300 has no tv out

commit 74ac5de14ebb77aeb39d698e9e8d188c9d9abd76
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Oct 16 15:08:26 2007 +0200

    Adapt to libdrm buffer object API changes.

commit d66e924680a3504aa1feb9c228145a95d1a16b1e
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 15 11:31:51 2007 -0700

    In update_front_offset(), set pScrn->fbOffset even at EnterVT during init.
    
    Failure to do so led to the memset() at EnterVT being done to an invalid
    offset.

commit cc892d1ba1d87d08bdd04f857efc6b8f64620018
Merge: b52ce0b... fd97edb...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Oct 15 22:09:14 2007 +0800

    Merge branch 'xvmc' of git+ssh://zhen@people.freedesktop.org/~zhen/xf86-video-intel into xvmc

commit c94cdfd6ddbc580523737f596e97b96a7ce100b9
Author: Jesse Barnes <jbarnes@jbarnes-mobile.amr.corp.intel.com>
Date:   Sat Oct 13 15:57:45 2007 -0700

    Fix palette save/restore
    
    When restoring the palette, we weren't checking to make sure the
    associated pipe was enabled before writing the registers.  In some
    configurations, this led to a driver crash.  Add new routines to handle
    palette save/restore and verify that the pipes are on before we touch
    the registers (could easily be changed to enable/disable the pipes
    around the save/restore as well).

commit e04333a6352040bc883655d606923c912d005981
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Oct 12 12:42:45 2007 -0700

    Fix failure in tiling setup on non-power-of-two allocations on pre-965.

commit a1612b7728d4153499fe86b6713a13c8702cc7d9
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Oct 12 12:42:06 2007 -0700

    Use mprotect on unbound AGP memory to attempt to catch use while unbound.
    
    This doesn't help with the most common use-while-unbound cases, which are
    from the hardware side.

commit 3af442ba52550a9d183e215d49cc12dac0cb9e4b
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 11 11:56:06 2007 -0700

    Don't double-free the memory manager allocation.

commit 6c485ff5bd25e9aa6a3c1eb669843e6b969d94df
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Oct 5 15:52:56 2007 -0700

    Update memory manager sizing for the current set of LIFETIME_FIXED bufffers.

commit d47cf148776d74f9035863b23eefdc2b5893af08
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Oct 5 15:45:51 2007 -0700

    Move tiling fence register setup to bind time instead of allocate time.
    
    This allows us to allocate tiled buffers in buffer objects.  In the process
    I removed the fence division that we had for tiled buffers on pre-965.  If we
    resurrect that code, it should probably be managed by just dividing all the
    objects in roughly half and fencing those halves (to reduce the alignment
    requirement), instead of using giant fences until we run out of space and then
    trying to deal with scarce space on the last (or not) buffer.  Halving
    our tiled objects would use 6/8 of our fence registers on that hardware.

commit a6dc81a0864f9ab2f6fc1aa31002c0191f674ceb
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Oct 5 12:37:19 2007 -0700

    Allow front/back/depth to move over the lifetime of the server.

commit 132dce7565feeea1055899f8c1627766fe84c88c
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Oct 5 12:12:06 2007 -0700

    Delay SAREA and mapping setup until EnterVT when using the memory manager.
    
    Otherwise, we would use uninitialized offsets in the early setup.

commit 4ca3550fb7d488741f8dc1ba3c8722393277c3b8
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 4 17:02:15 2007 -0700

    Rework DRI buffer mappings and sarea setup to allow for moving buffers.
    
    While this has been a desired feature for some time, to allow for reallocation
    of the front buffer, it was made more necessary by the desire to avoid
    requiring a NO_MOVE buffer type in TTM because buffer objects may not be left
    pinned over VT switch.  This is a step towards making those buffers
    movable and resizable.

commit f393a12d21eed668cf4771f022beded9a4c547c7
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 4 13:03:14 2007 -0700

    Move drmMMLock to after we have unbound our (pinned) buffers.
    
    There are still issues due to the fact that we're allocating
    NEED_LIFETIME_FIXED memory as buffer objects, which we refuse to unpin because
    we have no way of pinning it back in the same location.

commit 8fc4e3078210f726c7c375faa2f2fd8d05017c09
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Oct 5 11:51:55 2007 -0700

    Refuse to allocate LIFETIME_FIXED objects in buffer objects.
    
    We can't guarantee the offset will stay the same using the current DRM
    interface, but the correct solution is fixing our code to allow these objects
    to move.  Breaks TTM mode of the DRI driver for now.

commit 0de747f7d219a56434dad49a8a6d1d9d4c251ca7
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 11 10:36:01 2007 -0700

    In i830_allocate_memory_bo, bind if we control the VT, not on lifetime-fixed.

commit 0040bb95445e800af80ca9fa1b92f5db33f1b4ac
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Oct 10 16:48:12 2007 -0700

    Fix potential use-after-free in XV overlay code on video stop.

commit 56ae767180da4a8bd4b7a4c35b92e019ab67d753
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Oct 11 10:09:29 2007 +0800

    Revert "Fix G33 GTT stolen mem range"
    
    This reverts commit 2a8592f2ebcba86b1127aa889155d58a3dc186ca.
    
    This causes compat issue between ddx and kernel apggart version.
    Revert it as it shouldn't hurt normal people's default GTT size,
    but if you change it to 1MB in bios, it's supposed to be broken now.

commit 5faee02e97b7543b41bb1f8e3751558c48802833
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Oct 10 13:55:30 2007 +0800

    EXA: fix tiled dest rendering on i8XX chips

commit 5bbe9f09fda1238da04e6b584813d40fc646f49d
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Wed Oct 3 00:18:25 2007 -0700

    Include xf86mm.h if using XF86DRI_MM
    
    This header file doesn't appear to be getting automatically included for
    some reason.

commit 41dacf97ec1d4ba6f54057f4fcc7bb76033a454e
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Wed Oct 3 00:17:41 2007 -0700

    Quirk for Samsung Q35 which has no TV output.

commit b52ce0bd178c268d20334e2be8fad46037e47499
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Oct 8 22:56:44 2007 +0800

    use field name to initialize i915 xvmc driver

commit e0fb228401b10ea4281eee48497bf1d584999705
Merge: 84d7b2b... 9e770bf...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Oct 8 22:45:11 2007 +0800

    Merge branch 'master' into xvmc
    
    Conflicts:
    
    	src/i830_driver.c

commit fd97edb62463e50a1860290d54684a68d5490bdc
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Oct 8 16:13:26 2007 +0800

    move some definition out of i915 specific header

commit 3a2b5222341b37322b788e329c2b9006dc14ecfd
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Oct 8 15:46:11 2007 +0800

    Temp work around ttm allocation for xvmc, which should be fixed later.

commit 9e770bf69edaa8944048049e11266dbe1ef145e5
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 4 14:31:37 2007 -0700

    Replace setting of LIFETIME_FIXED on cursors with just updating the offsets.

commit c9d6e90c2523096c45d330552f471e6bf1752704
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 4 14:27:07 2007 -0700

    Don't set overlay registers LIFETIME_FIXED. It always uses the current offset.

commit 1cc6bec4628a4ca04a68919a84148a1e6312072f
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 4 14:23:48 2007 -0700

    Revert setting of exa_965_state as LIFETIME_FIXED.
    
    The current offset is used every time in render setup.

commit dfa22df8ce7713b491c4766ce6ce652db91b5f90
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Oct 5 12:53:07 2007 -0700

    Don't leak buffer object allocations in i830_reset_allocations().

commit 7db9d706a1bc9da7afc4823cee92b23e96ae55b8
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Oct 5 12:40:48 2007 -0700

    Warning cleanup.

commit bf33c4e2d91172efd08690fadda7b3743dd3de62
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Oct 5 12:40:37 2007 -0700

    Fix formatting of error message.

commit 04e936935f0b0045600241424f1d04a6721a2432
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 1 17:29:35 2007 -0700

    Bring the CH7017 driver closer to spec.
    
    This is also closer to what my hardware is programmed with, except for some
    very confusing off-by-one bugs in an unexpected direction.

commit 263d48ad93a0fb7100729d0c6e0443797c20c80a
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 1 16:23:30 2007 -0700

    Fix probing of the sample CH7017 device I found by allowing GPIO overrides.
    
    It may be that the LVDS chips need to be DVOA and GPIOB only on mobility
    devices with them, and DVOC/GPIOE on non-mobility like this 845.  But until
    more examples are found, just make this one device probe.

commit 219354af212c7b68c20df689692c55331e36a705
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 1 16:09:13 2007 -0700

    Restore building of pciaccess-based tools even if the server doesn't use it.

commit 1b83e5e589105d05c1b78032fa47eecee478cb99
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 1 14:32:28 2007 -0700

    Remove more DVO probing noise.

commit 29d3188ee9676f697f6fcb859c7f680f5df30318
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 1 13:45:09 2007 -0700

    Suppress I2C failure error messages during DVO device detection.
    
    Otherwise, errors would be printed for every chip probed which wasn't present
    on the system.

commit 6dd8228a386334d05836353672aae9f8c456e435
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 1 12:07:22 2007 -0700

    Enable CH7017/7018 DVO driver by default.
    
    On hardware containing one of these chips (generally single pipe with an LVDS
    connected), it's probably better to try to enable it and fail in some cases
    than to not probe the output at all.

commit 994ee6721d9f1650ad37e21198b86848352b73af
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 1 12:01:16 2007 -0700

    Disable TV/VGA output on the CH7017/7018 devices.
    
    We don't support those outputs on this chip yet, so turn them off if the BIOS
    had set them on.

commit 0e5574e842eeaac75271ccd50027d3e54c57722d
Author: Regis Prevot <regis@myrix.net>
Date:   Sat Sep 29 16:21:08 2007 +0200

    Ignore detection of TV output on Panasonic CF-Y7

commit 84d7b2b955107264b67526a04028a8b79d8804e3
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Sat Sep 29 19:41:15 2007 +0800

    rename xvmc init function names

commit 1845e7c6e9caf7a9ad7f46a8fbfa321ddec69a1e
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Sep 28 10:12:11 2007 -0700

    Go back to using old drm_i915_flip_t field name
    
    This field shouldn't have been renamed in the first place.  Go back to using
    the old name so that the tree is backward and forward compatible again.

commit f3d92ab474de11babe507b0e3c15aca146b6cb66
Author: Kyle McMartin <kyle@freedesktop.org>
Date:   Fri Sep 28 10:17:55 2007 -0400

    Dell XPS 1330 has no TV out

commit bbf69c7446aa9748dacecccfe0b63d803f865b00
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Thu Sep 27 17:37:19 2007 +0800

    Pin cursor, overlay(no physical) and exa state buffers
    
    And cursor mem counting for dri mem manager is not relate
    to overlay.

commit 64188246bb25e95a916ebb8a50a09298e56d91d9
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Sep 26 15:48:19 2007 +0800

    clean up old i915 xvmc function declare

commit 320b7f08f457455f1d16b4c36d149bdc3f6ceead
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Sep 26 15:02:33 2007 +0800

    Revert to origin xvmc setup steps
    
    We have to grab xvadaptor's PutImage earlier than
    xv init, otherwise no chance to do that..

commit 1e0ff38f44e3b5a8b4a5d509c7faa266270d522c
Author: Hong Liu <hong.liu@intel.com>
Date:   Thu Sep 20 11:28:52 2007 +0800

    Fix pixmap offset
    
    Use consistent interface for counting pixmap offset.

commit 85e4bd109464a4d90856e17bc960872eeaebc2ad
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Sep 26 14:32:46 2007 +0800

    Log xvmc driver name

commit e58b76a24a29e0a502650807de81e650e5dc184d
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Sep 26 14:40:04 2007 +0800

    clean up err report
    
    Still need to clean up return value for XvMC API

commit b10a9668dc50d10489b2ae531d89c8ab7c408170
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Sep 26 14:01:57 2007 +0800

    fix i915 xvmc devPrivate reference

commit f12eaaf385e7a0b85524588a5d865d1cc3f1a0cf
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Sep 26 13:49:55 2007 +0800

    comment out i965_xvmc_driver for now

commit 513e8a2f8abde1b11b8058e94a650796fd51779b
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Sep 26 13:45:42 2007 +0800

    Create xvmc driver interface
    
    convert i915 to new xvmc driver interface

commit ca67fa767dc762dac369e84b27a7ef15673d527c
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Sep 24 11:12:22 2007 -0700

    Remove logic for supporting i915tex_dri.so vs. i915_dri.so.
    
    There can be only one.

commit 130f79613bfe6a8cfa7f431c8cce06cbb93cc91a
Merge: b73235f... 1260316...
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Sep 21 17:14:44 2007 -0700

    Merge branch 'buffer-objects'
    
    This branch changes i830_memory.c's allocator to use TTM when available to
    allocate memory, which also allows TTM to control almost the entire aperture.
    As a result, our front/back/depth buffers are created as real buffer objects,
    which may be used by the DRI driver instead of the fake buffer type in TTM.
    The updated DRM with bo_set_pin ioctl is required, to allow us to pin and
    unpin our buffers as needed.

commit 126031655c3c1db9881ad17d712461533eb59632
Merge: c343835... bda3c69...
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Sep 20 08:57:58 2007 -0700

    Merge remote branch 'origin/master' into buffer-objects
    
    Conflicts:
    
    	src/i830.h
    	src/i830_driver.c

commit b73235f40497cfb10792ba191d4f6eac3a5df009
Author: Hong Liu <hong.liu@intel.com>
Date:   Thu Sep 20 11:28:52 2007 +0800

    Fix pixmap offset
    
    Use consistent interface for counting pixmap offset.

commit 798448e4641acf241b7cbae0d6c243ae383da9f4
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Sep 19 13:29:31 2007 +0800

    Add media state definition on i965
    
    This adds VFE state and interface descriptor struct define.

commit 36b81ba20d20e7b235cb701c5135cbf3f3eedb12
Merge: 02ad9ce... bda3c69...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Sep 19 11:44:41 2007 +0800

    Merge branch 'master' into xvmc-i915
    
    Conflicts:
    
    	src/i830.h
    	src/i830_memory.c

commit bda3c69a7a044869ea63514b97f8aa9260d6b5a7
Author: Dmitry Babrovich <dmitry.babrovich@densitrongaming.com>
Date:   Tue Sep 18 09:34:34 2007 -0700

    Bug #12457: Let the ch7xxx driver probe the 7301
    
    Looking at the 7304, this chipset likely requires slightly different
    programming.  However, this change allows for at least some functionality.

commit 445a59d262b93bd9d2c16cee9934ce77a103776b
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Wed Sep 12 09:32:41 2007 -0700

    Remove unused plane->pipe mappings from SAREA private
    
    Turns out we can get away without this, so remove it, fix a crash, and only
    swap planes/pipes if the DRM can support it.

commit d02336290bea30de3c390b8121046c38fd6b0f62
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Tue Sep 11 04:28:14 2007 -0700

    Fix plane/pipe mapping compat code
    
    Move plane->pipe mapping adjustment to ScreenInit so we can check
    against the DRM driver version accurately.

commit d9f2b3c0d2d08a4b7fad865dab7deb6224b57999
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Mon Sep 10 23:49:34 2007 -0700

    Fix crash in ScreenInit
    
    Use pScreen directly when getting at the SAREA private, since
    pScrn->pScreen may not be initialized yet.

commit 4c7542ef43a5267e470ca1608a2ae57abf9783ec
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Mon Sep 10 23:30:50 2007 -0700

    Only swap planes and pipes if DRM supports it
    
    We want to associate plane A with pipe B on pre-965 mobile chips, since that's
    the only way to get framebuffer compression on the builtin LVDS on those
    platforms.  However, if we do this swapping and DRM isn't aware of it, we may
    end up requesting vblank events for the wrong pipe, or setting up SAREA buffer
    swap state incorrectly.
    
    This mod checks whether DRM supports the new plane->pipe swapping behavior, and
    only enables the swapping if so.  This should fix the bugs Lukas found and
    debugged.  Reviewed by Michel Danzer.

commit 286f5df0b62f571cbb4dbf120679d3af029b8775
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Thu Sep 6 14:31:55 2007 -0700

    Switch to pci_device_map_range/pci_device_unmap_range APIs.
    
    With the libpciaccess change that added these new APIs, use them
    for all mapping.

commit 2a8592f2ebcba86b1127aa889155d58a3dc186ca
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Sep 5 14:52:56 2007 +0800

    Fix G33 GTT stolen mem range
    
    G33 GTT table lives in seperate stolen mem with
    graphics data stolen mem.

commit 7fd9a98178cdebda4213796fdc452a8a265a1197
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Tue Aug 28 16:00:01 2007 -0700

    Don't set supported TV formats until after RandR initialized.
    
    The TV format property cannot be configured until RandR has been
    initialized.

commit c6e637cd683dc60567b3b4f69b7f2b4c338c89ea
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Tue Aug 28 12:17:15 2007 -0700

    Limit TV formats to those supported by current connection

commit ddd6053987b9ca9bd3722ddbdfd412a3d8d252cf
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Tue Aug 28 12:30:46 2007 -0700

    Add register defines for hw binning

commit 3fbbd0afde49c53a5a8661f75c8c8c4be3020c30
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Aug 28 17:48:20 2007 +0200

    Fix build against pre-pci-rework xserver.

commit 0fdbf64b34e4114c2b89d696b268b9c7464f1efd
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Aug 28 21:56:21 2007 +0800

    Fix i915 a8 color buffer blending
    
    From spec, i915 engine uses green channel when reading from 8bit
    color buffer for blending, and also writes back green channel.
    Fix blend factor in dest alpha case by using dest color instead.
    Now rendercheck can pass a8 tests.

commit 3411eb0dbae470b910af3116a4ab960c821b9b20
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Sun Aug 26 23:09:01 2007 -0700

    i830_driver.c changes for libpciaccess.
    
    Change to use libpciaccess APIs, including computing and using BAR indices
    for various mapping activities.

commit 387fed6daa7426e4a85d30ba7cf608b5f41d24bb
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Sun Aug 26 23:06:57 2007 -0700

    i810_driver.c changes for libpciaccess.
    
    This includes new probe code (intel_pci_probe) and changes for i810 to
    use BAR indices to refer to suitable portions of the device mappings.

commit 2c794192052ca55c3263e27e13d16aafe8caa92c
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Sun Aug 26 22:46:19 2007 -0700

    Mechanical API conversions for libpciaccess.
    
    Uncomplicated API transistions for libpciaccess usage:
    
    	Legacy xf86 API		libpciaccess API
    	---------------		----------------
    	xf86ReadPciBIOS 	pci_device_read_rom
    	pciReadWord 		pci_device_cfg_read_u16
    	pciWriteByte 		pci_device_cfg_write_u8
    
    And, more use of the API-independent DEVICE_ID/SUBVENDOR_ID/SUBSYS_ID macros
    to pull PCI identification data from the underlying structure.

commit 70e8e5957200401474967a467663ae049e9080f2
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Sun Aug 26 22:40:25 2007 -0700

    Change DRI interface to fill in PCI data from new libpciaccess structure.
    
    The DRI interface requires bus identification for each DRI object; pull that
    data from the libpciaccess structures as necessary.

commit 5516cc781bd488c936af225123812a61ed5874b8
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Sun Aug 26 22:37:38 2007 -0700

    Add libpciaccess declarations to I810Rec and I830Rec.
    
    Using libpciaccess requires a different type for PciInfo (struct pci_device
    instead of pciVideoPtr) and it requires knowing which BAR each memory region
    needs to be mapped from. Add these definitions to the driver private record
    along with the includes necessary to use libpciaccess.

commit daada59b5f8c2294b524a4b5920dc6b1c213642f
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Sun Aug 26 22:32:39 2007 -0700

    Change IS_Ixxx tests to work with or without libpciaccess.
    
    libpciaccess has a new structure that holds the PCI identifier data; borrow
    macros from the mga driver to work with either the old xf86-specific
    structure or the new libpciaccess structure.

commit 3d3bf493a3973f4067433d27a4d7ddfecaa18f1c
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Sun Aug 26 22:27:34 2007 -0700

    Intel driver configuration (only) changes for X server libpciaccess usage.
    
    Detect whether the target X server uses libpciaccess, using it in the driver
    compilation as necessary. This change means that utilities that used to use
    libpciaccess will not do so unless the driver itself uses libpciaccess. Yes,
    that could be fixed, but it doesn't seem that important.
    
    This patch does not include any code changes necessary to actually have the
    driver build against an X server using libpciaccess.

commit 5faf9cc6afe1c30fa88bc6446088a6fa47fc5d0b
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Sun Aug 26 09:34:06 2007 -0700

    Sort quirk table, add Dell Latitude X1

commit a9e1d42a47cef79d8bbde2afd89d26aed964e344
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Sat Aug 25 12:54:11 2007 -0700

    Lenovo 201a is x60s, not x61s

commit ffc2907f7f2eb039004eff0014c5563a01463fb0
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Sat Aug 25 12:31:21 2007 -0700

    Thinkpad X61s has no TV out

commit 0c20fbabd18c19b2753cb60280f89e240ce5645f
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Fri Aug 17 22:21:47 2007 -0700

    Make sure XV_PIPE is used whenever possible.
    
    The code was not consistently using XV_PIPE when the desired crtc contained
    any portion of the video output.

commit e443f83dd6f110156743c93f7d793cdddb8195a1
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Aug 17 18:13:49 2007 -0700

    Tune acceleration architecture allocator sizes down.

commit bd874b11bbfe582aebd3115771f90807e75afc31
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Aug 17 17:49:21 2007 -0700

    Replace AA allocator usage with i830_memory.c for RandR rotation.
    
    This requires EXA 2.2 (server 1.3) for rotated performance with EXA, because
    the i830_memory.c allocation may not fall within what EXA considers the
    offscreen area, so the PixmapIsOffscreen hook is needed.

commit 9ad33dd65a79277ef75a6e95373614852725f5a9
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Aug 17 16:46:48 2007 -0700

    Use i830_memory.c instead of the AA's allocator for XV buffers.
    
    This should fix issues with XV being allocated into XAA's tiled pixmap
    cache and resulting bad rendering.  Its also brings us closer to being able
    to shrink the size of the pixmap cache on XAA, which is of limited utility.

commit 3655a1ecb62f6c387a16fa87cf6f00bf7835dce4
Merge: e5c336e... 2231cdc...
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Thu Aug 16 12:04:20 2007 -0700

    Merge branch 'master' of ssh://git.freedesktop.org/git/xorg/driver/xf86-video-intel

commit e5c336eaa32be8f9379a2c1dd51006b85bc8b270
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Thu Aug 16 12:04:02 2007 -0700

    Disambiguate plane and pipe mapping, use plane A on pipe B on pre-965 LVDS
    
    Add a new 'plane' field to the intel_crtc private structure for tracking
    planes separate from pipes.  This allows pre-965 chips to use plane A
    on pipe B, enabling framebuffer compression for builtin LVDS displays.

commit c3438356d6b7b63ad9d0086efb084be8e048980e
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Aug 16 11:34:02 2007 -0700

    Add tiling information to BO layout description.

commit 0c9e4aeea84e20a18e3b76d8cf8e802af004df57
Merge: 79d9a30... 2231cdc...
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Aug 16 11:30:16 2007 -0700

    Merge branch 'master' into buffer-objects
    
    Conflicts:
    
    	src/i830_dri.c
    	src/i830_memory.c

commit 2231cdcd8f1ee81b3e59cc5e3a325c22ee0f40e4
Author: Dave Airlie <airlied@redhat.com>
Date:   Thu Aug 16 17:15:54 2007 +1000

    i915: add support for render to a8

commit a69db6f7fe1703b473e5c1d1e0088ccc203f4d5a
Author: Dave Airlie <airlied@redhat.com>
Date:   Wed Aug 15 18:28:50 2007 +1000

    intel: don't setup texOffsetStart unless using EXA

commit 5126a71f82767b9e23cd590453718f3364789740
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Aug 14 13:54:55 2007 +0800

    Fix seg fault introduced in tiling patch when TV detect
    
    When TV does load detect, fb hasn't been setup, so we should check
    that in i830_display_tiled(). Caught by Nanhai.

commit d9f89a1af7e7ff4056727060cdf2e35c15a4dcdd
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Fri Aug 10 17:59:33 2007 -0700

    Save/restore tile-mode offset registers DSPATILEOFF and DSPBTILEOFF
    
    Now that the driver sets these registers, they must be saved and restored.

commit 5bc194d3d3c87bb0128d9ac10f090f031345eb37
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Fri Aug 10 17:54:32 2007 -0700

    Set DSPATILEOFF/DSPBTILEOFF to handle 965 tiled frame buffers.
    
    DSPATILEOFF and DSPBTILEOFF replace DSPASURF and DSPBSURF when the frame
    buffer is in tiled mode.

commit 64b943c79cf957a4c54482720195d7f27b7f0c0d
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Aug 10 15:48:05 2007 -0700

    Add #if 0-ed fence debugging code.  It's noisy, and of little use to most.

commit ba9a503ba2099025e393f3382bb453985ef23497
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Aug 10 15:06:58 2007 -0700

    Don't force tiling on if it is disabled in configuration but fbc is possible.

commit b7751c7d1d6bcf310824295c3bab4ff36760c791
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Aug 10 17:42:09 2007 -0700

    Fix stack-smashing in the last commit.

commit cb36635a053d4ac3971fea05060d31dbd3d382d2
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Aug 10 14:16:59 2007 -0700

    Attempt to fix several front buffer tiling failure cases.
    
    Front buffer tiling is now disabled with G965 and XAA.  Some of the acceleration
    that i830_xaa.c does can't be supported on tiled buffers.
    
    Adds a tiling field to struct i830_memory, and uses it instead of separate
    variables for each potential tiled buffer.

commit ed1b106fabf3a18489bdb3083326f27387a9cb72
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Fri Aug 10 14:31:16 2007 -0700

    Clean up tv mode name allocation and copy.
    
    TV mode names used to contain the signalling standard along with the pixel
    size. The signalling has been moved to the TV_FORMAT property, but the
    allocation and initialization of the mode name was left a bit messy as a
    result.

commit f71b9358b4157a8cfdc694ddef8ca3f98926ca91
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Aug 10 15:53:04 2007 -0400

    Cleanup tiling and FBC driver output.
    
    Remove an extra "FBC enabled" message from i830_memory.c (only report errors
    if they occur), and don't print the "forcing FBC on" message if tiling was
    already enabled, as it's redundant and confusing.

commit e6746d0f286ef9d9a87f748d40e5421c268f2f7d
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Aug 10 15:48:15 2007 -0400

    Enable tiling by default on 965.

commit e0fcf645a228094620b8f7fdd580963611bdd6ef
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Aug 10 15:43:06 2007 -0400

    Tiling fixes for 965
    
    This should be close to the last set of tiling fixes for 965 chipsets.
    Prior to this commit, the 965 composite hook didn't take tiling into
    account, nor did 965 textured video, which caused display corruption.
    However, there seems to be at least one last bug to squash--on occasion,
    a configuration with tiling enabled won't properly display text.  This
    is likely another tiling related problem with the composite hook.

commit 02ad9cee330fb5fb0008ad6f74e74e8d8a1fc36e
Merge: 105f8a1... 7b143e5...
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Aug 10 16:45:56 2007 +0800

    Merge branch 'master' into xvmc-i915

commit 105f8a183eb64623d9a9e2833dbe27156a551f69
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Aug 10 16:44:46 2007 +0800

    disable subpicture initial
    
    until we really implement it, OSD can't work for now.

commit 7b143e5c8397da077c0e02455c21c5a99cf50942
Author: Dave Airlie <airlied@redhat.com>
Date:   Thu Aug 9 12:14:44 2007 +1000

    i965: increase composite vertex buffer size and alignment to be safe

commit 14691b24da5aa29d8c41ac7b7c61828e3cd9eab7
Author: Dave Airlie <airlied@linux.ie>
Date:   Thu Aug 9 09:41:32 2007 +1000

    i965: fix memcpy of the sf_kernel when a mask is needed

commit 5e18c6af9051da654d2a6a97553ef4fe777bb61e
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Aug 8 11:13:37 2007 -0700

    Allow 965 composite acceleration to A8 destinations.
    
    Note that this is a slowdown in text rendering due to the high overhead of our
    compositing setup, but appears to be correct according to rendercheck.

commit b0ec670cdb0b6ca6fc0f4f165fa3ee5a20d7c985
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Aug 8 11:03:51 2007 -0700

    Bug #11593: Remove dead struct vch_bdb_20 which was angering the sun compiler.

commit 87cc72ef509b85635bf0e84c47dfed6b7242170b
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Aug 8 09:39:55 2007 +0800

    check early if we have slot left for new context or surface

commit fec6744b763f2b85b4e592c51326b9ee979bef5d
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Aug 8 09:26:10 2007 +0800

    I missed to remove port attributes wrapper

commit 76c084d41999f13497b80d4ac6799cb974adaa03
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Aug 8 09:22:42 2007 +0800

    explicit say "unsigned int"

commit cfc614b1f9143ed1407733aaa81c4a980c613a63
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Wed Aug 8 09:06:47 2007 +0800

    remove xvmc attributes
    
    We don't have extra attributes than Xv port.

commit 92af2f4bbcb395cbde097776718449d99843ad67
Merge: da82a47... e0be352...
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Aug 7 15:18:17 2007 -0700

    Merge branch 'origin'
    
    Conflicts:
    
    	src/i830_exa.c

commit da82a47a558597f3653e2b33bc6adbab18574b57
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Aug 6 17:01:37 2007 -0700

    Fix EXA rendering with tiled front buffer on pre-965.
    
    The 915 and earlier appear to respect the fence registers, while only the 965
    requires the per-operation tiling setting and pitch shifting.  This will also
    fix issues with rendering on the 965 involving multiple cliprects, where the
    pitch would get divided repeatedly.
    
    This removes the offset < 4096 fallback, which essentially resulted in no
    acceleration to tiled buffers, hiding the issues.

commit e0be352f5017f0e645a4ff8a40961d9c2b98863a
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Tue Aug 7 12:37:25 2007 -0700

    Fixup pitch in Prepare* functions, since actual hooks may
    be called many times for the same pixmap, and we don't want
    to keep dividing the pitch by 4.

commit b29a932bec2a3cc5a38e9c09c012cfdc1b6209c1
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Tue Aug 7 16:47:13 2007 +0800

    code cleanups
    
    and put wrap function in driver xvmc priv instead of per xv port priv

commit 7431abee5fb971d1f8bc7ac4bea137f6ece9418b
Author: Brice Goglin <bgoglin@debian.org>
Date:   Tue Aug 7 09:13:00 2007 +0200

    Define INTEL_VERSION_MAJOR/MINOR/PATCH using PACKAGE_VERSION_*

commit 9e1914270a0978ec4dfae757d3dd57ca7ffe17e5
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Mon Aug 6 17:55:00 2007 -0700

    Remove 4k offset checks from Copy & Solid hooks.
    Reading the docs too literally can cause you to hide bugs with false fixes...

commit 3510d5728fa972b36d022b4f9189d46ff98d7b16
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Aug 6 16:44:39 2007 -0700

    Fix accumulated whitespace nits in i830_exa.c

commit 5ff05dffe229e35da7619762628fdd0f125585e8
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Mon Aug 6 16:01:10 2007 -0700

    More tiled rendering fixes: - check for tiling, not just offset in PrepareSolid - combine pI830->tiling and frontbuffer checks into new exaPixmapTiled function for readability

commit ba90d944329dd8c79a757c38128964fbbe4ab898
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Aug 3 16:46:09 2007 -0700

    Add the file mode for bios_dumper output so it doesn't have 000 permissions.

commit 322a163cfbda885adc6bb09c1f976d36617ea83b
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Aug 3 10:46:39 2007 -0700

    Quirk away the nonexistent TV connector on the Panasonic CF-Y4.

commit ffbab2ee5dc227b2a8a5ffd1717ae00e8e37f956
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Aug 3 21:27:52 2007 -0700

    Limit Solid & Copy offsets to 4k when rendering to tiled targets

commit 019dbfda294aaafb28d8bea0fe2f5dadc2ea3e0b
Merge: 3d3c0e8... 15f71ed...
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Aug 3 20:45:14 2007 -0700

    Merge branch 'master' of ssh://git.freedesktop.org/git/xorg/driver/xf86-video-intel

commit 3d3c0e8c55f639a501c0756948b518abd903d7d0
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Aug 3 20:40:45 2007 -0700

    Tiled rendering & fbc fixes:
      - actually enable tiling in DSP(A|B)CNTR if needed
      - add logic to EXA routines for tiled case (still needs work)
      - enable/disable fbc on DPMS events (meant moving functions higher in file)
      - fix fence register pitch programming (use correct pitch instead of kludged value)

commit 79d9a309b19e22561e000a47b732c67479c2e6d4
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Aug 2 15:50:42 2007 -0700

    Mark DRI buffers as shareable, and pass their buffer handles through the SAREA.

commit 0da4f2b0cd7203377ad10407928a367b8c6d310e
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Tue Jul 31 16:22:36 2007 -0700

    Legacy backlight changes:
      - add support for 965GM
      - make sure legacy enabled systems don't reduce the range of backlight values we can present to the user

commit 15f71edba37738f8ba279fa07452fda10cc65298
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Sat Jul 28 17:43:29 2007 +0800

    Update Lenovo TV quirk info

commit 857b4a7bcb69ca43b866b4283fe075abbafb1d22
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Jul 27 18:03:12 2007 -0700

    Pin some buffer objects at creation time, which can't be moved yet.
    
    A number of other interfaces of ours don't allow buffer offsets to be updated
    after screeninit.  This attempts to catalog why for each one, so that they
    can be fixed one by one.
    
    This happens to restore the EXA offscreen allocator for now, as a fixed-offset
    object.

commit d7b5b595ad29ae0ac3adbd3a176be3fe7ffa6474
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Jul 27 12:48:08 2007 -0700

    Delay the first screen pixmap update to CreateScreenResources.
    
    The return value of GetScreenPixmap before CreateScreenResources is not, in
    fact, a pixmap.

commit 2b1ec0f51479c1d7e5e62803c68feca29375519d
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Jul 27 10:00:35 2007 -0700

    Use the dontMapFramebuffer option available with DRIINFO 5.4.
    
    If not available, AIGLX init will fail.  While here, simplify DRIINFO tests
    since we refuse to init with a version queried less than the version we
    compiled against, anyway.

commit f403a50afbcef1e54f554481c72037338bd5357c
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Jul 27 09:24:24 2007 +0800

    Add another Lenovo TV output quirk
    
    From issue report http://lists.freedesktop.org/archives/xorg/2007-July/026644.html

commit 34c82ad7ce83394db47588693b578cf91991bf1c
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Jul 27 09:14:13 2007 +0800

    Add quirk support
    
    This one trys to use a flag for possible quirks. It adds a quirk
    for my Lenovo T61 TV output, and ports some origin LVDS quirks to it.

commit 1a585d03972394cb97dec2462937b0104bdf4de2
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jul 26 10:46:35 2007 -0700

    Use new drmBOSetPin interface instead of NO_EVICT/NO_MOVE buffers.
    
    To do this, we have to deal with buffer offsets being set at EnterVT time
    instead of screen init time. We've wanted to move this direction for a long
    time, but there are repercussions.  The EXA offscreen memory manager has to
    be disabled, because it can't be moved.  That will be replaced by BO-backed
    pixmaps soon.  Also unresolved is whether our moving
    front/back/depth/texture buffers will break the classic-mode DRI driver.
    
    This code doesn't actually work yet.

commit 0fd3ba0518b3cde9ca0e4e2fc1854c00d8a43d5c
Author: Brice Goglin <Brice.Goglin@ens-lyon.org>
Date:   Wed Jul 25 20:11:32 2007 +0200

    Fix typo in intel.man
    
    Reported by A. Costa" <agcosta@gis.net> in
    http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=432061

commit 18c707a8c13ac5fffdd30d55e6f5926a68b367df
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jul 25 10:11:16 2007 -0700

    When TTM is available, use it instead of manual AGP allocations when possible.
    
    This is a step towards being able to expose buffer objects through the screen
    private to DRI clients, instead of having them have to use the fake buffer
    object type.
    
    This fails in two ways.  First, the kernel memory manager is not currently
    suitable for doing the physical allocations we need, so we still use AGP for
    those.  Additionally, the DRI lock can't be initialized early enough for us, so
    these buffer object allocations fail.  This will be fixed by improving the
    DRM interface.

commit c4deefa80a6349db968e25bd6778cdf7a514ca7f
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Mon Jul 23 10:35:32 2007 +0800

    only enable xvmc for 915/945/G33

commit 45962eed51120ff77326c29d72cf8b6cd8a934b5
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Mon Jul 23 09:50:17 2007 +0800

    Fix a typo in i915 render
    
    Fence setting is in mapstate actually. This fixes rotation in
    tiled fb case, thanks Keith to report this.

commit a52c53b8603495ab05e07e3da5092fe122fcb6f2
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Fri Jul 20 17:10:27 2007 +0800

    don't initialize XvMC if xv is disabled.

commit b1af2c0e01c54ef1d40fd0ca1ede29a1dd7ed97b
Author: Zhenyu Wang <zhenyu.z.wang@intel.com>
Date:   Fri Jul 20 15:18:48 2007 +0800

    Fix device id info for 945GME, 965GME
    
    which do have new host bridge ids

commit 6b4d43dbf4bbb86d479d8fca480c8bec39e2714b
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Fri Jul 20 09:59:40 2007 +0800

    lock display when creating context

commit 42e91c7092f9cf7f5c0b98e9ae3d92a5b30821bf
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Thu Jul 19 17:30:54 2007 +0800

    move i830_allocate_xvmc_buffer out of  #if/#endif

commit 36ea26f2779d951fa173da785aca100564e5ecf8
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Thu Jul 19 17:21:05 2007 +0800

    add copyright

commit 9d03873423c0968b2d6700b7d8d44c7e23b8d7f3
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Thu Jul 19 10:03:19 2007 +0800

    block some signals within critical section to avoid
    
    dead lock.

commit 25658f838bd1bcd7559d7a032d127c626833fb7c
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Mon Jul 16 13:03:58 2007 +0800

    1. The pitches for y/u/v surfaces are 1024bytes aligned.
    
    2. clean code

commit 8f316a4584d0676e5dae051698bde0831f018cc4
Author: root <root@xhh-bl32.(none)>
Date:   Thu Jul 12 16:24:03 2007 +0800

    1. clean code
    
    2. fix an error in map_state

commit 4844254431695158287167e3b0fad25d9efb7a6c
Author: root <root@xhh-bl32.(none)>
Date:   Tue Jun 26 16:32:30 2007 +0800

    a fix for 945G/945GM

commit 8c249765ce788f8adb0325a8e3016a0eae74b13b
Author: root <root@xhh-bl32.(none)>
Date:   Mon Jun 25 14:07:01 2007 +0800

    1. using batch buffer
    
    2. implement macroblock_ipicture instruction
    3. 16bit INTRA block

commit 2b20b395541f786e4009211e4c56042257b8d114
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Mon Jun 25 10:43:49 2007 +0800

    fix a bug related to display surface

commit 6e47601ac7427390fa4cb6e228dfb566ff95db09
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Mon Jun 25 10:40:08 2007 +0800

    fix some bugs

commit d038ffdfffb846e22f360faac5d469c8e59795ad
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Mon Jun 25 10:37:12 2007 +0800

    Release resource allocated for surface/subpicture

commit a9bf7e28b91692c7c7a4915cdf9603cd2ef025ea
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Mon Jun 25 10:33:35 2007 +0800

    fix some bugs

commit ccac60bf035bb54661c13f306031def81e105a32
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Mon Jun 25 10:23:28 2007 +0800

    fix some bugs

commit 934da9f2b83716bb37d0719a61b8e6b179fff2cd
Author: Xiang, Haihao <haihao.xiang@intel.com>
Date:   Mon Jun 25 10:17:08 2007 +0800

    enable XvMC for i915

commit c7920a0e819308762fca3d6fc7ab194bd565b06a
Author: Dave Airlie <airlied@linux.ie>
Date:   Thu Jul 19 15:09:54 2007 +1000

    strip out remainder of drmmm code in driver

commit 37652b68880f1881b90bd22218cfe86eca7e5974
Author: Dave Airlie <airlied@linux.ie>
Date:   Tue Jul 17 14:03:21 2007 +1000

    intel: oops I commited pixman local workaround - undo it

commit e40f6a4923d1323702406266e90eae3218a8a44e
Author: Dave Airlie <airlied@linux.ie>
Date:   Tue Jul 17 09:20:07 2007 +1000

    intel: actually 2.3.1 should be good enough

commit 1e169be25b2e4ab34afd4b8ae8ae0041f6069125
Author: Dave Airlie <airlied@linux.ie>
Date:   Tue Jul 17 09:17:31 2007 +1000

    intel: don't try and use TTM memory manager with old libdrm interface
    
    I probably need to release a libdrm with this interface in it now..

commit ff2be3995d33f9e4b7f63b380f166b6168c9b9c6
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Jul 13 12:47:18 2007 -0700

    Remove hard-coded CRT blanking frobbing for load detection.
    
    CRT blanking needn't be adjusted to perform load detection on 9xx chips, and
    the 8xx load detection path now adjusts blanking just during load detection.
    Adjusting the blanking interval turned out to cause many monitors to fail to
    sync.

commit 00f4587025a3879626623135b0a153fcdb906719
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Jul 13 10:58:06 2007 -0700

    Ensure pipe/output active before doing load detection.
    
    If the pipe or output have been set to DPMSOff, then load detection will not
    work correctly. Also, share the load detection configuration code between
    crt and tv outputs.

commit 6f18300aed1340348c6d395f326061b5315be643
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Jul 9 21:29:55 2007 -0700

    Eliminate bogus (and harmful) blanking adjustment for load detect.
    
    Instead of always adding blanking to mode lines, use the FORCE_BORDER option
    on i9xx hardware where it works, and dynamically add a bit of border if
    necessary on i8xx hardware to make load detection work. This may cause
    flashing when a usable crtc is not otherwise idle when load detection is
    requested.

commit 04130ac6b705aa49161fb6dae83ad0bdd76e89d9
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Jul 11 11:42:56 2007 +0800

    Fix i915 rendering for tiled buffer
    
    Make it to check fence register for dest buffer.

commit 88f8b688e2316ae4a1f7485f0010ce90de54783a
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jul 9 12:56:13 2007 -0700

    Fix some physical address handling for >4GB addresses.
    
    The upper bits would have been inappropriately dropped on G33-class hardware,
    and on G965-class hardware in a 32-bit environment.  The only use of physical
    addresses on these should be for FBC, though, and FBC requires addresses
    below 4GB.  This is unresolved.

commit bf831117b4659cc4f2774098dee938505f780a9b
Author: Jesse Barnes <jbarnes@hobbes.virtuousgeek.org>
Date:   Sat Jul 7 10:15:32 2007 -0700

    FBC fixes:
      - allow FBC and Tiling to be forced off if configured to do so
      - only touch FBC registers if pI830->fb_compression is true

commit b426866fe1be2ad3861559beff69186379a6afad
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Jul 6 20:48:40 2007 -0700

    Fix manpage to reflect default behavior.

commit 377c58373daa6bef5d37ead2b6f9a769a905b6fa
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Jul 6 20:39:19 2007 -0700

    Fix naming of FBC plane enable bits (mistakenly called them pipes earlier).

commit 9c0388dc8d4c6495fae21af6da644b34e20173d1
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Jul 6 20:38:41 2007 -0700

    Update man page with current behavior.

commit cecbc71fdc9af832cef23427696f6f654f7d6104
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Jul 6 16:36:34 2007 -0700

    Fix debug output in fbc enable/disable routines.  Add logic to make sure fbc
    isn't enabled twice on two different pipes.

commit 4359df9419d2d02a2f9d9adc7f5a49ecf07ddd30
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Jul 6 16:17:45 2007 -0700

    Fix tiling and fb compression defaults for 965 (not yet fully supported).

commit ca593a5219549df94a6d234ebbcf9e7c44723c9b
Author: Jesse Barnes <jesse.barnes@intel.com>
Date:   Fri Jul 6 16:10:52 2007 -0700

    FBC and tiling changes
      - change framebuffer option name to "FramebufferCompression"
      - add new "Tiling" option (controls all tiling, not just front buffer)
      - add debug message to fb compression enable/disable routines
      - update man page with new options

commit 8798ef11321ee6957919279076758d47ad956cf3
Merge: 8919b22... 3c552af...
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Thu Jul 5 12:21:31 2007 -0700

    Merge branch 'master' into fbc

commit 8919b2292147add41a1c1c6e5e673257cb6c6c6e
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Thu Jul 5 12:21:06 2007 -0700

    Re-add tiling kludge, but only for 965.

commit 407b124af8f7bb42abe4eecc87476c4c3e555cd0
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Thu Jul 5 11:31:34 2007 -0700

    Remove tiling kludge.  May need more fixes for 965.

commit 7a87b9d2a2eb4d281dce67586756ff5653b2805a
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Thu Jul 5 11:23:06 2007 -0700

    Revert discard alpha change, requires other fixes to work.

commit fecf964534f5ba6d40480cb13adc89094946a51e
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Thu Jul 5 10:59:23 2007 -0700

    FBC fixes:
      - properly check several FBC enablement constraints
      - don't use alpha discard if FBC is in use

commit 60ee7b6a91b2b8c447130c60cd8b19eb68119777
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Tue Jul 3 14:20:34 2007 -0700

    Fixup line length buffer padding, add kludge for front buffer tile
    pitch.

commit 3c552af65d28fafec1d09484a8914b690b961349
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jul 2 18:33:47 2007 -0700

    Update documentation and bump driver version to 2.1.0.

commit f02036aedcd7866c567a6adc070eda3dad872105
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Mon Jul 2 15:42:02 2007 -0700

    Framebuffer compression changes:
      - move FBC register definitions to i830_reg.h
      - add fix from Arjan for 965 depth buffer tiling
      - add VT switch and clear-at-server-start code for FBC registers

commit 2b9961eb9ce8734565ecdb01cb11610714d7f610
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jul 2 15:16:33 2007 -0700

    Fix reversed LVDS dither enabling logic on GM965.

commit 3d9ee8b2991ec0da8cc21b8455ff7f00fd0335b5
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jul 2 14:38:28 2007 -0700

    Bug #11365: Disable the panel fitter unless it's needed for the chosen mode.
    
    The automatic panel scaling appears to choose bad sampling on some GM965
    hardware for 1:1 mapping modes, and there's no real sense in having it on
    if we just want 1:1.

commit b384c608978dcd3d2ea6c0018179673cb4735f4c
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Mon Jul 2 09:32:28 2007 -0700

    Enable framebuffer compression (use Option "FrameBufferCompression"
    "true" in your xorg.conf).  Should save ~0.5W during typical 2D usage.

commit 1e2e301348b4168aeed38b3fdc6b0e43d5678a86
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Sat Jun 30 12:45:24 2007 -0700

    Fix load detection to use border region instead of blanking.
    
    Make sure there is some border area to use by changing how the pipe is
    configured, then pick a scanline in the middle of the border for load
    detection. This lets the load detect code use an active pipe instead of
    requiring an idle one.

commit 11862c2e1f23b77b56d7bd8b384579b5e3ae377b
Author: Alan Coopersmith <alan.coopersmith@sun.com>
Date:   Thu Jun 28 23:31:28 2007 -0700

    Add *~ to .gitignore to skip emacs & patch backup files

commit 6503eb45023d0db9a94cb9d1e14a26af07a6628d
Author: Alan Coopersmith <alan.coopersmith@sun.com>
Date:   Thu Jun 28 23:30:35 2007 -0700

    Add AM_PROG_CC_C_O to configure.ac
    
    Clears automake-1.10 warning: src/bios_reader/Makefile.am:8: compiling
     `bios_dumper.c' with per-target flags requires `AM_PROG_CC_C_O' in
     `configure.ac'

commit 5257e36f502676fd6a44bbb8e747d9138ed3bc5c
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Jun 28 15:29:52 2007 -0700

    Handle dual-channel LVDS on i855.
    
    Just as with i9xx LVDS, the i855 LVDS can operate in dual-channel mode with
    a modified P2 divisor value (7 instead of 14). Just using the existing 9xx
    code for 855 appears to work fine.

commit 16bfcb8042519f24b4494fd621814f39949ceeb6
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Jun 28 15:27:56 2007 -0700

    Decode PLL registers in LVDS mode a bit better in debug code.
    
    LVDS mode changes how the PLL works in fairly dramatic ways; the debug code
    wasn't properly accounting for those differences resulting in fairly bogus
    debug output.

commit 9675ccb30818bf831ac4c634751ab4bfe35f7bfe
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Jun 27 09:23:33 2007 +0800

    EXA: fallback mask transform on i965
    
    It needs to fix shader programs which hasn't been done yet.

commit 7a2300c88ae59f5b7c3ce89d33147e3f0ca23c18
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Jun 27 09:19:22 2007 +0800

    EXA: don't have to check offscreen size
    
    DDX will check it for EXA_OFFSCREEN_PIXMAPS flag

commit fff4a3b58fa18ee2ad91f998d190e90b77c051ab
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Jun 25 23:15:58 2007 -0700

    Use local structures for vs_state, sf_state, and wm_state

commit 0a8a4afd3c59011d6b1f5b39aedfb9bce0e55c48
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Jun 25 23:12:23 2007 -0700

    Use local structure for src_sampler_state and mask_sampler_state

commit 499166a60fcbf16021bd9ec233790ba55803aa44
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Jun 25 23:09:17 2007 -0700

    Use local structure for mask_surf_state

commit a418ef7316808b239884a90c3fe890220bcc0242
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Jun 25 23:07:19 2007 -0700

    Use local structure for src_surf_state

commit 0e3c0b17826b7b5a21ee2c1d789b084fc167f1ed
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Jun 25 23:05:50 2007 -0700

    Use local structure for dest_surf_state

commit 41a2c0f15446d59678461648f476fa71d40d44e0
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Jun 25 23:03:47 2007 -0700

    Use local structure for cc_state

commit 59f2150caca7eb374a2db43a472ba85f50d23274
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Jun 25 11:28:57 2007 -0700

    Remove redundant i830WaitSync from i965_prepare_composite
    
    There were two calls to i830WaitSync, and between them no state was
    being changed---just offsets were being computed.

commit 66aa0e61e1e8d2216a9c0555be5be004ed0a3192
Author: Dave Mueller <dave.mueller@gmx.ch>
Date:   Fri Jun 22 16:45:27 2007 -0700

    Bug #11171: Add support for the Ti TFP410 DVO TMDS transmitter.

commit f8d7cbc6e1322acad3351591336cefcfba7d9aaf
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Jun 22 16:29:21 2007 -0700

    Move the ivch's fixed panel mode support to i830_dvo.c for other LVDS drivers.
    
    This also results in removal of the setup hook, which was being called
    unconditionally and breaking non-ivch dvo drivers.

commit ec236c76b93aea5f2ee1e8b8509cde4625974fcb
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Jun 22 16:32:46 2007 +0100

    I830 needs to have plane/pipe/pll started in mode_set.
    
    The patch for the i855 to stop enabling plane/pipe/pll in mode_set broke the
    i830. Revert that just for the i830, leaving it enabled for the i855.

commit d957c6b8e1dde8e11c1db3431e0ff58c5d984880
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Jun 22 01:32:02 2007 +0100

    Increase vblank wait timeout from 20ms to 30ms. 49.6Hz < 20ms.
    
    The x40 LVDS mode has a 49.6Hz vertical refresh. Waiting for only 20ms can
    sometimes cause the driver to start programming the hardware before the
    vblank has occurred, which will lock up the i855 chipset. Extend this to
    30ms (the maximum timeout used by the BIOS) to ensure this doesn't happen.
    
    Detecting actual vblank occurance using the various status registers should
    also be possible but isn't yet working.

commit a67c2965385001bcb8987265f698ff0f5809cd11
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Jun 21 23:59:38 2007 +0100

    Follow BIOS configuration for Legacy Backlight Brightness.
    
    The backlight control in the LVDS controller can either operate in 'normal'
    mode or 'legacy' mode. In legacy mode, it uses the PCI config space register
    0xf4 which can range from 0 to 0xff. In normal mode, it reads the range and
    current value from the BLC_PWM_CTL register.

commit d6e46f67ab3af1ad3bfa72acb0efd9fe79dbf1dc
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Jun 21 20:16:36 2007 +0100

    Eliminate some uninitialized variable warnings

commit 9d104634cf03bea82d1467f01e577cb8d2e4b554
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Jun 21 01:15:39 2007 +0100

    Add 3DSTATE_CLEAR_PARAMETERS bits

commit 3bbf313ba541526a893915f8b6c64b1eccf325e0
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Jun 19 09:33:50 2007 +0800

    Fix left G33 issues
    
    Be sure to check G33 chip type in:
    - sdvo output
    - Y-major tile
    - crt detect
    - and xaa composite
    Sorry for that I should have fixed them very earlier...

commit acef342c870f3b5b781e48c8bf44739aa5ee8ffa
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jun 18 11:57:48 2007 -0700

    Bug #11295: Disable textured video on i915 with framebuffer width too large.

commit fbbb41bc5e03478cb46ee8f64ef68b23ff3fc14b
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Jun 17 14:59:24 2007 +0100

    Let DPMS functions enable plane/pipe/output on 8xx hardware.
    
    On 855, letting crtc_mode_set enable the plane and pipe will occasionally
    hang the chip. Instead, wait for crtc_enable to light things up. For 9xx,
    leave things alone.

commit d5ca000ece145a35fd6df0dcf3fb3460bd2d64e3
Author: Rémi Cardona <remi@gentoo.org>
Date:   Sat Jun 16 13:17:54 2007 +0100

    Include stdint.h to get uint64_t

commit 6b2ae93506d6795f87d6993bebfcb4e6632508ee
Author: Dave Airlie <airlied@linux.ie>
Date:   Fri Jun 15 23:30:04 2007 +1000

    sdvo: add support for RGB outputs on SDVO
    
    This lights up my monitor VGA-1 - it doesn't look the best though

commit 671ba03befebfdd7256855858987aabc28b2e8cd
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jun 13 16:30:26 2007 -0700

    Fix and enable the 915-class planar textured video path.

commit 6c29e0bae5f1e7cee02b678418394abb971594eb
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jun 13 13:40:39 2007 -0700

    Improve the drm_i915_flip_t check.

commit 420e41e7921d3cc07c784fd17936ec8a675f3b20
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jun 13 13:34:26 2007 -0700

    Revert "Replace failure-prone configure test for fresh libdrm with a simple ifndef."
    
    This reverts commit c2b130354aecffbeb2a2d23c7371461feaf5766a.
    
    Sadly, a non-working DRM_IOCTL_I915_FLIP already existed.

commit 51612e5ac3ddfb2bb172c58f2dfff9631093b69c
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Jun 12 16:09:54 2007 -0700

    On hang, dump up to the head pointer, not just up to the tail.

commit ceb6dd72443c094212b0281c42cbe92e9a29f682
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jun 4 16:37:53 2007 -0700

    Fix context switching between DRI and X.
    
    Now, all 3D pipeline consumers in the driver just call
    IntelEmitInvariantState(), which handles basic state setup, the caching of that
    state setup, and notifying DRI clients.  This also removes a mistaken idle
    wait in the Render code which was papering over the brokenness in the context
    switching.

commit c2b130354aecffbeb2a2d23c7371461feaf5766a
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Jun 12 08:49:21 2007 -0700

    Replace failure-prone configure test for fresh libdrm with a simple ifndef.

commit 0e1deb607f94e4aa3ec4b9df8ff7a07a1c95e31d
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jun 11 17:33:33 2007 -0700

    Fix a typo in _3DSTATE_DEPTH_SUBRECT_DISABLE definition.
    
    This is already fixed in the definition in the 3d driver.

commit 8d7a0ccd4f674659eb781def2cfdc3a6e5a219ce
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jun 11 17:33:07 2007 -0700

    Clean up some nits in i915_video.c setup.
    
    - The screen dimensions were used for the clipping despite drawing being done
      to any pixmap, not necessarily the screen.
    - One piece of state setup was not documented anywhere, and isn't used in other
      3d hardware paths that also work.
    - A 3DSTATE_MODES_1 command (830-class only) was issued even though it no
      longer exists.

commit 15caa64a497dcc0eacb0f91166d9b70206a8db35
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Jun 8 18:44:28 2007 -0700

    Add description for how to use the frame and pixel counter registers.
    
    The 24-bit frame and pixel counters were not described in detail and
    will be useful for DRM.

commit 404fd47573f855b0442d49a383542fc093825ad0
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Jun 6 11:01:48 2007 +0800

    Enable overlay on G33 class chipsets
    
    Which have to use gfx vm offset fot setup overlay regs.

commit f4c05973d391bdb0a9b0eadb155548310baa98fd
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Jun 5 11:07:41 2007 -0700

    Add support for the G33, Q33, and Q35 chipsets.
    
    These chipsets require that the hardware status page be referenced by an offset
    in the GTT rather than a physical memory address, so the X Server allocates it
    rather than the DRM.

commit 36fcaeb2ef94db5399071540bba106dec3db81d5
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jun 4 15:58:31 2007 -0700

    Fix misplaced merge of 1280x768 panel fixup.

commit 8a19e7d57bc23dd163b45e0ab7deca4f074c934d
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Tue Jun 5 00:09:57 2007 -0700

    Always ensure the pipe A is lit when activating overlay on pipe B.
    
    Ok, so moving video from pipe A to pipe B still requires that pipe A be
    active during the transition. Instead of trying to be fancy, just ensure
    that pipe A is running on each transition to pipe B.

commit e986f6cb62f8644c5fa835bd7dfb7b014c2677c5
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Mon Jun 4 23:52:23 2007 -0700

    Automatically switch overlay when crtcs are reconfigured.
    
    As crtcs are disabled and enabled, make sure the automatic crtc selection
    mechanism drives overlay configuration at each request to display an image.

commit 0984c1fc0963f1ebab31f5b8fce5ad4c387fbd2c
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu May 31 10:17:26 2007 +0800

    Add pci ids for 945GME

commit 88ee25ebad78e54d243d728b775a69365359b5fb
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu May 31 10:13:30 2007 +0800

    Add pci ids for 965GME/GLE chip

commit 92e4deb50e049cc83cbde4995ba0b901feceb15a
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed May 30 11:49:07 2007 -0600

    Extend XV_PIPE range to include new -1 value

commit 888a4a5f469bf955e3ee3e184b628808ae8a4498
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed May 30 14:42:35 2007 +0800

    Fix i965 render's draw clip rectangle
    
    Use scrn's virtual size is not correct in rotation rendering.
    This fixes initial rotation problem on i965.

commit 516fb73ffee0aea7cf892e6703d37f8ecf52b812
Author: Eric Anholt <eric@anholt.net>
Date:   Tue May 29 10:22:25 2007 -0700

    Remove README statement that 830M panels are unsupported.

commit 72462568da589054828b72ace83232a71636ee73
Author: Eric Anholt <eric@anholt.net>
Date:   Tue May 29 10:21:12 2007 -0700

    Expand manpage description of outputs supported.

commit 906b974bfeeed18d79c244ad3db4f5d30e13e4c8
Author: Eric Anholt <eric@anholt.net>
Date:   Tue May 29 09:49:08 2007 -0700

    Add a fixup to LVDS panel mode detection for 1280x768 panel from text mode.
    
    Apparently some BIOSes will program a small mode with large blanking instead of
    using the pannel fitter.

commit 4b2781291844b61b397e257a0fdb43e964e5f603
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat May 26 10:09:11 2007 -0700

    Mark IVCH as connected when detected

commit 2a365eab0178c28782fba97bdd22365f30ce8963
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Sun May 27 12:35:55 2007 -0700

    On i830, Pipe B cannot be lit the first time unless Pipe A is running.
    
    I don't understand it, but just like the video overlay, if Pipe A is not
    running, Pipe B will not turn the first time it is activated. This
    patch restructures the code used for the video overlay to share it
    with the crtc commit function.

commit ff8c8cb869a3c780dbd826f7c94f06e4f3fda6af
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Fri May 25 20:29:59 2007 -0700

    Compute and clip to crtc before call to xf86XVClipVideoHelper.
    
    By clipping to the crtc ahead of time, xf86XVClipVideoHelper will
    correctly clip to the bounds of the crtc, eliminating the need for any
    custom crtc clipping.
    
    Also, replace the broken xf86XVFillKeyHelper with a private version that
    doesn't end up stuck with the wrong clip list when the root window changes
    size.

commit 33f635d79fe891079558fd909d564f3cf424c482
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Fri May 25 17:32:06 2007 -0700

    Ensure Pipe A is active when enabling overlay the first time.
    
    The overlay on the i830 appears to be clocked by Pipe A when being enabled.
    If pipe A is not running, it will freeze the overlay and blank the screen.
    Setting a random mode on the Pipe and turning it on fixes this problem
    nicely.

commit ff0ac8ea63dd6e55573652c5826c482881da0d62
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Fri May 25 17:26:15 2007 -0700

    Xv does not require directRendering

commit 109e5d597b76f7414601cb39c07b133ebf1b0e61
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Thu May 24 11:40:50 2007 -0700

    Clean up CRTC selection. Remove more overlay blocking.
    
    Create separate CRTC selection function, use ints instead of floats for
    coverage measurement. Remove pipe stalls waiting for overlay update.

commit dfb1ec9a07f74125cb1724d41ed4342c4714e12b
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Thu May 24 11:23:44 2007 -0700

    Eliminate blocking for video overlay.
    
    No need to block for the overlay; just use the idle buffer.  This will
    always work because the buffer switch occurs at vblank time, so there is
    always plenty of time to get the next buffer contents in place before it
    starts getting scanned to the screen.

commit d172344599585e11388e59659dc9aaa86d7a31c1
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Wed May 23 20:00:16 2007 -0700

    Reformat i830_video.c to four-space indents.
    
    Yes, I can't stand it anymore. it's a huge patch, but
    git-diff -w shows no changes.

commit 02935ced3fba598a01d908ae49ccc30cbcc765a8
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Wed May 23 19:24:25 2007 -0700

    Clean up overlay management.
    
    Create separate on/continue/off functions for overlay.
    Manage overlayOn boolean within those functions.
    Eliminate redundant management code in other routines.

commit 08753f9b79f3f09879a18b552d90d88dbf52d4be
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Wed May 23 18:59:10 2007 -0700

    Use FLIP_CONTINUE with ~OVERLAY_ENABLE to turn overlay off.
    
    This makes the overlay work on i830 with the modesetting driver. I don't
    know why the pre-modesetting driver worked without this, but it did.
    A more 'correct' fix would be welcome, but this does seem to do the trick.

commit aa187186dc4f2d770a642060fe54f547ea8952b3
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Mon May 21 10:49:08 2007 -0700

    Automatically select crtc based on coverage.
    
    By default, select crtc based on which one covers more of the video output.
    pipe property can be used to override selection when both have partial
    coverage.

commit f5017a06a271bba0ace3c5415b78e78bc0c96f22
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Sun May 20 17:25:33 2007 -0700

    Use CRTCs instead of pipe indices for video pipe selection.
    
    Replace pipe indices with crtc indices and store references to the xf86Crtc
    objects in the video private structure.

commit 2df87256df755e972eb884bc742832038a020b2c
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Sun May 20 17:23:26 2007 -0700

    Dump pending ring on crash.
    
    When the hardware locks up, dump the pending commands in the ring for
    analysis.

commit 9971fac87622c93503540196e1756fded3d4869e
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue May 22 10:46:39 2007 +0200

    i830: Provide new DRI texOffsetStart hook when available with EXA.

commit 5390a2e2611950d3f48cc735df4a0c37bc5377a5
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Fri May 18 17:51:36 2007 +0200

    Update vblank pipes when a pipe gets disabled.

commit 4120a20626998272424225261f2cf7960b7ec0ca
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri May 18 10:10:34 2007 +0800

    EXA: add render enter helper function
    
    That notify mesa rendering is smashing the state, and check last 3d
    operation to do sync after we're swapped in or others.

commit 8db28aeaa6e908017b40bd9180f144a2972f6278
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri May 18 09:54:34 2007 +0800

    Fix ring debug code
    
    Use proper unsigned type for timer variables, and try to dump 965G state.

commit 16e50a91dd8b3676e8ce06052c549ab27e6843b7
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri May 18 09:53:36 2007 +0800

    EXA: remove a flush cmd in i915 render code

commit 12a9fcfe1b25cee850380d8ce11ef11cde9aaacb
Merge: b930bb9... e89d5f2...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu May 17 15:11:29 2007 -0700

    Merge branch 'master' of git+ssh://git.freedesktop.org/git/xorg/driver/xf86-video-intel

commit e89d5f275442915cc7777e75d3fcf7e7ed0f2084
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Thu May 17 15:00:12 2007 -0700

    Make each output control clones/crtcs. Split DVO into LVDS, TMDS, TV.
    
    Move clone/crtc config into each output where it's easier to understand (no
    need for a switch statement in I830PrepareOutputs. Also, split DVO into
    three sub-types (TMDS, LVDS, TVOUT) as those have different cloning
    abilities.

commit a441954630c6cdabbf463bfc3404160f97a04b4f
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Thu May 17 14:11:49 2007 -0700

    Enable panel fitter on ivch DVO.
    
    Using BIOS source code as a guide, set up the panel fitter on the ivch. This
    involves setting the pipe to the panel fixed mode, the DVO to the source
    size and assigning vertical and horizontal scaling factors in the ivch
    itself.

commit c0daa0a982e7074af4b50653b4a45b0a6352b43d
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Wed May 16 14:02:00 2007 -0700

    Change DVO module interface to pass more state across. Fix IVCH display.
    
    The DVO module interface reflected most of the xf86Output API to the
    underlying functions; finish that work given the changes that have since
    occurred in the xf86Output API.
    
    Move the LVDS-specific code into the IVCH module and make that work on the
    Thinkpad X30 (an i830-based laptop). Panel scaling does not work yet.

commit b28817a87a1608e849e4a9a736dda43533a84b0c
Author: Keith Packard <keithp@dulcimer.keithp.com>
Date:   Wed May 16 13:59:36 2007 -0700

    Add i830_bios_get_aim_data_block to read AIM data from BIOS
    
    Add-in modules have per-module data in the BIOS which contains configuration
    information which cannot be entirely discovered.

commit b31bef1a8effa9acb6de7edd206b9d8c48d88144
Author: Keith Packard <keithp@work.jf.intel.com>
Date:   Sat May 12 20:04:31 2007 -0700

    Deal with i830 CRT load detection which cannot use FORCE_BORDER.
    
    Chips newer than the i830 can force the border color for the active period
    of the screen, allowing the load detection to easily see the right data. In
    addition, newer chips appear to have more sensible load detection hardware
    which either ignores inactive periods on the screen or performs some
    longer-term averaging. The i830 appears to provide unfiltered samples of the
    detected load.
    
    For the i830, then, emit a border at the bottom of the screen and, for load
    detection, simply turn it purple and wait for the current line to be within
    the border. Sample an entire scanline, counting the number of times the load
    detection sees a monitor. In my testing, the presence of a monitor will
    cause the detection to succeed every time, while the absense will cause it
    to fail about 75% of the time. The code here, checks for presence at least
    75% of the time, which should be adequate.
    
    Also, as the new mode configuration code has already taken care to enable
    the CRT output, eliminate much of the load detection code which is simply
    duplicating functionality from the general mode setting code. This should
    result in faster load detection as this code will now run in no more than
    one frame time. It does burn the CPU the whole time though, polling the
    displayed scanline register.

commit b930bb9d6da8c24dbe0949afb7bb2aa4bcb24687
Author: Eric Anholt <eric@anholt.net>
Date:   Thu May 3 13:44:12 2007 -0700

    Disable vblank interrupts when no DRI clients are running.
    (cherry picked from commit 6621dd71ada839f4c1742e9e5b272e924cee21d9)

commit 3b769af53e0ef6ef9b56afd679446c73a0e63ea5
Author: Eric Anholt <eric@anholt.net>
Date:   Thu May 3 13:44:12 2007 -0700

    Disable vblank interrupts when no DRI clients are running.

commit 775fc125aa7ecd0f054959ef210be2df4dc54345
Author: Dave Airlie <airlied@airlied2.(none)>
Date:   Thu May 3 20:58:50 2007 +1000

    i810: be a bit more verbose about disabling DRI

commit 34f362d099d255f8f0bb34e9de30f953ee770163
Author: Eric Anholt <eric@anholt.net>
Date:   Wed May 2 15:40:49 2007 -0700

    Fix typo s/i/index/ in LoadPalette for depth 16.
    
    Reported by:	Haihao Xiang <haihao.xiang@intel.com>

commit f850d4727a2ad55c2116d0788f6684b2a0192d24
Author: Eric Anholt <eric@anholt.net>
Date:   Wed May 2 14:16:21 2007 -0700

    Make up a fixed panel timing for DVO LVDS, and use DVOA for DVO LVDS.
    
    The fixed panel timing will only be available when the LVDS is already on
    at X startup.
    
    So far, our only mostly-working LVDS driver is for the i830, and on i830 the
    LVDS is always on DVOA, so use that for all LVDS chips.  This may need to
    change if we support the ch7017 I've seen used on embedded i845, for example.

commit f3168e3b0c5664a322ca6bb1c81fc94844cb30ab
Author: Eric Anholt <eric@anholt.net>
Date:   Wed May 2 14:08:30 2007 -0700

    Disable non-working GTT decoding on i830, and fix map/unmap of GTT.

commit 1fc630f24f8ad9e304cb0761f9cacca2224203c4
Author: Eric Anholt <eric@anholt.net>
Date:   Wed May 2 13:29:21 2007 -0700

    Add DVO[ABC] register debugging.

commit d0ec37e9c0ceab1080700cd7be4a7cc58552d465
Author: Eric Anholt <eric@anholt.net>
Date:   Tue May 1 15:56:37 2007 -0700

    Make the DVO output name LVDS if it's an LVDS chip.

commit 490d05f99d2b62dd612d514d9ae0badbac9285ce
Author: Eric Anholt <eric@anholt.net>
Date:   Tue May 1 15:47:01 2007 -0700

    Fix typo in previous commit with s/XF86_DRI/XF86DRI/

commit c7bb34e83d7c459d932d01070cfeffbbf6c703ac
Author: Dave Airlie <airlied@linux.ie>
Date:   Wed May 2 14:25:39 2007 +1000

    disable all outputs on EnterVT
    
    This disables all outputs on EnterVT as the SDVO output can confuse
    the VGA output if the BIOS has enabled it on the same pipe but X
    isn't going to use the SDVO.
    
    Worked out on irc with keithp

commit cae0ae237b79fa7d3a82dfc8d3fb595ccb6c63e1
Author: Samuel Thibault <samuel.thibault@ens-lyon.org>
Date:   Tue May 1 12:41:18 2007 -0700

    Bug #10714: Fix build without DRI.

commit 6748d620fbf39dd98982856c09256bdec0fc82a1
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 30 17:27:23 2007 -0700

    Ignore VideoRam now that its original purpose is obsolete.
    
    It had been necessary to allow more than a small amount of memory to be
    allocated, but now those old small allocations people had configured are
    getting in the way.

commit a4f1a7872f6f959bb4bc6568face710bee3589de
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 30 17:13:09 2007 -0700

    Allow physical-memory allocations within stolen memory.
    
    Because stolen memory happens to be a contiguous block of high system memory,
    we can just read the GTT entries for it to get physical addresses for our
    allocations there if needed.  This reduces fragmentation of the aperture space,
    and will often reclaim up to 7 MB of memory that had been left unused since the
    simplified aperture manager was put in place, but without reintroducing the
    complexities of the old aperture manager.

commit 7d0d34cfdcc67d07e7667e13a9413743853134f8
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 30 10:39:54 2007 -0700

    Disable some clock gating functions documented to work incorrectly.

commit 138ac8f36cb4e4b3776f313955372522646acbb2
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Sun Apr 29 14:43:19 2007 +0800

    Alloc state mem buffer on 965G for xaa rotation
    
    965G needs state mem buffer to setup render pipeline.
    Thanks Barry Scrott for report this.

commit 0cd524e5411e35c8483c02ecc5062625809e6fc6
Author: Kristian Høgsberg <krh@redhat.com>
Date:   Wed Apr 25 18:09:10 2007 -0400

    Implement the custom I2C protocol used by the ivch DVO.
    
    The ihch DVO uses a modified I2C addressing scheme as described
    in section 5.2 of the data sheet.  Implement this by over-riding
    the I2C read and write word routines.

commit 880314aabe6326ed56517034940f0e10fb16e866
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Tue Apr 24 11:37:08 2007 -0700

    CRTC Rotation under XAA wasn't hitting accelerated path.
    
    The server rotation code is now using the root window in IncludeInferiors
    mode rather than using the screen pixmap. Change the XAA Composite code
    to check for this case now.

commit b23eae55c8cdd73e0aba1bf7ced283d402ee6470
Merge: 31bf269... cebdb8b...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Apr 19 20:38:18 2007 -0700

    Merge branch 'origin'

commit 31bf269afed0a830e79cbbd9d4b1ee9843af326c
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Apr 19 20:03:41 2007 -0700

    Update version to 2.0.0

commit cebdb8bfc6170a0fb441039f4422917fd0c77e70
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Apr 20 10:54:34 2007 +0800

    EXA: set enabling bits properly for i830
    
    This was found when debug exa on a 865GV, we should set
    pipeline state bits properly, otherwise the engine will hang.

commit 60e891915af7d0f522c9c3f966599fa07779f7aa
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Apr 19 14:02:23 2007 -0700

    Eliminate LinearAlloc option and code.
    
    With the fixes to the 2D frame buffer allocation that allows up to 65536
    lines of 2D frame buffer in XAA mode, the old linear allocation hacks are no
    longer necessary.

commit cca389769001c657435f056e1f1c26b0f52a48bd
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Apr 19 13:15:23 2007 -0700

    Clean up 1.2 xserver build support.
    
    Convert relative X server source path to absolute.  Check for local copies
    of needed header files before building, rather than requiring server source.
    Remove extra duplicate -I elements in AM_CFLAGS in sub directories.

commit 07797fee88d6be0dfb30394a419dd86f8a3c9095
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Apr 19 13:01:37 2007 -0700

    Fix mismatching braces when XF86DRI_MM is not defined.
    
    A closing brace was left inside #ifdef XF86DRI_MM while the matching
    open brace was outside.

commit 163c565527e8cda1f5a47c7fd63f04c80feaf3c7
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Apr 19 13:00:03 2007 -0700

    Use I2C delay function instead of usleep.
    
    usleep isn't always available, and we have an existing delay mechanism
    available to use.

commit 378ceea3d9ddbec7a08ac2f07f9a8cd9cf3cef36
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Apr 19 17:30:28 2007 +0800

    Fix mem list order and remove extra unbind call when free memory

commit db4b9e18810990e8900bdf54aa3091b876ea2658
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Apr 18 13:52:08 2007 +0100

    Fix return status

commit 3f5111940e35989d334aa99cd1b0eb26293ebf1b
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Apr 18 13:27:59 2007 +0100

    Update read_response to include the try on PENDING status
    
    and remove it from get attached displays call.

commit 902388fa06f85486fe8010807ab53e4926cc979a
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Apr 17 14:21:25 2007 -0700

    Don't try to init the XAA linear region unless we allocated memory for it.
    
    Reported by JM Ibanez

commit 8abecae202b609375b6754dbd5ecce3d59036daf
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Apr 17 12:28:43 2007 -0700

    Fix i852 EXA Composite acceleration setup.
    
    Reported by JM Ibanez.

commit 2dbe8d678b02b724c4f06255383f49bb4c2708b0
Author: Timo Aaltonen <tjaalton@cc.hut.fi>
Date:   Mon Apr 16 14:14:19 2007 -0700

    Fix build against xserver 1.2.

commit a089ac11beb4c801928c17780401e913bc0d5257
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Apr 17 11:01:05 2007 -0700

    Add all the possible ivch slave addresses (still commented out).

commit 37ee68a95ca8c86ebe9abafaaf55b060dd2a2f73
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Apr 17 10:50:02 2007 -0700

    Bug #10438: Fix 965 XV when sourcing from less than the full image.
    
    Bob deinterlacing in MythTV, and the zoom options in totem would result in
    attempting to source from outside the video instead of scaling appropriately.

commit ac9181c014638dbeb334b40b4029d0ccb2b7a0fc
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Apr 17 16:30:17 2007 +0100

    Check for the PENDING message when reading the attached
    displays. Ensures the command has completed before continuing.
    
    (probably need to check PENDING in other SDVO calls too)

commit ab5bdee8a62c842ae32aaef57eb841ebcb644d2b
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Apr 17 16:23:46 2007 +0800

    EXA: fix i830 render
    
    Fix tex blend pipeline in case that src/mask pict has no
    alpha. Unmask color buffer write disable bits. These make
    rendercheck run fine on 855GM.

commit 1a29750b8dba1371d7d0802744cdf2f3bfa83c13
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Apr 16 16:21:39 2007 +0800

    EXA: fix 830/845G pict format
    
    Fallback in 830/845G when pict format is a8, x8r8g8b8 or
    x8b8g8r8. The hw doesn't support them.

commit 3a634bbd198650c1597dec4306d99928374c30f3
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Apr 16 15:14:49 2007 +0800

    EXA: Add i830 supported pict format XRGB8888, XBGR8888

commit 3bcb9a0b4ba7f3df346b5708617a7aafcbe2490a
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Apr 16 14:27:49 2007 +0800

    EXA: i830 render misc fix and cleanups
    
    Try to map texture stream when setup texture map, and use
    correct order in load_immediate_1 cmd, which fixed crash on
    845GV. Also remove some flush cmds.

commit 64c30cf896f8bde3ee74c92b970132ab91b418cd
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Apr 16 13:58:50 2007 +0800

    Update intel.man with 965GM chipset support

commit b67adb6de34cede0e31f02f26cd5ec7b1adfa586
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Apr 13 22:34:52 2007 +0800

    Fix crash on G965 XAA with LinearAlloc option
    
    We should alloc xaa_linear mem in LinearAlloc case, otherwise
    we get crash when initializing xf86 fb manager.

commit b5b243e4120d6a048fb6bbe8814fe3184271e9d9
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Apr 12 12:34:23 2007 -0700

    Add license headers to 965 programs.

commit 08cd5f9b0f086e51112008d50de48556372899f9
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Apr 10 11:26:46 2007 -0700

    Bug #10520: i810 manpage not installed despite users expecting it to be there.
    
    Install it as an alias to intel.4x, since we're letting people load the driver
    as "i810" still.

commit bf9771e9711361632afe3abeeedca7ce03497005
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 9 15:26:05 2007 -0700

    Don't use extended regexps in sed when not necessary.
    
    Some seds require a flag to enable extended regexps.

commit 656fbd952542ba5ddc9b018071008ceb38b1bd19
Author: Brice Goglin <brice.goglin@ens-lyon.org>
Date:   Mon Apr 9 13:06:46 2007 -0700

    Bug #10515: Fix module version number with more than one digit per field.

commit aa850d3c633a510d787ee59e538e26e5c3acbf4a
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 9 11:44:25 2007 -0700

    Turn off ALWAYS_SYNC in EXA.
    
    This slipped in as a debugging aid, and never got turned off.  The driver
    appears to work fine without it on an i915 system, and for the non-default EXA
    option, we'd rather see issues found than continue running with debugging aids
    and hiding them behind bad performance.

commit d2e75d8acde2541b85a0050d9e47182c1db7fc2c
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 9 11:34:57 2007 -0700

    Avoid a magic number and correct a (currently harmless) ifdef in ResetState().

commit 9ed446e12bd21b7c8222c6e63a03a8e2ec6b97e2
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Apr 3 11:39:48 2007 -0700

    It's 2007 now.  Didn't I get the memo?

commit d9d05b553ca1f98efc230ef13f34576122311ac1
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Apr 3 00:15:02 2007 -0700

    Bump version to 1.9.94 for 2.0 RC4.

commit eb45315b07624cb0506d539f523728a651efb798
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 2 18:20:33 2007 -0700

    Move README to being a plain old text file.

commit 9b78208f1ef1a8ee98f2aa139956659169e234ab
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 2 18:20:15 2007 -0700

    Move a bunch of debugging verbosity under Option "ModeDebug".

commit 9ea83d440d6b9e30d4627e34168226a6b4b2a841
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 2 11:39:27 2007 -0700

    Update README source for new release notes.

commit c6d0bf9fb6033339159d98dc2b9fe44759ad9de5
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Apr 2 10:09:43 2007 -0700

    Remove long-stale TODO file.

commit c59e5895a0ea1f219c8f63a02b429a024bd1ed66
Author: Dave Airlie <airlied@linux.ie>
Date:   Mon Apr 2 07:18:04 2007 +1000

    make warning info only so ppl don't go reporting stupid bugs

commit e119eaabb2ad1ffc1d83f18199f49c52ec71b0fe
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 30 17:09:18 2007 -0700

    Warnings cleanup in ch7xxx.

commit fd98e88d1a6e0e8d35bda868e7afcb78d2d11524
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 30 17:07:29 2007 -0700

    Finish off some function renaming that was missed before.
    
    Thanks to alanc for catching this.

commit 274b99e5e750228eba9a67773725a40ebaa9bf56
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 30 17:06:43 2007 -0700

    Don't forget the warnings CFLAGS in subdirectories.

commit aa6a9abb34e93780c07563ab5b21d8c064ea0a1c
Merge: 670c852... 107ac12...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Mar 30 12:10:17 2007 -0700

    Merge branch 'crestline-qa'

commit 670c8521f18f01b9ea899ceb68d2a3dbb884b199
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 29 13:43:31 2007 -0700

    Add missing file for old server compatibility build.

commit 89c84f939f2dbed1d03a5f0e1daae23a229e47bc
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 29 13:40:52 2007 -0700

    Whitespace cleanup in Makefile.

commit 6cd3b2c2de4596886aab85988b16cf63e8887add
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Mar 27 15:34:32 2007 +0800

    EXA: i830 fix blend action
    
    i830_get_blend_cntl() has already added S8 offset.

commit 35b3dd881a333569ce20ddf36b915b095757a1ba
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Mar 27 15:33:43 2007 +0800

    EXA: fix i830 componentAlpha support
    
    Pick fix from i915 render, change tex blend pipeline for CA.

commit df96d9a11d038ad64673022ce14c24223b3bd34c
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Mar 27 15:32:53 2007 +0800

    EXA: fix i830 texture setup
    
    Use LOAD_IMM_2 helper cmd for tex setup. Enable RepeatNormal
    support. Fix A8 format, i830 can support it now.

commit aa78e67553ffe8ca986330f0ee49b5414c71a71f
Merge: 768821b... 2191634...
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 26 22:00:36 2007 -0700

    Merge branch 'master' of git+ssh://git.freedesktop.org/git/xorg/driver/xf86-video-intel

commit 107ac12867eda6b86212159db15c640d3490f2da
Merge: 6548817... 2191634...
Author: Nian Wu <nian.wu@intel.com>
Date:   Tue Mar 27 12:51:45 2007 +0800

    Merge git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 768821bd3832aad01e44856199e60c6b7726a83b
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 26 21:27:54 2007 -0700

    Bump version to 1.9.93 for 2.0RC3.

commit 2191634dd67b3219bb88f365bcf951d5a58140e8
Author: Alan Coopersmith <alan.coopersmith@sun.com>
Date:   Mon Mar 26 14:58:41 2007 -0700

    Add Solaris to list of OS'es with agpgart in man page

commit 1c809f92467f97b098bcc89d66e60f6f88d9bade
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 26 13:03:28 2007 -0700

    Update .gitignore.

commit f7befe50af4c13554d1f7aee6b05848ac312411b
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 26 13:01:11 2007 -0700

    Power on the LVDS B-channel pairs only when we've chosen dual-channel mode.
    
    It was basing off of the clock rate, but we have an override to use the
    existing dual channel state when we can detect it, so the two settings were
    conflicting.

commit 827dc457a4fd0b97c95ec696ec9c3cd2f4a4becb
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 26 12:45:23 2007 -0700

    Update manpage to remove Rotate option and point at xorg.conf instead.
    
    While here, update a few other bits as well.

commit 654881794ae1ad7214e85091b9015ae0fbdc5ddc
Merge: 6de3edc... d572771...
Author: Nian Wu <nian.wu@intel.com>
Date:   Mon Mar 26 17:00:11 2007 +0800

    Merge git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit d5727717c9141be28a69b1154ccd23c23207f8f6
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sun Mar 25 23:44:59 2007 -0700

    Switch TV_FORMAT property to format XA_ATOM
    
    This allows the driver to report the set of valid formats in the property
    data.

commit 6de3edcb52e6258f1af75e4f4bef73de1698445d
Merge: d874aa3... 1e6e675...
Author: Nian Wu <nian.wu@intel.com>
Date:   Sat Mar 24 17:00:13 2007 +0800

    Merge git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 1e6e675524461ef0eb1983de89e2877426571a55
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Mar 23 23:42:52 2007 -0700

    Eliminate calls to RRPostPendingProperty.
    
    RRPostPendingProperty has been removed in favor of RRPostPendingProperties,
    and that call is now managed outside of the driver.

commit 28da6f4e307880326dd553f50fe3fff3b9be9f4f
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Mar 23 14:36:42 2007 -0700

    Record 3D state loss at EnterVT in last_3d value.
    
    last_3d set to LAST_3D_OTHER indicates that the 3D hardware has unknown
    state.

commit ab19439cf4592e4607dc0bfc602aba3d56645a42
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Mar 23 14:34:27 2007 -0700

    Don't call AdjustFrame on EnterVT.
    
    AdjustFrame is strictly for legacy compatibility; calling it on EnterVT
    wrecks crtc positions.

commit d874aa31599da4777438cc51469afe9b66601f55
Merge: 94dbc37... 26f32ef...
Author: Nian Wu <nian.wu@intel.com>
Date:   Fri Mar 23 17:00:12 2007 +0800

    Merge git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 26f32ef680a19e63af4b7c8c84141fe32263f298
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Fri Mar 23 01:17:58 2007 -0700

    Property size is in units, not bytes.
    
    Several places were using byte lengths instead of unit lengths for
    properties.

commit f48dc501fbf74e0ac348f0b77750016597849ef4
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Fri Mar 23 01:08:08 2007 -0700

    TV output properties: TV_FORMAT, LEFT, TOP, RIGHT, BOTTOM.
    
    Remove TV format from mode name, instead use an explicit output property and
    split the input resolution from the tv format. Add properties to set the
    blank area on all four sides of the image.

commit 94dbc3725358d63fe0ac8e6749489c993d24ede2
Merge: 28af380... 20b2685...
Author: Nian Wu <nian.wu@intel.com>
Date:   Thu Mar 22 17:00:15 2007 +0800

    Merge git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 20b26854abdacb6dc45cba2d81d515b2e47e25f1
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Mar 22 10:33:15 2007 +0800

    EXA: don't smash vertex header in G965
    
    Originally we smashed vertex header to store texture
    coordinates, this is working as we only use sf/wm kernel
    and disable all other stages on pipeline. But better to
    not do this. This also cleans up vertex elements state
    and makes vertex buffer order looks "normal".

commit 28af380ab133eb14d21dc650c77bdbab66576255
Merge: 300e893... e06c5f7...
Author: Nian Wu <nian.wu@intel.com>
Date:   Wed Mar 21 17:00:04 2007 +0800

    Merge branch 'crestline' of git://otc-graphics.jf.intel.com/git/xorg/driver/xf86-video-intel into crestline

commit e06c5f727fb2e2de111ac9e691a877c56d2ca1b4
Merge: 0202399... 3025fa0...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Mar 21 15:04:21 2007 +0800

    Merge branch 'master' into crestline

commit 02023998663cc7f0735fadfb1719d93dc2e5a112
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Mar 21 00:00:56 2007 -0700

    Whitespace and symbolic reg names cleanup in i830_panel_fitter_pipe().

commit 3e9ec78b4f54defb9986e11e6f2ac3475755849d
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 20 23:58:48 2007 -0700

    Set the panel fitter to the right pipe on Crestline.

commit 3025fa0fb2bf5ace7076796e45e2560fe8410e8d
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Mar 21 14:50:45 2007 +0800

    EXA: try to enable rotation for G965
    
    The new sf/wm should handle the texture sampling only in
    rotated case. Also fix possible hole in VUE slot.

commit a50009604152bf9237c40bd098b3b1da3d018929
Merge: 0a612e7... 2239448...
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 20 23:32:19 2007 -0700

    Merge branch 'master' into crestline
    
    Conflicts:
    
    	src/i810_reg.h
    	src/i830_display.c

commit 300e893cec19dca48e00ee25014b8714dc13b278
Merge: 96e8699... 0202399...
Author: Nian Wu <nian.wu@intel.com>
Date:   Wed Mar 21 08:55:50 2007 +0800

    Merge branch 'crestline' of git://otc-graphics.jf.intel.com/git/xorg/driver/xf86-video-intel into crestline

commit 223944878cf38f86580df5a7d3102d86cfc061b9
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 20 14:33:53 2007 -0700

    Attempt to fix single/dual-channel issues on i9xx LVDS panels.
    
    - Use the existing single/dual-channel state when available, as changing it
      doesn't appear to work out.
    - Set the power state of the CLKB and B0-B3 pairs according to whether
      choose to go dual-channel or not.
    - Restore the LVDS register at the appropriate point (before DPLLs are
      re-programmed.

commit 96e86994f3d1b4938e99a751454ee99bebfe40d3
Merge: f465c23... 0a612e7...
Author: Nian Wu <nian.wu@intel.com>
Date:   Tue Mar 20 13:11:09 2007 +0800

    Merge branch 'crestline' of git://otc-graphics.jf.intel.com/git/xorg/driver/xf86-video-intel into crestline

commit 0a612e7115ff993bb8e9a00df13c0b0d20122fd6
Merge: 8bb6778... 4c4faf2...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Mar 20 11:34:40 2007 +0800

    Merge branch 'master' of git://proxy.ims.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline
    
    Conflicts:
    
    	src/i830_display.c
    
    Change LVDS output and postread like upstream. This might
    need to be retested on 965GM LVDS.

commit 4c4faf260eb4dad1b1919c6168fa9ef477b98a39
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 19 13:36:37 2007 -0700

    Set the CURSOR_SIZE register when present.
    
    Failure to do so gets you a lot of pretty colors.

commit 64c14204453bea3f98d19861c450612e718e6c69
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 19 13:35:43 2007 -0700

    Print the mode actually being set per pipe.

commit 3ce802414a20ca8af128a00e6925a099dd90ceb4
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 19 11:35:11 2007 -0700

    Add debug output for ADPA.

commit c21b88d838fda1f00f6f6bcfe7855d32543c6f3f
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Mon Mar 19 10:45:58 2007 +0100

    Fix build when DAMAGE is not defined.

commit 991719c21a6cc1b5d9b7cbe30d4b333718b3e686
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Mar 18 23:05:33 2007 -0700

    Make i830_sdvo_write_sdvox write everything twice.
    
    For some reason, certain chips don't correctly enable the SDVO hardware when
    this register is written only once. We're following what the BIOS code does
    and writing it twice now, but with extra posting reads to boot. Yes, this is
    cult-and-paste, but it fixes problems found on deployed hardware.

commit 9118122a232d4cf7760bcb0874fe970c25251378
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sat Mar 17 21:34:03 2007 -0700

    Allocate 4 separate buffers for HW Cursors on Linux.
    
    Linux cannot allocate a large fixed buffer for the HW cursors as needed for
    FreeBSD; instead, allocate four separate buffers. The code now prefers to
    allocate one buffer (less overhead) and falls back to separate buffers only
    when necessary.

commit 62a5399d70ac3f8579441d617f8d80c94942a32a
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sat Mar 17 21:32:36 2007 -0700

    Elide I830DRIClipNotify for older DRI versions.
    
    I830DRIClipNotify is passed to newer versions of DRI; don't include it in
    the server when building against older versions.

commit 05e0021147a89254182c277007236448f315231c
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sat Mar 17 21:31:04 2007 -0700

    Cast ARGB cursor address to CARD32 * to eliminate warning.
    
    While we're just doing a memcpy, it's nice for the two argument types to
    match.

commit d05bb5362e986c9d27bc03c7e1a939ba28824810
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Mar 17 20:21:59 2007 -0700

    Increase DDC I2C RiseFallTime to handle older monitors
    
    Changing this value slows the entire I2C bus down, making it far more
    reliable on older monitors. Note the same change has been made in the core X
    server code; this change is included here to ensure that older X servers
    work reliably with this driver.

commit 44d1b544cec2e75735d2e27d66a9240317b962c2
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Mar 17 17:15:43 2007 -0700

    Build fix for pre-XF86DRI_MM environments.
    
    Misplaced brace broke builds with older DRM libraries.

commit a58befe9d243bd562cb4b2f08ec5c9f754148c20
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Mar 17 17:12:37 2007 -0700

    Remove extra (and incorrect) I2C ByteTimeout setting.
    
    Setting the value correctly and then immediately breaking it caused many I2C
    transactions to timeout with slow monitors. Oops.

commit 9d6d9ace4bd3180a4484321c3b96a83bc4adaf84
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 16 19:41:54 2007 -0700

    Move vendor ID check in the utils to after pci_device_probe.
    
    Even current libpciaccess seems to require this.

commit a117bc9e3eb824f2056ee6416859ea3ab1fdcc30
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 16 19:39:34 2007 -0700

    Add the (afaict) correct ch7017 I2C slave address.

commit 29446cdb4f72e12c5249b0d4b79ea56d9fe19934
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 16 19:18:37 2007 -0700

    Fix compile failure due to needed types being in inttypes.h on Linux.

commit 213394fbaaf353404cbb3aaa4c20860f48ee1079
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 15 19:13:28 2007 -0700

    Fix crashes and other failures when a cursor allocation fails.
    
    Now, we allocate one single block of memory for cursors, and either succeed or
    fail once, rather than trying to support partial fallback modes that generally
    resulted in pain due to being untested.  In particular, this fixes cursors on
    FreeBSD, which only allowed one large physically-contiguous allocation.

commit 316ee682d342556b65cbd60409201591e916aac5
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 15 18:53:55 2007 -0700

    Don't reload the cursors if we haven't set up the screen yet.
    
    This avoids a crash during preinit if we set a mode for load detecting.

commit 8b06ab50bbd79dfaf4c90a6f76116ace64b85b77
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 15 10:12:14 2007 -0700

    Fix sparse warnings about using 0 for NULL.

commit 8ae6ad93329e2842c6f2d5b20ffeb0c14d10c0de
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Mar 15 00:00:51 2007 -0700

    Use new driver-independent CRTC-based cursor layer.
    
    This eliminates all of the cursor rotation code and other cursor management
    infrastructure, leaving a fairly simple hardware layer in its place.

commit 9fbef2de9edbbed9c2f6a80c4074b9b245547c45
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Mar 14 12:34:34 2007 -0700

    Bump to 1.9.92 for RC2.

commit 555b801a75cafa082808bc9bb683e700fc97d79a
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Wed Mar 14 11:41:50 2007 +0100

    Make sure the legacy texture area is there when needed.
    
    This currently only matters when the DRM memory manager is not available and
    Option "Legacy3D" "off" is specified, but that hasn't always been the case and
    might change again in the future.

commit 66fdb08c83d353fbe4e917900c54b555c869eb80
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 13 17:07:10 2007 -0700

    Refine the i855 LVDS clock code.  In particular, p2 is always 14.
    
    This gets correct clocks detected on most harware.  The SSC is always assumed
    to be 66Mhz, which may not be true, but we'll fix that when we find example
    hardware.

commit 44708bdd9ebfef0328302c9a964b80deb46e57c6
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 13 16:55:38 2007 -0700

    Get SDVO DPMS working on the Mac Mini by writing SDVOB and SDVOC together.
    
    Also, add code for setting the encoder power state like the BIOS does, but this
    doesn't appear to work.  We do much more than the BIOS does in powering things
    down, so perhaps that's interfering somehow.

commit 5135b3a79f9c30ebce78c84c49846bba83607fed
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 13 10:21:06 2007 -0700

    Use a POSTING_READ(reg) macro instead of using the (void)INREG(reg) pattern.

commit 578da7ca705c5a58c0bd397b0831e2f95140f8ae
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 13 10:11:29 2007 -0700

    Add PCI write posting protection to i2c putbits.

commit cf33abe43bd95c9437fad8e6201a24084ff96cb8
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 13 10:08:57 2007 -0700

    Add write posting protection for the SDVO DPMS-on path.

commit 9d30f0007203157e6b82fa0ffc57324490eb2ca0
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 13 10:04:06 2007 -0700

    Replace #if 0ed LVDS register setting with updated comment.

commit 9c17c6e9c63563cad5edff837519a73fe0afe313
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 13 09:55:49 2007 -0700

    Add write posting protections to relevant register writes in the mode-set path.

commit 2824ec7ccbf44ba413a6133f735f4a548c73b3cd
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 13 09:53:35 2007 -0700

    Fix uninitialized string use in SDVO non-TMDS case.

commit f465c23750adf908c0ea874f95aad98ebd2f1015
Merge: d33e8da... 1ed3843...
Author: Nian Wu <nian.wu@intel.com>
Date:   Tue Mar 13 17:00:44 2007 +0800

    Merge git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 1ed3843f73a0d8efa405daff3483ebe70bf6134f
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 12 17:47:32 2007 -0700

    Make the 965 use Y-major tiling for the depth buffer, as required by the spec.
    
    An example of the failure can be seen with the reflect demo when set to
    depth buffer mode.
    
    Reported by:	Haihao Xiang <haihao.xiang@intel.com>

commit 7aa257154685bd2520649ce87a3a84e55644d02c
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Mon Mar 12 19:00:14 2007 +0100

    Fix build against released libdrm.

commit 7c561956a28e90667fef140bc3cfa0edca464f15
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Mon Mar 12 18:55:27 2007 +0100

    Defer flipping pages back to normal until the end of the DRI block handler.
    
    Doing it earlier can result in the wrong page being visible, giving the
    appearance of a frozen X server.

commit fe59ab9f562fd10118563d80eb3351a4d3b48b3f
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Mon Mar 12 13:03:47 2007 +0100

    Disable page flipping if the DRM is older than 1.9.
    
    Older versions don't support the functionality we need.

commit ba55ff15df974197bebd871e28bb96d817ae41c7
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Mon Mar 12 13:01:00 2007 +0100

    Fix attempt to flip pages back to normal when the last 3D window disappears.
    
    When this succeeds, 2D rendering does not have to be synchronized to back
    buffers until the next 3D window appears.

commit c4a23c5ef8ce56ee0fe547fbc7c6623c021f801b
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Sat Mar 10 16:15:33 2007 +0100

    Remove unused have3DWindows from pI830.

commit d33e8daa6874ced978d2a1f687c48922555f2524
Merge: 58aeb87... 797aa6f...
Author: Nian Wu <nian.wu@intel.com>
Date:   Mon Mar 12 09:03:52 2007 +0800

    Merge git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 797aa6fcb1231587bde1efb47bc8430c4c8d8110
Author: Dave Airlie <airlied@linux.ie>
Date:   Sun Mar 11 12:58:50 2007 +1100

    fixup missing assert includes

commit 43a80ef9094efcb49027c83f0e726f907fecfbb2
Author: Dave Airlie <airlied@linux.ie>
Date:   Sun Mar 11 12:58:26 2007 +1100

    fixup brace alignment for older X.org

commit 0d33fd3d03cef3a7e63d88ae441354390b37a937
Author: Dave Airlie <airlied@linux.ie>
Date:   Sun Mar 11 12:58:02 2007 +1100

    add XMODES flags to the i2c drivers

commit 3c2d6e07bdf8daef6486b594aef0d22460eb2585
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Fri Mar 9 23:49:46 2007 +0100

    Don't crash when the SAREA pointer is NULL.

commit 7518b8959ee7598f3526365a83ea7e143a5d6a4e
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Fri Mar 9 19:50:03 2007 +0100

    Revert change accidentally included in previous commit.

commit 1991a90ae90b388c914985d20d6f8c3637856e9a
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Fri Mar 9 19:47:13 2007 +0100

    Update SAREA pipe sizes in i830_crtc_dpms instead of i830PipeSetBase.
    
    This allows setting the size to 0 when a pipe gets disabled.

commit aef161853033907c6916337cebe88c8f111dd542
Merge: 1b54ee4... 14ee919...
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Fri Mar 9 15:14:48 2007 +0100

    Merge remote branch 'origin/master' into i830-pageflip

commit 1b54ee493fb96f944aa81e56fa6f00a8067f87fc
Merge: e972265... 81722a2...
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Fri Mar 9 15:13:50 2007 +0100

    Merge remote branch 'origin/master' into i830-pageflip
    
    Conflicts:
    
    	src/i830_dri.c

commit 14ee9195d203192d3f613919f230b20b900ffdba
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Mar 7 13:00:03 2007 -0800

    Bug #10157: Fix cursor corruption on server regen.

commit 58aeb87f2e335d15eba73ce9dd1982e867c52403
Merge: a4e7e81... 81722a2...
Author: Nian Wu <nian.wu@intel.com>
Date:   Wed Mar 7 16:02:03 2007 -0500

    Merge git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit a5f0522b1d34236278861fe15bac2df099f0a2c7
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Mar 7 15:49:47 2007 +0000

    Add some additional checks when XAA is enabled.

commit 81722a21d232fa6cfb11fbe3d984abab50e89bcc
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Tue Mar 6 23:16:53 2007 -0800

    Remove usage of 'shadow' module. Use xf86CrtcScreenInit.
    
    With the new mode setting code, rotation is handled outside of the driver,
    so the old usage of the 'shadow' module is no longer needed. Code to
    initialize the crtc structures has been moved out of the driver and into the
    modes code.

commit 04f50961e2f1610c39e7e4b45811f2a6b517cad6
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 6 14:23:06 2007 -0800

    Bug #9898: Fix a crash with NoAccel set.

commit b07dfbba5df7728232b38211c623185116dcea5c
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 6 13:59:14 2007 -0800

    Remove leftover code that was disabling tiling after we set it up.

commit 94c37f35872487c04136fb659526bffefd9c46ad
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 6 13:57:04 2007 -0800

    Make the depth buffer X tiled instead of Y, and fix a Y tiling nit on 945.
    
    The previous code claimed to set the depth buffer up as Y tiled, but due to
    lack of implementation in SetFence, it ended up being X tiled.  Actually
    setting the Y tiling flag in the new version broke the depth buffer, so just
    switch the depth buffer to X tiling, which appears to work fine.

commit a4e7e814a24dbe30a33e6ad45baeb41d190a2724
Merge: 862088b... 4042b27...
Author: Nian Wu <nian.wu@intel.com>
Date:   Tue Mar 6 16:01:40 2007 -0500

    Merge git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 30bb719ca0abc2599ffb89e59f297fa9a0a00c3c
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Mar 6 12:23:43 2007 -0800

    Continue to allocate the legacy texture pool by default.
    
    This is a partial revert of 7358642e64ab6d13bc1dc1a44703ee66d715ff61
    
    If we don't allocate it now, when the DRM version is too low there won't be any
    memory allocated and DRI will fail.  Instead, waste the memory in the i915tex
    case for now, and leave fixing it right (check DRM version up front and decide
    which memory manager to set up) to later.

commit e972265261c421268e4fb806e587378d0adec577
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Mar 6 16:54:16 2007 +0100

    Fix build failure.
    
    Not sure how I missed this before... Thanks to Todd Merrill for reporting.

commit 862088ba6a91d3e7cf8d37126b1d9f4ee03a1f73
Merge: 11e9158... d717d9d...
Author: Nian Wu <nian.wu@intel.com>
Date:   Tue Mar 6 07:43:16 2007 -0500

    Merge git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 1e1b45fa6ed1683cba4ae73ac98933e74c3ab9d6
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Mar 6 10:28:41 2007 +0100

    Fix reduced DRI memory manager size.
    
    pI830->mmSize is in kB.

commit 3c08bc7d6974a1a6cf5f9cb81898617032966c52
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Mar 6 10:14:47 2007 +0100

    Fix some conditionals related to triple buffering.
    
    Guard code that dereferences pI830->third_buffer with tests for that instead of
    pI830->TripleBuffer. It could happen that we want to enable triple buffering
    but (temporarily) can't because the third buffer couldn't be allocated.

commit c25cfafbe1eb380b58b5fc16e94f5cc6f422f0cd
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Mar 6 10:00:12 2007 +0100

    Unify allocation of back buffers.

commit e787d7b698d320a7c45df35d58c5113413561fe2
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Mar 6 09:35:42 2007 +0100

    Remove warnings about potential artifacts with page flipping and mixed 2D/3D.
    
    The artifacts only seemed to occur when EXA was falling back to software for
    the front buffer.

commit 6c299aea8e87e72c68c96c03594706c976601ede
Merge: 3308152... 4042b27...
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Mar 6 09:28:52 2007 +0100

    Merge remote branch 'origin/master' into i830-pageflip
    
    Conflicts:
    
    	src/i830_display.c
    	src/i830_driver.c

commit 4042b27f01fdb94e7fc0d4e991e054fff88479ea
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Mon Mar 5 22:32:52 2007 -0800

    Move EnterVT mode setting code to xf86SetDesiredModes.
    
    Make the application of crtc desiredModes generic code instead of
    per-driver by creating xf86SetDesiredModes from the code that was in EnterVT
    and calling it.
    
    Also, move the frame buffer clear until just before mode setting to make
    sure things are mapped correctly.

commit 55ee46aebbf1ec1a8ce914fbd0c8894fc857db8f
Merge: 5c72014... 50aa094...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Mar 6 12:45:08 2007 +0800

    Merge branch 'master' of git://proxy.ims.intel.com:9419/git/xorg/driver/xf86-video-intel

commit 5c720147e2b86ca4046b7c3812c1ca6b0fb78c9d
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Mar 6 12:44:04 2007 +0800

    EXA: try to always alloc exa i965 state buffer in stolen mem
    
    I think this is a safe way to work around any possible chip
    error.

commit 11e91586169b4f4bf2b41c0e0e620a69670c2f07
Merge: a24962a... 0150270...
Author: Nian Wu <nian.wu@intel.com>
Date:   Mon Mar 5 16:00:20 2007 -0500

    Merge git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit a24962af9ed39fabca0152cae1265a29fe6237d3
Merge: 35e9310... 8bb6778...
Author: Nian Wu <nian.wu@intel.com>
Date:   Mon Mar 5 16:00:11 2007 -0500

    Merge branch 'crestline' of git://otc-graphics.jf.intel.com/git/xorg/driver/xf86-video-intel into crestline

commit 50aa09425f54c4eeca7f8b0fae9579209b10b9c4
Merge: d717d9d... c2c6255...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Mar 5 11:28:46 2007 -0800

    Merge branch 'modesetting'

commit c2c62559e702e7de1fa2ef309fa647ab13564dc3
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Mar 3 23:12:54 2007 -0800

    Move single mode setting code to X server.
    
    Code to drive the global configuration from a single mode setting operation
    (from RandR 1.1, XFree86-VidModeExtension or XFree86-DGA) has been included
    in the X server now, so remove it from this driver.

commit 35e9310ef59873877422dcaf9a65b38789fc8ad6
Merge: c8e6f0b... b27fa2c...
Author: Nian Wu <nian.wu@intel.com>
Date:   Mon Mar 5 09:01:55 2007 -0500

    Merge branch 'modesetting' of git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 8bb677889d3f71cde671f17a3589939acad2c3b3
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 5 05:08:51 2007 -0800

    Fix 965GM SDVO by not setting fields in SDVO[BC] which have new meanings.

commit 330815251dee808754b328cd2fd60db39f2460eb
Merge: 50ba1ff... 0150270...
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Mon Mar 5 13:05:20 2007 +0100

    Merge remote branch 'origin/master' into i830-pageflip
    
    Conflicts:
    
    	src/i830.h
    	src/i830_dri.c
    	src/i830_dri.h
    	src/i830_driver.c
    	src/i830_memory.c
    	src/i830_xaa.c

commit d717d9d566fe3c0866b06840114e1c1990bd7be0
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Mon Mar 5 12:57:21 2007 +0100

    Fix DRM memory manager initialization.
    
    It takes the offset and size in pages, not bytes.

commit a0c83af3430b6705ab2ecae59085d1c74e890c19
Merge: c0f99b4... bc20b54...
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 5 03:37:53 2007 -0800

    Merge branch 'modesetting' into crestline

commit 7358642e64ab6d13bc1dc1a44703ee66d715ff61
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Mon Mar 5 11:53:09 2007 +0100

    Fix handling of new vs. old texture pools.
    
    Only one of them can be active.

commit 50ba1fff886a7f51b178ac6d3a1ba79a3014b214
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Mon Mar 5 10:22:07 2007 +0100

    Be more verbose when page flipping can't be enabled for various reasons.

commit 015027034e970f1e3bb6ab239f7e0119235e404f
Merge: 9a51064... bc20b54...
Author: Eric Anholt <eric@anholt.net>
Date:   Sun Mar 4 21:49:00 2007 -0800

    Merge branch 'modesetting'
    
    Conflicts:
    
    	configure.ac
    	src/i830_driver.c
    	src/i830_modes.c
    	src/i830_video.c

commit af565872a49a1a464ee4154c27136660b184c4c1
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Mar 4 21:20:33 2007 -0800

    Set version number to 2.0 RC1 (1.9.91).

commit bc20b54c34088356a277beaebcc90bb4a7063e19
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Mar 4 19:35:44 2007 -0800

    Support new CRTC/Output prepare/commit hooks.
    
    New hooks replace explicit invocation of DPMS functions to manage mode
    setting sequencing.

commit b27fa2c257ccc49c6f29a20a3e672ebaaf58e7aa
Author: Eric Anholt <eric@anholt.net>
Date:   Sun Mar 4 17:15:45 2007 -0800

    Fix a crash with XAA and DRI disabled after the allocation rework.

commit fc7d43c2b6b98be597152fbd88024273edd931d0
Author: Eric Anholt <eric@anholt.net>
Date:   Sun Mar 4 17:14:30 2007 -0800

    Use -f for ln of server source. Otherwise, changing paths didn't take effect.

commit b7b6063e62927dd135e118c433f48b4d0b5fe246
Author: Eric Anholt <eric@anholt.net>
Date:   Sun Mar 4 15:53:50 2007 -0800

    Add a little BIOS dumper program.
    
    This isn't actually tested yet as libpciaccess doesn't do rom access on
    non-linux yet.

commit 6aeb855b9d4e03d458773240a9c0c9c1edd3e403
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Mar 4 17:11:40 2007 -0800

    Shadow pixmaps use fixed offset of 0.
    
    Shadow pixmap contents are copied from the main frame buffer and contain
    only the bits displayed by the crtc, not the whole frame buffer. The crtc
    origin is always interpreted by the shadow copying code, the frame buffer
    itself doesn't move.

commit c8e6f0bac13e0e407f9771b1bbf126f023c1511b
Merge: 0ed5a2f... c0f99b4...
Author: Nian Wu <nian.wu@intel.com>
Date:   Sun Mar 4 09:00:12 2007 -0500

    Merge branch 'crestline' of git://otc-graphics.jf.intel.com/git/xorg/driver/xf86-video-intel into crestline

commit 7d08f720a95499e8d00dcd7174f06731de420017
Merge: dd24d2a... 435d355...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Mar 3 23:13:03 2007 -0800

    Merge branch 'modesetting-origin' into modesetting

commit 435d35558d8135a2c1724dfd813fb4a9a4e14178
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sat Mar 3 22:46:31 2007 -0800

    Update for Aaron's xserver changes.
    
    Add xf86CrtcConfigFuncs to xf86CrtcConfigInit
    Add canGrow option to xf86InitialConfiguration

commit c0f99b4962553e560a5cb882a5060d95db5477a4
Author: Keith Packard <keithp@gamba.jf.intel.com>
Date:   Sat Mar 3 22:36:46 2007 -0800

    LVDS dither control moved from PFIT to LVDS register for Crestline
    
    The LVDS register now contains lots of new controls for dual-channel LVDS control
    along with dither enabling. The PFIT register has a lot fewer controls as a result.

commit 0fa3d4f51b5ee0dba3882fd74b6ac4e7da708f8f
Merge: 10655c4... fd52d63...
Author: Keith Packard <keithp@gamba.jf.intel.com>
Date:   Sat Mar 3 21:02:17 2007 -0800

    Merge branch 'modesetting' into crestline

commit 0ed5a2fdcfe9674175aa9af155c20695ef41cadc
Merge: 7ba80cc... fd52d63...
Author: Nian Wu <nian.wu@intel.com>
Date:   Sat Mar 3 09:00:20 2007 -0500

    Merge branch 'modesetting' of git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit fd52d635603b7093c5a2b7fa9c987cf59f9be27c
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 2 13:44:57 2007 -0800

    Add a WIP UploadToScreen implementation.  This almost displays right.

commit ca0fa875e8bb5cb778d4db7d8053ec0a5ae34ef4
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 2 11:46:45 2007 -0800

    Move EXA offscreen memory back after framebuffer to avoid fallbacks.
    
    Without this, the EXA code decides that the framebuffer is not in video
    memory because it's not located between the start of video memory and the end
    of EXA allocator memory.  We should either have EXA let the driver decide if a
    pointer is in video memory, or add a new field for "end of video memory" (not
    just end of EXA offscreen allocation), but this fixes things for now.

commit 5a73624b9bcce0004e5b72c74667c9dd504b9c3e
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Mar 2 11:03:16 2007 -0800

    Fix a crash when an ARGB cursor allocation had failed.

commit 7ba80cc3a5e0f469e3ee55c7537fdc952cd85911
Merge: 9796cb7... d5df52b...
Author: Nian Wu <nian.wu@intel.com>
Date:   Fri Mar 2 09:01:46 2007 -0500

    Merge branch 'modesetting' of git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit d5df52be59a7dd950e73336ce5698e73480108b0
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Mar 1 08:35:13 2007 -0800

    Actually add the files for reg_dumper.

commit 9796cb7ac4bd74d5336986bb194ff5875b028121
Merge: 42deb1e... 1f5d166...
Author: Nian Wu <nian.wu@intel.com>
Date:   Thu Mar 1 09:02:22 2007 -0500

    Merge branch 'modesetting' of git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 1f5d1666c8386ca4597c6f2c1ec239f9d821da4c
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Feb 28 16:27:55 2007 -0800

    Add a non-installed command line tool using libpciaccess to dump registers.
    
    This reuses the i830_debug.c code, so we can run that from the console or from
    the BIOS-based X server to debug some remaining issues.

commit cd1d4b398ec91d551bdaaa26c769e5e6a9442df1
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Feb 28 09:47:38 2007 -0800

    Many fixes to mode_get, mode_set, clock limits, and register dumps on i855.
    
    This should fix a number of issues with i855s, particularly with integrated
    LVDS panels.

commit 36cad3fcb65e3dcd88e58e301cd60adb121cb96b
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Wed Feb 28 17:52:42 2007 +0100

    Update vblank pipe setup when setting a mode.

commit b5316fb2623e9630cbd58020e0a7c95bf354c587
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Wed Feb 28 17:50:56 2007 +0100

    I830DRIClipNotify: Fix initialization of crtcBox[1].[xy]2.

commit 42deb1e10fc445d152b74e2b225daeaee2abb3d1
Merge: 76aac38... 3e8e75e...
Author: Nian Wu <nian.wu@intel.com>
Date:   Wed Feb 28 09:00:24 2007 -0500

    Merge branch 'modesetting' of git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 76aac382659bc1dab7dca078f703b9cf48b4ad74
Merge: 42fc06c... 1ac83f5...
Author: Nian Wu <nian@tinderbox.sh.intel.com>
Date:   Tue Feb 27 14:42:42 2007 -0500

    Merge branch 'modesetting' of git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 3e8e75e5d83a2fa7e9fc6e9a3fbb07dac548ea5a
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Feb 27 16:48:48 2007 +0800

    Revert "EXA: enlarge 965 exa state buffer size"
    
    This reverts commit 1ac83f51ee46d65237eae1b5c767e106ac9e29bc.
    oops, current exa state + kernel program size + scratch space
    is actually ~36KB.

commit 1ac83f51ee46d65237eae1b5c767e106ac9e29bc
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Feb 27 13:58:47 2007 +0800

    EXA: enlarge 965 exa state buffer size
    
    Origin size seems break all render, be sure to assign enough
    mem. 80k works fine for me.

commit acd9f3e28fcf5e91e09d8bdca4cc58681b1fc92a
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Feb 27 13:56:31 2007 +0800

    Fix typo when assign overlay reg mem pointer

commit 5b765065c0bdf671b60d8a2fe512f6307f753eab
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Feb 26 17:25:57 2007 -0800

    Consolidate shared structure allocation to the start of ScreenInit.
    
    Previously, the structures would get allocated unnecessarily once, and
    wouldn't get reallocated in time at server regen.

commit 6ed28c5aa34ff1d8b99a8d4721ddac7b9cac41ed
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Feb 26 17:12:44 2007 -0800

    Fix XV issues on 965 after the allocation rework

commit 36bfeb890aeb17a8ee058790dd69b4e9aba644a1
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Feb 26 16:58:33 2007 -0800

    Move the initial EnterVT to after we've set up acceleration.
    
    This fixes a crash with initial rotation and EXA due to EXA not being
    initialized in time for the shadow pixmap setup.

commit 732885c08daaf17034da8f4855d0b957ec3df9d7
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Feb 26 15:04:56 2007 -0800

    Bug #9604: Align the sizes of allocations to page increments as well.
    
    Without this, the 965 DRI driver fell over when pitch * height wasn't
    page-size aligned.  Since the allocator only allocates at page-aligned offsets
    anyway this shouldn't hurt us at all.

commit 0bfaeaab2838184827236c5c0fcc17f06d9e1372
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Feb 26 11:11:56 2007 -0800

    Fix physical memory allocations, including description in log.

commit 5732dd7221b7bb24bf21e16066f014a0c7cb6b2a
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Feb 26 09:54:04 2007 -0800

    Fix some texture memory allocation issues.

commit aeeae1b40fc012bcc01fcd2243d4993de819b7cf
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Feb 26 09:13:17 2007 -0800

    Fix a crash in startup monitor detect.

commit 10655c4674cdac8a231c50dd9afc5d43fe43b4bd
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Mon Feb 26 09:23:14 2007 +0800

      for merge with external tree

commit 9417af8630fce0476273b693ebac12129415e0cf
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Mon Feb 26 08:02:50 2007 +0800

      fix conflict with external branch

commit 42fc06c85a0c487cfa26b9d4aa396402dbc4c2fe
Merge: 10655c4... 3bce8bf...
Author: Nian Wu <nian@graphics.(none)>
Date:   Sun Feb 25 12:53:47 2007 -0800

    Merge branch 'modesetting' of git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 84a7429730ddd29072d696accb9fdd8fea40731a
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Feb 23 14:59:24 2007 -0800

    Always allocate logical_context, since we use it in emitting invariants.

commit 7bb725dee9ef0ccdc478ed4931dc267bcb80203f
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Feb 23 14:56:58 2007 -0800

    Improve logging of memory allocation passes, and clean the code up a bit.

commit 54198b26e87baa180208932b97f10b27d9c0fddc
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Feb 23 14:17:07 2007 -0800

    Move memory allocation to ScreenInit rather than PreInit.
    
    This lets us do memory allocation just once rather than having several passes
    (as long as things succeed), avoids trouble with zaphod mode, and will let us
    do better automatic sizing of allocations soon.

commit 828deff6453872ef0f9fa35c08c9f95f464b1785
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Feb 23 13:16:02 2007 -0800

    Fix fence allocations on 965.

commit d3ac440e127c8a7716062852cd3b5e7943e289e4
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Feb 22 10:41:09 2007 -0800

    Rework the video memory allocation.
    
    The previous allocator worked in multiple passes, with (at least) one of
    setting up allocations, another to attempt to adjust those for tiling, and
    then a pass to set up the offsets and fix them in memory.
    
    The new allocator is simpler, allocating memory immediately if possible,
    setting up tiling up front, and choosing offsets immediately.  AGP memory
    is only allocated to back actual memory used, saving some memory that would
    have been allocated for padding previous. It will also allow dynamic freeing
    and reallocation of memory, which will be useful for framebuffer resizing.

commit a61a6b1db610a07060d0dcca54b66a4b2b3686cc
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Feb 21 09:43:24 2007 -0800

    Reformat to 4-space indents, no trailing whitespace, and 80 columns.
    
    I'm in the process of rewriting this file, and wanted to separate my whitespace
    changes.

commit dd24d2a082b41abc466391c37a9b3d066586dc55
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Feb 22 11:46:44 2007 -0800

    Remove copied X server headers from driver.
    
    These two headers were copied during mode setting development; as that code
    is now inside the server, these files are no longer needed here.

commit 681966ce6548c6f47b087eb7e369674b7ddbaade
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Feb 22 11:45:43 2007 -0800

    Disable unused functions after configuring the remaining resources.
    
    This eliminates an unsightly flash of the hardware cursor during X server
    startup.

commit f5ab9e0ad3a65c972861dd53be6e33e1aac13191
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Thu Feb 22 18:57:23 2007 +0100

    I830DRISwapContext: Some cleanups.
    
    Also call I830EmitFlush() when entering/leaving the server context. Doesn't
    seem to help for artifacts with page flipping and mixed 2D/3D unfortunately.

commit 8cce74f195e5ef6ce5599ecd52f35bcfcb0d7913
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Thu Feb 22 18:27:59 2007 +0100

    Do not sync DRI windows between pages when possible.

commit f346549183a407a4bff6521ec2450dacb97442e9
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Wed Feb 21 09:19:54 2007 +0100

    intel.man: Fix typo.

commit 3bce8bf0e95e5842399959a5d6f6413e96f03adb
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Tue Feb 20 23:10:17 2007 -0800

    Pre-965 hardware had fixed pipe 1 for panel fitter.
    
    The pipe mode setting code needs to disable the panel fitter when using the
    pipe for things other than LVDS output. The driver was checking for panel
    fitter conflicts using bits that the 965 chipset defines for selecting which
    pipe the panel fitter is connected to. However, on pre-965 hardware, the
    panel fitter works only with pipe 1 and those bits returned 0.
    
    The result was that when pipe 1 was using the panel fitter, configuring pipe
    0 would disable the panel fitter.
    
    The fix provided uses a model-specific test for the panel fitter pipe.

commit 0bee64f4bc7581de7ab28ca438581d215e85c610
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Feb 20 19:09:37 2007 +0100

    Add support for triple buffering using a third static buffer.
    
    Need to bump the DRI DDX version minor for the added SAREA fields.

commit 2212baa8454abb4c7948c3f2e20e337f831d1b86
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Feb 20 18:39:13 2007 +0100

    Don't mark page flipping as active when it really isn't.

commit fac8f2eb49de22abd853ca75f3c985d4d94e3633
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Feb 20 18:38:40 2007 +0100

    Document Option "PageFlip".

commit 5a1a04649c62aa4b1c0617560b813642ce0c67b5
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sat Feb 17 17:01:04 2007 -0800

    Make distcheck fixes. Distribute all sources needed even for older servers.
    
    Always allow (but do not require) link to server sources so that needed
    files can be included in the generated tar files.
    
    Add remaining .g4a files and assembly output to distributed file lists.

commit 0ca926e63c7fa9122a8cba1424ce4cdee1c7b215
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Fri Feb 16 02:19:10 2007 -0800

    Check for presence of xf86Modes.h file.
    
    xf86Modes.h file signals the availability of the new modes API in the
    server; use that instead of counting on X server version numbers.
    Also, finish eliminating use of local copies of those header files.

commit 972f1109d23c0a3f821fa573e2aa40cd17ce2795
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Fri Feb 16 01:07:20 2007 -0800

    Remove common code that has moved to xserver/hw/xfree86/modes

commit 20e146a09e3b4907a6800588ebfa787bfc5b0d89
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Fri Feb 16 00:57:44 2007 -0800

    Change rotation pixmap creation API to permit start-time rotation.
    
    Start time rotation requires that the pixmap be created after the server has
    initialized the screens. Delay the pixmap creation until the first block
    handler invocation.

commit 17e38e39a49b2a96e31cca4a0b922631c5f7879e
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Feb 15 23:09:43 2007 -0800

    Enable mode setting function renames from shared code.

commit 8e7bc4b1f95f5d62ff18cd94f14f5e3949ef6a29
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Feb 15 11:17:53 2007 -0800

    Use server sources for crtc/output generic code.
    
    As sources for these have been merged to the server, use them from the
    server source code instead of keeping copies in this driver.

commit 6e33c4c44030e05d6d07ca9274cfe4d6df2c0387
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Feb 15 09:54:43 2007 -0800

    Print the correct meaning of bit 30 of pipeconf for 965 in debug output.

commit 4541150cdce3f2f83b8530d0863aecf28c6610a9
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Feb 15 09:51:04 2007 -0800

    Detect core clock frequencies, to avoid double-wide mode when possible.
    
    Additionally, don't attempt to set double-wide on the 965, where there is
    no such thing any more (not that we'd ever see modes high enough to trigger
    it).

commit d1be0dc4e9d443dcbd218a083cfb21a0b5d634ee
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Feb 15 11:03:12 2007 +0800

    EXA: fix i965 default color (0,0,0,1.0) -> (0,0,0,0)
    
    (0,0,0,1.0) is actually black...

commit c010d28f0a91a9831d366ea490878ef3d958021f
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Feb 15 11:00:06 2007 +0800

    EXA: mask componentAlpha support
    
    we're getting load of multiple sf/wm programs for i965, might
    need to be cleanup in future.

commit ec55dd16c4c5f7612d33ae22a6249b3b1c60e2b6
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Wed Feb 14 14:37:02 2007 -0800

    Global namespace cleanups, filename fixes.
    
    Ensure all xf86 symbols created here are protected with XF86NAME.
    Remove accidentally exported symbols from namespace.
    Make all to-be-DI files prefixed with i830_xf86.

commit 22a271555a46267c40448fa926d45692498ef7c6
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Wed Feb 14 14:17:14 2007 -0800

    Create driver-independent DGA hooks, remove i830 DGA code.
    
    As RandR needs to poke at DGA code, and we want the RandR code to be
    driver-independent, it seemed easier to just make the DGA code
    driver-independent as well.

commit a7c64d5e28f608d54c94fa7a5c92bd5b471179c7
Author: root <root@guitar.keithp.com>
Date:   Wed Feb 14 10:20:28 2007 -0800

    WIP DGA generic support.

commit 55c7b017ed718107b9b11467030addf225728b84
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Wed Feb 14 16:45:22 2007 +0100

    Use new DRI ClipNotify hook to track page flipping per CRTC when available.

commit 3bd8edb95fcbbb49e97a1a2bdd5c8eae4f83d3a8
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Fri Feb 2 17:41:18 2007 +0100

    Revive i830 page flipping support.
    
    Use the damage layer directly instead of via shadowfb.

commit 1d22bad33b634aaf61976907cb2ceeec8a9ebe4d
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Wed Feb 14 12:57:12 2007 +0100

    Update SAREA pipe fields in i830PipeSetBase.

commit 0df490938af10d3a748221e2fb5467b0f244f9eb
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Thu Dec 21 11:27:28 2006 +0100

    If the DRM can handle it, enable vertical blank interrupts for both pipes.

commit 1623b47c4863f5362587cdac855e3e11c109b007
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Feb 13 17:37:56 2007 -0800

    Switch the RECTLIST vertex order to (x2, y2), (x1, y2), (x1, y1).
    
    This is the documented correct ordering, and while the previous ordering
    (reversed) worked on some hardware, it failed on others.
    
    Reported by:	Wang Zhenyu <zhenyu.z.wang@intel.com>

commit 4bd4058dfdca84d6ebab82a1dfba99adf3852c9c
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Feb 13 14:29:52 2007 -0800

    Bug #9941: ViewSonic VX2025wm sync polarity quirk to fix mode distortion.

commit 0ec4ffcb4e8e5e707e68bef1b13a324677f19f8f
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Feb 13 13:18:15 2007 -0800

    Fix double free in the case of LVDS disabled through quirks.

commit 699fa88d2570de6173e2d866e11b7437f4842d74
Merge: 681b919... 6641aec...
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Feb 13 13:10:08 2007 -0800

    Merge branch 'modesetting-origin' into modesetting

commit 6641aec0a1cbc869fba1956c556cdd204631545a
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Feb 13 10:21:12 2007 -0800

    Attempt to detect panel fixed mode from EDID or current programmed mode.
    
    These two sources are placed in higher priority to the BIOS data when
    available, since the BIOS data has proven unreliable.  The BIOS data is still
    read, and warnings printed if it doesn't match what we probe.  The BIOS data
    remains useful for the situation where we want to turn on LVDS but there is no
    EDID available and no current mode programmed (i.e. booting with VGA or TV
    connected).

commit 991439d4c78cf5b2a8f6bb8f5b36fffbfcc4e4fc
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Feb 13 10:07:47 2007 -0800

    Remove dead #if 0-ed structure.

commit c3aed56d46baba057d83dc6ea12c6b4e705e54ba
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Feb 9 13:16:37 2007 -0800

    Fix comments on 965 pitch alignment restrictions.

commit 98318dfcc99264fb7b7ef34568712812aa6300b6
Author: Daniel Stone <daniel@fooishbar.org>
Date:   Fri Feb 9 16:20:57 2007 +0200

    add missing files to fix distcheck
    A bunch of files were missing from _SOURCES, and the build was also broken
    for missing files (from EXTRA_DIST) when building without gen4asm.

commit fce4390c4f1a76c65423114bb479814787612cd7
Author: Zou Nan hai <zhenyu.z.wang@intel.com>
Date:   Fri Feb 9 11:32:22 2007 +0800

     TV Enable

commit 00dadaa115951c36de9caf2a9d78909811ef34bc
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Fri Feb 9 11:14:50 2007 +0800

      set DPLL before detect

commit 10712c7a781e50475ee7e8ccd5bfd2d820f863e2
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Feb 8 08:56:42 2007 +0800

    EXA: i965 pixmap pitch align
    
    This seems like a typo, which causes screen artifacts.

commit 44eacf2323454e26b535cc5a4f0789cb0ff0e7fb
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Feb 7 17:30:51 2007 +0800

    EXA: fix render issue with i965
    
    Fix SF kernel with corrent coeffient work, and correct
    VUE storage in multi texture case.

commit 920aeaf8478f706ab3b1de4f20f5d351e64a0197
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Wed Feb 7 13:15:52 2007 +0800

      Make TV code same with external tree.
      Fallback to old filter table.
      4 spaces indent reformat.
      Auto scaling seem to not work well on some low res interlace mode when input width > 1024, filter those modes.
      Fix some subcarriar number

commit 6d9757e466863594300c83f3806fd4376bea0504
Author: Zou Nanhai <nanhai.zou@intel.com>
Date:   Mon Feb 5 14:59:53 2007 +0800

    Fix hang when TV is not connect.

commit 681b91924c364a1c00732f548539f2767929ba0e
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Feb 2 17:40:34 2007 -0800

    Add subpixel offsets to fix accelerated rotated rendering on i915.
    
    This fixes the rendercheck "transformed src/mask coords 2" tests. Previously,
    the source pixels chosen would be off by one in some cases.
    
    The particular values were taken from Mesa, which uses .125 offsets (except
    apparently broken for y), but the signs are changed.  I would be happier if
    I had better justification for why this worked.

commit 76a4f2eea826036e2ac16b7e8c61ab946038c120
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Feb 2 17:34:41 2007 -0800

    Fix bad offsets in "right" rotation of the CRTC in cursor and update handling.

commit 785a59ead0e8d1d681b2cb6827ee58ad2c51f8c6
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Feb 1 22:48:44 2007 -0800

    Rename driver from i810 to intel. Permit old name for compatibility.
    
    Driver installs as intel_drv.so with symlink to i810_drv.so to ensure
    existing configurations continue to work. Updated manual page to reflect
    name change and add attributions for recent work.

commit 1dde7a15a3a42b881c57ece95feceffadf412cff
Merge: 16f30b2... 1ba45a3...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Feb 1 21:31:27 2007 -0800

    Merge branch 'modesetting-origin' into modesetting

commit 16f30b2e6c72e228c66946ff9efadd7278379745
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Feb 1 21:30:19 2007 -0800

    Add "Ignore" option to per-output monitor, removes output from server.
    
    Setting option "Ignore" "Yes" will cause the server to pretend as if the
    specified output does not exist at all. It will not be listed by the
    RandR1.2 extension, and the server will not attempt to detect monitors at
    startup time.

commit b3633506dcd4fd58f0f9519cd67f6e75d6fb2042
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Feb 2 11:35:44 2007 +0800

    Add Intel 965GM chipset support

commit 380129a17c61c783d77a87685ad5333e8b1c253c
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Feb 2 11:33:46 2007 +0800

    Revert original crestline pci id patch

commit f7489bbec150349bf03bea8d9d55451dbc92bfc2
Merge: f1285ec... ae6d358...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Feb 2 11:26:57 2007 +0800

    Merge branch 'modesetting' into crestline
    
    Conflicts:
    
    	src/i830_display.c
    	src/i830_tv.c
    	src/i830_xf86Crtc.c

commit ae6d3585a4d96aa4dc05ca8563cebfa7796324ef
Merge: 6d549ed... 1ba45a3...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Feb 2 11:21:59 2007 +0800

    Merge branch 'modesetting' of git://proxy.ims.intel.com:9419/git/xorg/driver/xf86-video-intel into modesetting

commit 9f0acf1eb01ad8320f4da4cc5e498af25c0ecc5e
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Feb 1 15:44:18 2007 -0800

    Check for rotation change in xf86RandR12CrtcSet.
    
    xf86RandRCrtcSet was ignoring changes to only rotation, so the screen would
    be left incorrectly rotated.

commit 1ba45a3fcd40aaf4d373447fb9f252ca053f9105
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Feb 1 13:26:38 2007 -0800

    Improve register debugging output.
    
    This includes not reporting some fields on hardware where those bits are
    reserved, correcting one of the hardware error bit numbers, and reducing
    the severity of the debugging output warnings.

commit 9bfeadbd5b37acb56cb646009239a94727ec52bc
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Feb 1 12:04:58 2007 -0800

    Remove some more dead options.

commit d6bc03c379c46842676f640b8edb13ea828bf20c
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Feb 1 11:28:34 2007 -0800

    Bug #9819: Add two headers that are apparently necessary on older X Servers.

commit 351866b0328b1d7afdc6b414c77d9ab4da4bd085
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 31 15:48:52 2007 -0800

    Sync before overwriting Render acceleration state on the 965.

commit 96783a458957ca280ebb6275fa692dd415df6931
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 31 15:48:02 2007 -0800

    Fix copy-and-paste-o in the render code cleanup that broke XAA.

commit 5238ff9c80718f9f8baa06123aa1bb6e3193fce6
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 31 14:01:41 2007 -0800

    Naming and formatting cleanup in Render acceleration code.

commit c47210d94ed17ad9e8e489a1e1886732e6dc7220
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 31 12:50:31 2007 -0800

    Move the render code to non-EXA-specific filenames.

commit 72ea0e514dcbebd009833c21f40e9bfb84074628
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 31 12:43:38 2007 -0800

    Remove custom accelerated rotation code now that it's all done through Render.

commit e62751db8b1a631c22ba0f77c932be4ab39ba741
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 31 12:15:38 2007 -0800

    Add an accelerated path for rotation Render operations in XAA.
    
    The now-generic (kind of) EXA code will be cleaned up and moved to generic
    files in a later commit.

commit f1285ecb72e807ac10db398fa983bf69d4154d97
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Wed Jan 31 14:58:08 2007 +0800

      tune

commit 0620a7650f758652d05a0c25d159587f641aaf3e
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Wed Jan 31 11:21:11 2007 +0800

      fix

commit 12441e217a1968dea3a6b0646b6c5d0e2ede0e7e
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Wed Jan 31 11:20:23 2007 +0800

      add 720p@50Hz,
      however 720p in this freq seems to not support src width,
      hactive > 800, so skip those inputs.

commit 726c7dd89627409820ee5cf9bf657d5a926b3648
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Wed Jan 31 10:34:39 2007 +0800

       TV fixes.

commit 4cd552e8f4851e029e43bf778cd8340f6c2c4881
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Jan 30 16:34:50 2007 -0800

    Fix accelerated Render transformations.
    
    Previously, we tried to use 2 points instead of 3 to describe the source
    rectangles, which mostly just worked for scaling.

commit 6a628ae12b0568d656059891c5bca4415d8a735f
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Jan 30 14:19:05 2007 -0800

    Simplify EXA acceleration transform handling.

commit c8581254cb811f76aa6eae49d74489b543b3eb05
Merge: 9da1791... d329fa1...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Jan 29 21:25:13 2007 -0800

    Merge branch 'modesetting-rotation' into modesetting
    
    This adds reasonably driver-independent rotation support to the common
    layer. The piece required in the driver is to allocate and redirect the crtc
    to a shadow frame buffer. The driver uses Render to perform the actual
    rotation operation (which leaves us free to do fun projective transforms at
    some point in the future :-).

commit 9da1791eeca446cd59e2e7d0803e8a7920dbbea5
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jan 29 17:10:14 2007 -0800

    Restore a few important lines from 89ace3e81fe72075b1709b073c05532f13b7f0d1
    
    Typical results were failure to sync, and a black screen.

commit 67c6a490e63f6997f8198bc3ab180a1af097fe86
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jan 29 09:53:58 2007 -0800

    Remove dead code to undo the damage of xf86SetModeCrtc() blank limiting.

commit 89ace3e81fe72075b1709b073c05532f13b7f0d1
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jan 29 09:43:35 2007 -0800

    Bug #9680: Remove bogus blank length limiting in xf86SetModeCrtc().
    
    Our modes typically come from EDID or default modes, and when the monitor
    asks for a specific mode, deciding to tweak it usually results in incorrect
    display.  And if the user is specifying a mode by hand, tweaking it then is
    still pretty rude.
    
    Reviewed by: ajax

commit 6eb69e737864d06dc6d4fbb4cd85a027cbb7643a
Author: Dave Airlie <airlied@linux.ie>
Date:   Sun Jan 28 19:40:12 2007 +1100

    ch7xxx: actually power up the chip around connection detection

commit d329fa121b2401cadb991c2854e077cfa68e15e8
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sat Jan 27 18:36:15 2007 -0800

    Fetch from root window instead of screen pixmap during rotation.
    
    The XAA Composite wrapper doesn't check for sourcing from the root pixmap
    when deciding whether to sync the hardware drawing. Fix the rotation code to
    reference the root window in IncludeInferiors mode to avoid reading without
    correct synchronization.

commit 20419d664c77e9a1a2de82987838b45f44774b47
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sat Jan 27 18:34:12 2007 -0800

    Paint ARGB cursor data to ARGB cursor memory space in frame buffer.
    
    When converting from global cursor to per-crtc cursor, the ARGB cursor data
    was accidentally painted to the wrong location, overwriting some critical
    data and causing the hardware to lock up. (along with generating a garbage
    cursor image from uninitialized data).

commit 00decd3b6cea0de22c88b9504dbe26d680e8ab16
Author: Krzysztof Halasa <khc@pm.waw.pl>
Date:   Sat Jan 27 12:29:31 2007 -0800

    Don't zero out mode structure after setting name field.
    
    Instead of using memset to zero the structure (at the wrong time, no less),
    use xcalloc to gather pre-initialized memory.

commit 7a5f17087bda2833e84fa7e7ff0cb168943b89b6
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sat Jan 27 00:11:21 2007 -0800

    Mark crtc region as damaged when rotation is set.
    
    When shadow frame buffer is allocated for rotation, it needs to be
    initialized by copying from the frame buffer. Do this by simply marking the
    entire screen as damaged which will force an update.

commit 2d95cb6f041653f7e530b1f32cf007929c23ef3b
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sat Jan 27 00:04:13 2007 -0800

    Make rotated pixmap size of mode, not rotated mode. Update only damage.
    
    Rotated pixmap should match size of displayed mode, not the rotated version
    of that size.
    
    Take damaged region, rotate each box and display them instead of displaying
    the whole screen after each damage update. This exposes a bug where the
    screen is not correctly damaged after rotation.

commit 5c1e27cdd243dc24dd2bfdeb46d757bbef6ba6af
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 25 15:31:22 2007 -0800

    Make rotated shadow buffer allocation dynamic.
    
    For EXA, this requires version 2.1 of EXA to do rotation, as the VT switching
    issues were too complicated otherwise.

commit 5a67f3d3690903a181ca854d060cfa8b4c2aca26
Merge: 3cc583e... 9811059...
Author: Nian Wu <nian.wu@intel.com>
Date:   Thu Jan 25 13:40:50 2007 -0800

    Merge branch 'crestline' of /git/xorg/driver/xf86-video-intel into crestline

commit 3cc583ec8e79ec65103308220dd6047a4a7acddf
Merge: 566e1d3... effe579...
Author: Nian Wu <nian.wu@intel.com>
Date:   Thu Jan 25 13:37:05 2007 -0800

    Merge branch 'modesetting' of git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into crestline

commit 6d549ed280d3fcf3fe611b095d9f8adc0196bfb6
Merge: 75f4df2... effe579...
Author: Nian Wu <nian.wu@intel.com>
Date:   Thu Jan 25 13:36:33 2007 -0800

    Merge branch 'modesetting' of git://proxy01.pd.intel.com:9419/git/xorg/driver/xf86-video-intel into modesetting
    
    Conflicts:
    
    	src/i830_driver.c

commit 83cc4601b27d871484a2408f31154e9387064b9e
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 24 16:52:22 2007 +0800

    Fix a possible failure to misalign video allocation in XAA.

commit e21332419581eff1d7651741bae0b640c84d0ecd
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 24 12:32:38 2007 +0800

    Warning fix.

commit effe579e691b044e3ce59b41b5c0eaaac4368dda
Author: Dave Airlie <airlied@linux.ie>
Date:   Sun Jan 21 20:23:13 2007 +1100

    ch7xxx: fix output detection as per datasheet, have no DVI to test this.

commit c68dae2705d6e5b05dba7d40b6da112b98b926b4
Author: Dave Airlie <airlied@linux.ie>
Date:   Sun Jan 21 20:22:39 2007 +1100

    fix building with 7.1 server by hiding stuff inside RANDR_12_INTERFACE

commit 8eb861fb61fda78e6c142ffa66c586357aaa2e44
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jan 22 15:50:14 2007 +0800

    Replace the custom SaveScreen function with a generic function calling DPMS.
    
    With this, additional power saving occurs with the core screensaver, for
    example by turning off LVDS backlight.

commit 7161e824e89a6a69f1277e510f2344ad31721f62
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Jan 19 15:15:19 2007 +0800

    Fix DRI issue when EXA enabled
    
    tell DRI we are smashing the context state.

commit 74ebff6732b9bfcf8c865b52cbebfd9bf6b73eb2
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 18 14:26:21 2007 -0800

    Allocate separate cursor memory per CRTC and rotate cursors appropriately.
    
    Also, add bind/unbind of the shadow rotate buffers, which was missed in a
    previous commit.

commit 8759f4d89a141f7d69f1894ec3059ba6bd1cf86b
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 18 13:13:25 2007 -0800

    Partially deal with cursor rotation.
    
    The remaining issue is having a cursor image per CRTC so that the cursors can
    be rotated on the independently rotated CRTCs.

commit b296cd9b8f63ab80e8fe46fcfcdba2e9af846468
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 18 13:02:26 2007 -0800

    Fix transformation matrices for rotation at 90 and 270 degrees.

commit d2ae2e2ccc3a8e7dc84745c235836cba150754d8
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 18 11:37:14 2007 -0800

    Update CRTC values first so they can be used by the driver in mode setting.
    
    With this, the screen now gets rotated, though there are major issues.

commit 92b0f3d2013c32d94fe57fe674da1b195288f347
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 18 11:23:22 2007 -0800

    Disable the clipping for now, since it won't work.

commit 14d265a02312e9cda7a21614d77525c7140c0ca8
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 18 11:21:58 2007 -0800

    Store fixed values, not integers, in the transformation matrix.
    
    Also, add a bit more error checking.

commit cc09dc3efe7279bf67512babb0f6cdaeba654772
Merge: 53e765d... 3094100...
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 18 10:20:36 2007 -0800

    Merge branch 'modesetting' into modesetting-rotation

commit 53e765d1cf5016961c25a798a27f0fe09bd1f237
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 17 16:56:06 2007 -0800

    Fix broken last-minute change in determining whether we're rotated or not.

commit f256243fff195f73bc8aa72e8dd2c6f7b33446cf
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 17 16:01:18 2007 -0800

    Allocate per-crtc rotation buffers and hook up RandR 1.2 per-CRTC rotation.
    
    It currently displays garbage.

commit d17c386aee55bd223297adf78cf0fc1db43baf2d
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 17 15:49:08 2007 -0800

    Fix some segfaults: crtc->rotatedPixmap not set and dangling damage pointer.

commit 67a152c43cb7231695b99030c952c52d4edd1e65
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 17 14:35:31 2007 -0800

    Set all CRTCs' allowable rotations when xf86RandR12SetRotations() is called.

commit 98110591001dfaf2b8b5ac440bea0c38456da718
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Wed Jan 17 10:45:59 2007 +0800

      enable all TV modes

commit 3094100cdd04560af1b098bbe8024ae5270a10f4
Author: Gary Wong <gtw@gnu.org>
Date:   Tue Jan 16 13:25:24 2007 -0800

    Bug #9550: Add a quirk for too-high clock from EDID on the EN-7100e.

commit 66c6427cc83e5e381932b0c10743cba4cb9ac883
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Jan 16 12:54:29 2007 -0800

    Add a settable backlight property for LVDS.
    
    This extends the output funcs to have a callback for when it's time to
    configure properties, and another for when the server has changed a property
    whose value isn't pending a mode set. (Pending properties are to be picked up
    by the driver at mode_set time).

commit a52df90ffcb19e7c0a3b8018db3cd1391a3ec343
Merge: 37946c9... 45696aa...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue Jan 16 12:20:26 2007 +1100

    Merge branch 'modesetting' into modesetting-rotation
    
    Conflicts:
    
    	src/i830_driver.c
    	src/i830_randr.c
    
    Just a few sync changes.

commit 37946c9c8a4afa4a4fc1fe9864a8eec1c4571d2c
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue Jan 16 12:14:55 2007 +1100

    Interim work on rotation support with new xf86 code.
    
    Yes, there are lots of bits tied together here, and we should split this
    patch apart.
    
    Move I830 mode setting to xf86 mode setting.
    
    Make mode setting function also set the base address. This should fix
    problems where the base gets set incorrectly at times.
    
    Add driver-independent rotation support, requires driver-specific hooks for
    shadow pixmap allocation, otherwise it uses Render for painting.

commit 9a5106401a65c90df32cb71987fca7126dc22e81
Author: Emilio Scalise <emisca.ml@gmail.com>
Date:   Mon Jan 15 17:22:27 2007 +0000

    patch to control mergedfb options, bug #9664

commit bfeda3bfc59d309772398f688d29452ba97f3973
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Jan 15 08:05:32 2007 +1100

    Convert I830PipeSetMode to xf86CrtcSetMode. Add rotation structures.
    
    Makes the mode setting logic device independent.
    Magic rename hooks allow multiple drivers to provide the
    generic code without name conflicts.
    Rotation code requires special pixmap creation hook, and uses
    Render to perform the actual rotation.

commit 319be199ba657d2b82ba034edf3581aea6dcc3f0
Author: root <root@jetpack.demon.co.uk>
Date:   Sat Jan 13 21:34:00 2007 +0000

    Tweak to bug #9639

commit 85de57947570de6b3dc9197647be3e9237480880
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Sat Jan 13 19:18:24 2007 +0000

    Fix bug #9639, i810 XvMC needs linking against libdrm.

commit 45696aa29124e2852f94880642e70bb2e0cee827
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 4 12:34:47 2007 -0800

    EXA: Use PRIM3D_RECTLIST instead of TRIFAN so we don't get diagonal tearing.
    
    A side effect is the reduction in vertex dispatch, which is nice.

commit 6874a6f25ac87783d3770f77b9192e2d36d083a3
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 11 12:34:38 2007 -0800

    Restore legacy overlay size limits, due to card hangs at larger sizes.

commit c288aea40775a9cf561fda9912187c3cb5baa419
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 11 10:39:00 2007 -0800

    Bug #8845: Unify all our XV ports to 1920x1088 maximum size.
    
    This increases the "legacy" size, but that was checked against the 845
    documentation which claims support for 2048x2048 as well.  It decreases the
    textured video size, which was running into the limits of the bigrequests
    extension.  The new limits should fit within bigrequests while still supporting
    HD videos.

commit f5d528f8ea27de31054e7f1843e34d8379f811ea
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 11 10:36:33 2007 -0800

    Don't limit cachelines to a vertical of 2048, and increase default allocation.
    
    The cachelines are used for two things: XAA pixmap cache and XV memory.
    Only XAA pixmap cache is referred to using an offset pointing at the
    beginning of the front buffer in rendering, and XAA only uses the 2d BLT
    engine, which actually has a vertical limit of 65536.  So, pixmap cache is now
    limited to that much vertical.
    
    Additionally, the previous cachelines allocation was too small for our
    advertised XV limits, so video at the limits would fail with BadAlloc.  Now,
    XAA allocates the same approximate amount of offscreen memory as EXA:
    3 times the screen size, plus one packed HD video.

commit d13bc016c0723f1df633ddaf5610ad73003b7c96
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Jan 10 15:06:56 2007 -0800

    Correct x/y/pitch limitations in several cases, and detail them in i830_exa.c.
    
    This reduces max framebuffer width and increases max framebuffer height on
    965, reduces max X/Y on pre-965 EXA (could have caused mis-rendering), and
    increases max X/Y on 965 EXA (would have prevented acceleration).

commit fa383289ac8a6dd1cb359e6f1991cc42beb6ff02
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Jan 4 14:12:45 2007 -0800

    EXA: Wait for sync before we set up new state in our static state buffers.

commit 5857b4a1693085b8b42dd9560a7c4f5c3c82f862
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Jan 10 15:09:47 2007 +0800

    Formalize sync interface
    
    We should just call i830MarkSync/i830WaitSync in places we need,
    which care for both XAA and EXA.

commit efb75f56053ee06f1dbd4edfaea9986b27162afb
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jan 9 14:05:43 2007 +0000

    Bump to 1.7.4

commit 33c0fac6d63d9a509a24c7a5e5a46a0d6ee4dc5d
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jan 9 14:02:47 2007 +0000

    Fix bug #8536, i915 BIOS fails when restarting Xserver.

commit ee52c0ec4e95fa6e5f35c9cd75005a0c0003fd97
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Jan 8 16:53:07 2007 -0800

    Correct typo resulting in a crash with ivch.  = != ==.

commit 566e1d397744d0b477de4da6a206919906176f49
Merge: b13d638... da6a00f...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Jan 8 12:37:49 2007 -0800

    Merge branch 'modesetting' into crestline

commit da6a00f787e4d13e6b75768c1976f1c44ae5bf72
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Jan 8 12:36:54 2007 -0800

    Move EXA function declarations from source to header.
    
    Several new global functions were not put into the header file leading to
    potential mismatches between declaration and definition.

commit 66546d8a8006e1c828e18ccab850214fd8d56b63
Merge: 0fd2752... 40af0ee...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Jan 8 10:14:24 2007 -0800

    Merge branch 'modesetting-origin' into modesetting

commit b13d6386dfb3a00bd9d21ac0695cdce9f812d1f3
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Jan 7 22:56:37 2007 -0800

    Back out rotation changes for RandR 1.2 which won't work.
    
    RandR 1.2 requires a new rotation structure for per-CRTC rotation.

commit 7473e7d5297f94164e0f35822166713fb21a11bd
Merge: cdde9e7... a87801f...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Jan 7 22:50:27 2007 -0800

    Merge branch 'crestline-otc' into crestline

commit cdde9e7f4a0645ab1ee3e124de54433c1a250097
Merge: 3110630... 0fd2752...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Jan 7 22:50:12 2007 -0800

    Merge branch 'modesetting' into crestline

commit 0fd2752f199928f846fe03c9087f7b6d48cc28d9
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Jan 4 14:35:55 2007 +0800

    minor fix on last exa mem binding commit

commit 3110630e04f37e184609c91494fa7f9f4d59b93f
Merge: be9b635... 736d82a...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Jan 7 22:44:36 2007 -0800

    Merge branch 'modesetting' into crestline
    
    Conflicts:
    
    	src/i830_rotate.c
    
    Pull in upstream changes to crestline branch leaving only
    the PCI-IDs as local changes.

commit 40af0ee6ba4ab7596fbc7fcc3ad04d109746ca6f
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Sat Jan 6 18:19:34 2007 -0800

    Numerous symbol scope issues.
    
    I830EntityIndex is shared between 810 and newer driver.
    Move most EXA rendering state into I830 structure.
    Declare shared variables in shared header files rather than .c.

commit 736d82a6b43f174cb95b425faacd4b0b889916fa
Merge: 53b42f5... 4c790f6...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Dec 4 15:48:04 2006 +0800

    Merge branch 'modesetting-origin' into modesetting

commit 53b42f5bc7a58d02106436486e5bb56e56dbbfa1
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Sat Jan 6 14:59:14 2007 -0800

    support NTSC 480i M-J, PAL 576i for 640x480-1280x1024 sizes
    
    I still have problem with non-interlace mode and Hi Res mode.
    also I don't know how to pickup those mode in xorg.conf

commit 71946bcdc3c68c220996afac944698eea1974a36
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Jan 3 22:37:32 2007 -0800

    [PATCH] Add rotation support for 965.

commit 35cebed70827999812f8343ac97ad0dffda20786
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 16 15:12:43 2006 -0800

    [PATCH] Replace broken PCI resource size detection with pciGetBaseSize() call.
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 33e912aca08fa11ef588eb386e16ba5f9ea13727
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Jan 4 11:25:31 2007 +0800

    [PATCH] Fix EXA mem binding
    
    We should check if EXA is really enabled.
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit fa54a3c08301e59558ab0493b3d22324f4162496
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Dec 6 13:24:44 2006 +0800

    [PATCH] fix Makefile.am
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 2f2c443e971faa54ffcf751b6acb444e8e7875ce
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Dec 6 10:43:29 2006 +0800

    [PATCH] Formats fixes
    
    We should use card_fmt for src/mask picture, and use dest color
    buffer format helper. Also fix wrong name for G965 texture formats,
    and pict_x1r5g5b5 isn't supported by sampler engine.
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 0bf04fe78a8a915310ef8a90f5c7872be7476e2e
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Dec 4 15:48:04 2006 +0800

    [PATCH] set correct default border color
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 5c461063cde68092e778c44ac6abd9129cd8019e
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Dec 4 15:47:31 2006 +0800

    [PATCH] fix typo in ps kernel
    
    fix corrupt in some subspans
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 89a42d489bd370b89e5ff4e01f026b4d64723cd8
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 17:16:46 2006 +0800

    [PATCH] shut up warning
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 01bfa4fa6fc0ceec8581676e5d72c68dd71efa96
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 17:14:55 2006 +0800

    [PATCH] fix alpha blending state
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 79018bb47c43510d59c592592f06204189bd12dc
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 17:05:32 2006 +0800

    [PATCH] Add in sf/wm program for mask picture without CA
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit a5b9b438469f171b002fa0b99d8cab83e51ec968
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:52:44 2006 +0800

    [PATCH] misc cleanup for G965 vs/sf/wm states
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit b7c1e1656f45e43ea2f9a47f1a487050c0884c22
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:40:15 2006 +0800

    [PATCH] WM kernel needs scratch space
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit db9cfaa35adaf79ea57bc06b27c7e37935d3e1a7
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:37:06 2006 +0800

    [PATCH] Setup default border color for our samplers
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 70276e4e9a8a5026ec436d2be5bf5eab868aa178
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:30:53 2006 +0800

    [PATCH] fix vertex buffer size
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit e8a4cbdeff4125e28d807d0a563efc0606d21a75
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:24:24 2006 +0800

    [PATCH] clean up issue cmd to ring buffer
    
    Make it easy to track different part of ring state, and
    use rectlist primitive instead.
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 42534474fd2556e5987205626cca8f30e25855a8
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:04:16 2006 +0800

    [PATCH] remove wrong scale_units
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 05e8a7989db1b8b9dfa7b688629af65d9910cc53
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:02:16 2006 +0800

    [PATCH] Rename exa sf/wm program files
    
    Also fix some minors in wm program.
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 1329c86f2a4b3664920ded970a984a745a530da4
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 15:47:19 2006 +0800

    [PATCH] EXA state mem for G965
    
    Not split offscreen mem for exa, but alloc a dedicated one
    for G965 states.
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 4c790f614ecba1f6468e51779cfaf0e36b6b17ad
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Sat Jan 6 08:21:36 2007 -0800

    More sparse cleanups:
      NULL vs. 0
      make some variables static
      remove redundant variables
    
    There are only a few sparse warnings left now: some bitfield warnings
    and a few 'mixing code and declarations' warnings from the ring macros.

commit a87801f73a73e53524237be7835b8cd8b3eb282c
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Jan 4 14:47:48 2007 +0800

    Fix TV load detect
    
    Actually load TV, otherwise we don't have expected
    reg state to probe.

commit 9cf759a2cb2580c4ac5f8cdc983389642f3cfce0
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Jan 4 14:35:55 2007 +0800

    minor fix on last exa mem binding commit

commit f9c3ef40100acb85fca6e49c5c0e98f5c9ac97ca
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Oct 10 15:50:10 2006 +0800

    [PATCH] Mark current ps kernel is experimential with little test.
    
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit ef2f25e5c6ce04c202698c5122bc8627130073c0
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Oct 10 14:11:35 2006 +0800

    [PATCH] Use sf_prog.h instead
    
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit ca608028c5301700444d39a1c631cc0d5648e1a2
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Sep 28 13:55:52 2006 +0800

    [PATCH] Fix picture's transform checking
    
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 848368d5d0b90e03d3ec447cb5bd39fc87aea8df
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Sep 28 11:15:33 2006 +0800

    [PATCH] Fallback in mask picture for now
    
    Do it later after finish wm kernel program.
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit df23624eebe938fa444c80cbedcd61919ec1aeda
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Sep 28 11:09:52 2006 +0800

    [PATCH] Fix compile, add wm header file.
    
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit fc944859b1b9605c748162bad1c93a6303c84aae
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Sep 28 10:36:00 2006 +0800

    [PATCH] Add simplest wm kernel program for no mask picture composite
    
    This is a try to use new gen4asm language, and will finish
    composite program for mask picture with or without CA case later.
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit acdc2da77b445e9347a4c6e53e35c81763cbb0b8
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Sep 27 16:48:43 2006 +0800

    [PATCH] Add mask sampler state
    
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit 926d7fb09aaaabf050949ce7c6127c68441c8801
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Sep 27 13:54:14 2006 +0800

    [PATCH] change some src sampler states
    
    sampler for mask should also be set up, and fix
    default border texel.
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit ed73bbaf5c2e9d555c884037a249cf03e7f60fa0
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Sep 25 14:35:51 2006 +0800

    [PATCH] Add file for i965 exa composite
    
    This does not include ps program, which will be added
    in g4a form.
    
    Signed-off-by: Keith Packard <keithp@neko.keithp.com>

commit be9b635b82c0c77ccc0555f178f94de6e5338e27
Merge: 9e48808... 5a793b0...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Jan 3 22:15:53 2007 -0800

    Merge branch 'modesetting' into crestline

commit 5a793b0dcf2d5de408b55073858fcfba6d99f994
Merge: f188525... 394124c...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Jan 3 21:54:05 2007 -0800

    Merge branch 'modesetting-origin' into modesetting

commit f188525030a8fac59e41520449b1aec9b123e4ea
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Jan 3 21:53:07 2007 -0800

    Add interlace defines for pipeconf regs

commit 9e48808fccf5b153c2fb4027f9a09944574fdace
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Jan 4 11:25:31 2007 +0800

    Fix EXA mem binding
    
    We should check if EXA is really enabled.

commit ebd636dbd62cb69ed7defbd86f297c6bc7dac5dd
Merge: 75f0033... 3d9ea6f...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Jan 4 10:13:55 2007 +0800

    Merge branch 'modesetting' into crestline
    
    Conflicts:
    
    	src/i830.h
    	src/i830_randr.c

commit 3d9ea6f3c8a274f930d286fc15d3665dfaa8327a
Merge: 75f4df2... 394124c...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Jan 4 10:12:50 2007 +0800

    Merge branch 'modesetting' of git+ssh://zhen@git.freedesktop.org/git/xorg/driver/xf86-video-intel into modesetting
    
    Conflicts:
    
    	src/i830_driver.c

commit 394124ceaadb46d976ad5c3bdeb1b77d351c57f6
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Jan 2 16:57:33 2007 -0800

    Add per-CRTC gamma control support for RandR.
    
    This makes the CRTCs now always run in gamma-enabled mode, rather than having
    flaky logic for switching modes.  Also, it should clear up issues with the LUTs
    being uninitialized when outputs are first brought up.

commit 69f250af60220a875f4a04c6d682bffa352281e4
Merge: 232e209... d960dea...
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Wed Jan 3 00:39:15 2007 -0800

    Merge branch 'modesetting-origin' into modesetting

commit 232e2094321dbcdd6a67ef230eb50494a1c7d6df
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Wed Jan 3 00:38:34 2007 -0800

    Allow initial position to be set in config file. Increase 965 max size.
    
    Add relative and absolute position configuration code, using per-output
    monitor sections. Options include:
    
    	PreferredMode	selects a preferred mode for this output by name
    	Position	absolute position, x and y in a single string.
    
    	Below		relative positions; argument names other monitor.
    	RightOf
    	Above
    	LeftOf
    
    	Enable		force the monitor to be disabled by setting
    	Disable		enable to no or disable to yes.
    
    	MinClock	Set valid clock ranges
    	MaxClock
    
    Monitor sections can also include sync ranges, physical size and mode lines
    as documented in xorg.conf(5).
    
    Monitors are associated with outputs through options in the Device section:
    
    	Option "monitor-VGA" "My VGA Monitor"
    
    Output named 'VGA' will use monitor section "My VGA Monitor".

commit 58e797b2caa6effa5455fc1f13dc4c58d0658744
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Wed Jan 3 00:04:58 2007 -0800

    Sync dspbase/dspsurf registers by re-reading them.
    
    This seems to eliminate base/surf value confusion during EnterVT.

commit d960deab39eef91fb82b9f23118323aeb4c9c63e
Author: Jesse Barnes <jbarnes@nietzche.virtuousgeek.org>
Date:   Tue Jan 2 20:23:37 2007 -0800

      Various sparse cleanups:
        NULL vs. 0
        remove redundant pScrn in I830DRISwapContext
        make I830DRISwapContext static

commit 5057769d3a7c1b3a94f49bbff47b9697f368d975
Author: Dave Airlie <airlied@linux.ie>
Date:   Tue Jan 2 19:25:08 2007 -0800

    Use correct variable to initialize DVO I2C bus.
    
    intel_output->pI2CBus isn't initialized until the output is all happy and
    running, so using it before that is rather unlikely to do much good.

commit 2bb9bb951e664d704bdf7a808edbe8b2f50c4366
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue Jan 2 14:04:10 2007 -0800

    Typo disabled new DRI MM on all chips.
    
    Detection for new DRI MM wasn't converted to #define correctly because of a
    typo.

commit 5080307230d534b84090bfefc13ac437d53f915d
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Tue Jan 2 00:16:41 2007 -0800

    Fix driver to build on RandR 1.2 systems again.
    
    Changes to move initial config code to RandR 1.1/1.2 common path broke
    code required only for RandR 1.2.

commit 237847007afb5a429a50b6aa0b1acc239326571b
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Tue Jan 2 00:09:35 2007 -0800

    Make driver build and run on Xorg 7.1. Delay DSP*BASE setting until last.
    
    Autodetect libdrm version, disable new memory manager on older libraries.
    Move new M_T_ defines from i830.h to i830_xf86Crtc.h. Add many system
    headers to define functions. Use i830PipeSetBase at end of mode setting
    code to set DSP*BASE and flush changes. Don't duplicate PipeSetBase call
    from screen init function. Make initial RandR configuration code usable on
    older versions of extension so the server doesn't start in a panning mode.
    Use xfree instead of free in i830_tv.c.

commit 25d5a892319b02dc6eb81390dea29cd88a1e7da4
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sun Dec 31 15:39:20 2006 -0800

    Elide identical modes from reported list.
    
    Where two modes would produce precisely the same crtc settings and have the
    same name, remove the latter mode from the mode list.

commit feeefc92e450e9de58da51147325300ffabd2059
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Dec 31 14:22:53 2006 -0800

    Replace author-specific license with generic license.
    
    This file retained the old MIT license with the embedded author name.
    Replace that with the version that uses generic 'copyright holders' instead.

commit 5e456251f0d6c8bef3241267f6c1b3bca4670c0d
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Dec 31 14:21:12 2006 -0800

    Replace author-specific license with generic license.
    
    This file retained the old MIT license with the embedded author name.
    Replace that with the version that uses generic 'copyright holders' instead.

commit 75f0033ec41a34bbe695cfd4a9bc9aa60e919c99
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Sun Dec 31 15:16:59 2006 +0800

    Issue current virtual size to mode valid.
    
    Revert change in rotation patch.

commit 2330b341c925e60bc2c991b4ca8450badbc459a4
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Dec 30 22:47:58 2006 -0800

    Prune default modes to EDID clock limit.
    
    Pick out the EDID max clock value and use that to elide default modes which
    are too fast.

commit c70e7bc701cba3092acfdd66ed4d63487ac8ff9f
Merge: 8b6c456... 4ed79a2...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Dec 30 21:58:36 2006 -0800

    Merge branch 'modesetting-origin' into modesetting

commit 8b6c456e16c81f719bb68178e3e4d26f4108a9c2
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Dec 30 21:57:42 2006 -0800

    Detect in ProbeModes. Let get_modes set edid. Prune interlace/dblscan.
    
    Move output connection status detection from RandR code up to ProbeModes so
    it is done before mode sets are built. Otherwise, the mode building code
    will elide all modes the first time through as it ignores outputs that are
    disconnected.
    
    Most get_modes functions fetch EDID data; make sure that any
    EDID changes are used in the ProbeModes filtering of default modes.
    Otherwise, stale EDID data will be used.
    
    Allow outputs to advertise support for interlaced and double scan modes;
    prune such modes from the default mode list when outputs do not support them.

commit 4ed79a2ba6250354ffc24fa1f7a21ca914ad157e
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Dec 29 12:19:41 2006 -0800

    Relax tiling requirements on G965.
    
    For the 965, we can tile with the pitch at any integer multiple of a tile size
    (128 or 512B), up to 128KB.

commit b8692e646227e56c9ae4f72b9aaa75457b4c0f5f
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Dec 28 22:23:16 2006 -0800

    Lack of configured monitor implies no configured modes.
    
    Missing check for missing monitor configuration would result in segfault.

commit 973da654219ea43916b0b44acfa09a415bed3d7a
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Dec 28 22:22:22 2006 -0800

    Sync ranges from EDID/default should not limit configured modelines.
    
    Limit the effect of sync ranges so that sync ranges found via EDID will not
    eliminate modes explicitly added by the user. Limit default sync range to
    eliminating only default modes, not configured or EDID modes.

commit f7b1d4c1f7d17a811e17c6a17861ff70be9fbdd7
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Dec 28 22:18:57 2006 -0800

    Belinea 10 15 55 monitor quirk - override preferred mode with largest @60Hz
    
    Belinea 10 15 55 model monitor reports a preferred mode of 640x350, when in
    fact it wants a 1024x768 mode @ 60Hz. Add an edid quirk that selects the
    largest size mode, preferring those closer to 60hz among equal sized modes.

commit fbd3f588f0d412c20cc3f86dfad73700734a9a76
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Dec 29 10:47:52 2006 +0800

    rotation support for randr-1.2
    
    This patch trys to resolve rotation regression with randr-1.2.
    Tested with Crestline VGA output. See bug 83.

commit a1796bfb51d90fd545973909404e1a77ad27c9cc
Merge: 84915ac... fabfccd...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Dec 29 10:10:26 2006 +0800

    Merge branch 'crestline' of git+ssh://zhen@otc-graphics.jf.intel.com/git/xorg/driver/xf86-video-intel into crestline

commit bedab1654e2dfcf7800bd0101e6991800a544019
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Dec 28 16:34:40 2006 -0800

    Remove 8MB/32MB default VideoRam limits.
    
    With modern monitors and increased XV and EXA memory requirements, these small
    limits were resulting in DRI and other initialization failures because we
    wouldn't allow them enough memory.  Instead, allow each piece of the system
    (DRI, EXA, XAA, etc) to request as much memory as it wants, and choose the
    actual videoRam to be used for laying out the memory afterwards.
    
    With this change, in the absence of a VideoRam option, 32MB will be allocated
    for textures.

commit 4cc5dcf6d7423239f0181f246638366edcb8be87
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Dec 28 16:43:39 2006 -0800

    Oops, dont use symlinks for stolen xf86 header files

commit 86da0d05e4e338e7f4c841577002eb1ba9f6b2ac
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Dec 28 16:40:54 2006 -0800

    Add stolen xf86 header files to driver source

commit 2b0a997e5b4b51267fa4f6725f8a965093392434
Merge: bb238a8... 9cfbf1c...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Dec 28 16:34:38 2006 -0800

    Merge branch 'modesetting-origin' into modesetting

commit bb238a8fc234a8e5e86cd2f42c58c9816a15732c
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Dec 28 16:27:22 2006 -0800

    Configuration support: per-output mode lines, preferred mode.
    
    Add the modelines specified in the per-output monitor and all of the default
    modes to the list to each output. Prune the resulting list to specified sync
    limits and virtual sizes. Sort the resulting mode list on
    preferred/size/refresh.

commit 9cfbf1ceda8f153438df1ba4b1712c55cc872017
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Dec 28 12:59:23 2006 -0800

    In EXA mode, force backing pixmaps into memory when doing XV to them.

commit e889bde13dcc2438181a03319e204ae7b9235a78
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Dec 28 12:49:24 2006 -0800

    Draw textured video to the backing pixmap in the composited case.
    
    Currently, when the backing pixmap is not in framebuffer, we just BadAlloc
    rather than drawing garbage to the front buffer.  This can be fixed with EXA.

commit c7083a6f30fdf1859f60beba4c352bd790af4773
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Dec 28 11:53:33 2006 -0800

    Add WIP CH7017 LVDS driver.  This is disconnected because it's untested.

commit 778db49616b233f5a2f4f007ceb62a1a878a6e25
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Dec 28 11:36:15 2006 -0800

    Add WIP IVCH (i82807aa) driver.
    
    It is not currently hooked up as it hasn't been tested.  The hardware that this
    was written for decided to stop working.

commit 5806f670eb3a5171ffb0b75701640d5311b34c80
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Dec 21 16:22:14 2006 -0800

    Reformat the DVO drivers table to be a bit more normal style.

commit b928cef9cd5b3f88dc0880f406300d246a59e0fe
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Dec 21 16:21:28 2006 -0800

    Move dvo driver detection into i830_dvo_init(), and use GPIOB for LVDS drivers.
    
    The documentation states that GPIOB is (generally) used for devices on DVOA
    on the motherboard, which appears to be the case on the laptop we have with
    LVDS on the motherboard.
    
    This patch is probably not entirely accurate, as there was apparently an LVDS
    DVO card sold that could be put in desktop machines, which would likely be on
    GPIOE like other ADD cards.  Given that we couldn't find one of these cards for
    purchase, I'm not worrying about it.

commit fabfccd3d8a55a83138d361f66c53cb7e6d371a8
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Thu Dec 28 14:48:54 2006 +0800

      Fix

commit ddefce4f02eb3272ad37e890350f73f03eff73c9
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Thu Dec 28 14:45:53 2006 +0800

     support NTSC 480i M-J 1280x1024 1024x768 800x600 640x480
     PAL 576i 1280x1024 1024x768 800x600 640x480
    
     I still have problem with non-interlace mode and Hi Res mode.
     also I don't know how to pickup those mode in xorg.conf

commit c87462ded20904dbc6c6cbdb9547523b75fe5471
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 27 19:14:14 2006 -0800

    Remove the nasty #define away of ErrorF in i830_video.c.
    
    Every new person touching this file hits this trap, so it's now removed.

commit 6dc3387219b2b31e0c7dbaa88b568fbd54d72878
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 27 18:58:40 2006 -0800

    Fix operator precedence issue that stuck 965 t-v state into the front buffer.

commit 210f30bd75529d0064bc46af15464a2a47f9d4c6
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 27 18:57:50 2006 -0800

    debugging for location of various 965 textured-video state.

commit 82738e60769a4798d7425ffc67882d1f74043b76
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 27 18:35:35 2006 -0800

    Fix discrepancy between XAA/EXA linear allocations that broke EXA XV.
    
    The XAA allocator returned an offset from the beginning of the frontbuffer
    allocation (where the linear allocations come from), while EXA returned one
    from the start of framebuffer.  Now, both of them use the start of framebuffer
    as the reference.

commit 8165e043670f6a7fee5e7e8f33644adda5757591
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 27 18:17:37 2006 -0800

    Bump the size of the extra space for 965 so it actually fits.

commit f830c55e5f4efc97451240f8f18b49f46e8bce0f
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 27 18:14:59 2006 -0800

    Make the assert() in i965_video.c actually work and expose an error.

commit a75b416c91085df1db4027a25eafcd04fef1e57c
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 27 17:58:57 2006 -0800

    Replace XAA mark/waitsyncs with the XAA/EXA wrappers.

commit 150010d2f20f4a57f8507eba8762e36966b0f426
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 27 17:57:34 2006 -0800

    reformat i965_video.c to 4-space indents, 80 columns, no trailing whitespace.

commit 05066632b068ae91d7be77e3a199ea0d337d975b
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 27 17:41:45 2006 -0800

    Move 965 textured-video out to a separate file.

commit 46df75ccd4647ea033583130253a2a2218b34a20
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 27 13:45:06 2006 -0800

    Bug #7524: Major improvements to EXA/XAA static memory allocation.
    
    With this, we no longer allocate XV through the XF86 linear allocator in the
    EXA case.  We also no longer allocate extra space for the XF86 2D allocator
    that we don't use in EXA mode, or space for the EXA allocator in XAA mode.
    The EXA offscreen allocator now gets enough space for several screenfuls of
    pixmaps plus one 1920x1088 movie.
    
    A large duplicated section of code for allocating each framebuffer in the old
    dual-screen mode was also factored out.

commit 84915ac8afeb4bbc03df8f94ab3ba351788d6501
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Dec 21 23:42:53 2006 -0800

    If DDC detailed modes are missing physical size, pull from features.
    
    Monitors without detailed modes, or those which do not bother to set a
    physical size in their detailed modes may still have physical size in the
    global data.

commit 1e9105395a7900521206b28bae4bb4f85669a0cd
Merge: df9ecf8... c237e93...
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Dec 21 23:34:30 2006 -0800

    Merge branch 'modesetting-origin' into modesetting

commit df9ecf8ab93f0aeffde11d438513d41220ba75cb
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Dec 21 23:32:35 2006 -0800

    Change belinea edid quirk to cover the 10 20 30W model as well.
    
    This larger model reported different (but still incorrect)
    sync polarities, so instead of flipping them, just set them to the right
    value.

commit c237e930615f1b048895efe988d28503f5d67c37
Author: Keith Packard <keithp@ukulele.keithp.com>
Date:   Thu Dec 21 23:30:37 2006 -0800

    Use Vesa DDC timeouts for all I2C busses.
    
    The default I2C timeouts are very short, and while most
    modern monitors have no trouble responding at that rate,
    some older ones cannot manage.

commit d8c5dba4d797fc50d7b2b5855f34e2d2e2ad3e4f
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Dec 21 21:20:43 2006 -0800

    When cleaning duplicate modes, make sure ->Last is reset correctly.
    
    When removing the very last mode for a monitor, move the ->Last pointer to
    the previous list element.

commit fab9a6b6210daea423b609208ef57fa26571f5d3
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Dec 21 21:19:32 2006 -0800

    Add EDID quirk support for broken EDID data.
    
    For EDID with known errors, add a quirk mechanism to automatically
    compensate. The first quirk is for a Belinea 1440x900 monitor which
    incorrectly specifies sync polarities in the detailed mode.

commit d9b27667e6cc6c7e171b0f513d40be7658cf4574
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Dec 21 21:17:03 2006 -0800

    PLL computations missed one possible 'm2' value.
    
    m2 was ranging from min <= m2 < max instead of <= max resulting in
    inaccurate PLL frequencies for some modes.

commit c5205595f2abacc9f736e1f53666302ec551cbc4
Merge: b8f3ec7... 4c0c1aa...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Dec 21 02:51:33 2006 -0800

    Merge branch 'modesetting' into crestline

commit 4c0c1aa882cfec77b2183baec93cbc4cfaf4abe0
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Dec 21 02:33:39 2006 -0800

    Computed corred color conversion values.
    
    Extract correct color conversion values for all video formats from
    documentation. Use those, with appropriate conversions, for the color
    conversion register values.

commit 98fd44d681220aa31200e4262f1a7ec952a09530
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Dec 21 01:24:24 2006 -0800

    TV subcarrier was computed from wrong clock value.
    
    The constants provided in the documentation for the subcarrier DDA values
    assumed the clock was programmed to precisely 108MHz, but the PLL can't hit
    that value exactly (or our PLL computation can't, in any case). The
    result was an incorrect subcarrier frequency which resulted in synthetic
    subcarrier phase shift and a lovely rainbow effect on the screen.
    
    Unfortunately, the documentation didn't exactly describe the function
    performed by the subcarrier clock hardware, so a bit of detective work was
    needed. New constants were computed using the code in tv.5c and those, along
    with lots of other values from the documentation were inserted into the
    necessary tables.
    
    The result appears to generate stable NTSC video on the svideo connector.

commit b8f3ec77104882fc755ddc88f2583cd5d15387a4
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Thu Dec 21 10:46:17 2006 +0800

      This fix should be better, I830SetMode will call i830_sdvo_dump,
      if the sdvo is not initialized, X will crash. So any application which
      SetMode will crash X if there is no SDVO output.

commit b83cbec34a8d1ff39bd303fcd27fc03dcdb1d6c3
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Wed Dec 20 17:32:05 2006 +0800

    fix null pointer reference,
    I hit this when running doom3-demo

commit 4ba72fc408e7fab7c384aff5e73f0cfb8fd86cf3
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Tue Dec 19 22:39:57 2006 -0800

    Reinitialize DGA mode list whenever we update the global list.
    
    DGA has a copy of the current mode list (yes, this is broken).
    Regenerate it whenever the ddx mode list changes.

commit 07d3f141712e2abf704cb68a59cd5d5c3390e2ca
Merge: 0cd1a11... c28075e...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue Dec 19 22:01:02 2006 -0800

    Merge branch 'modesetting' into crestline

commit c28075e1d70c98b39fc9829a6a01da171a9b9426
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Tue Dec 19 21:53:10 2006 -0800

    TV output I830OutputPrivate had wrong type (crashed in SetMode).
    
    TV output private type field was set to I830_OUTPUT_SDVO instead of
    I830_OUTPUT_TVOUT. When DGA mode setting occurred, the sdvo output debug
    code would be invoked and attempt to dereference sdvo-specific bits of the
    private structure leading to a segfault.

commit 2ef4c5e8f6444aad192304e5a2f7a0c77bfb917d
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Tue Dec 19 16:45:39 2006 -0800

    Re-initialize physical screen size only if -dpi was passed.
    
    Physical screen size from the config file or DDC will already
    be set correctly in the screen structure, unless it was computed from the
    virtual size using the -dpi command line option. Recompute physical size as
    we reset the screen size if the -dpi option was used.

commit b00951a5c87ca8c596ee9cc73d96d598eec60751
Merge: 05cd921... c0a0ddc...
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Tue Dec 19 16:22:04 2006 -0800

    Merge branch 'modesetting-origin' into modesetting

commit 05cd921140fae2746c3421715d7f18248a66735a
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Tue Dec 19 16:21:46 2006 -0800

    Align textured video dither matrix to window

commit c0a0ddc0ce69b60ac3a58d45cb32ccd0e0bfb0c9
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 19 16:06:13 2006 -0800

    Bug #9382: Save the CRTC's desired mode in the old RandR 1.0 mode set path.

commit 3c86fdda1d09fd22d4c15a8e412611db4cea7dcf
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Tue Dec 19 15:53:07 2006 -0800

    Turn on dithering for 915 textured video

commit 293ad158ece941eeb9894f5af4d663464b9954e5
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 19 14:35:51 2006 -0800

    Remove 8k framebuffer stride restriction on 965.
    
    Also, clean up the message if the limitation is hit.

commit ff1223142aedcf888665de6e4d7d5d03a55b2688
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 19 12:49:55 2006 -0800

    Only erase curMode in i830DisableUnusedFunctions when the CRTC is disabled.
    
    This bug resulted in broken xinerama, among other issues.

commit 3b5703c7fa08e63f2a31be7496ded9c70015946d
Author: Daniel Stone <daniel@fooishbar.org>
Date:   Tue Dec 19 09:49:49 2006 -0800

    Respect the srcdir.

commit d89e211b12ff715d7475421af69157b102accaca
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Dec 15 14:39:14 2006 -0800

    Disable configure-disabled outputs before mode setting.
    
    We're not supposed to turn off pipes/planes/dplls with outputs attached, which
    we could have done before this.

commit 3fc9feec7b29e0b908e3b90e0f6634117d66ba6d
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Dec 15 14:38:23 2006 -0800

    Simplify i830DisableUnusedFunctions() by using the CRTC dpms routines.

commit 7b8056e3e347b15b37be0116315d7d3a23aef99f
Author: Keith Packard <keithp@ukulele.keithp.com>
Date:   Tue Dec 19 01:32:54 2006 -0800

    Writing 1 to I2C line means to tristate the bus so others can manipulate it.
    
    We were forcing bus lines to 1 which was breaking DDC for some monitors.
    Instead, make the PutBits function just tristate when writing 1 bits.

commit 0cd1a11d4493ef4a2d05ccf8aadec743504dba5f
Author: Zou Nan hai <nanhai.zou@intel.com>
Date:   Tue Dec 19 14:03:19 2006 +0800

      fix for bug #108

commit eedef7adc53dd8337d27c02551c5778fb43bae05
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 18 15:57:44 2006 -0800

    Add a detect() function for DVO chips, and implement it on sil164.

commit 8983845f91cacf8110c70121e0f5f293fe443e6d
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 18 15:57:08 2006 -0800

    Fix crash in xf86SetScrnInfoModes when pScrn->modes ends up empty.

commit fa4642048b183134544fc5ee47558446d27f6194
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 18 15:32:35 2006 -0800

    Clean up i2c_vid interface, including de-StudlyCapsing and removing dead code.
    
    The old Init() function is removed and the previous Detect() function is now
    init().  This leaves us room in the namespace for a detect() like other
    outputs have ("is the monitor connected?").  Also, Power() became dpms(),
    taking a DPMSMode*.  In general, the mode setting path now matches the intel
    internal path, except for the lack of mode_fixup().

commit dcb069a1da6b3300b0772843dd9b67efdf319637
Author: Dave Airlie <airlied@linux.ie>
Date:   Tue Dec 19 10:29:56 2006 +1100

    ch7xxx: add lookup table for name
    
    Don't load if we don't match name

commit 0305298405bd7018e5c520bdd5ea46a75be09f37
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 18 14:49:01 2006 -0800

    Limit modes to 165Mhz on CH7009, according to spec.

commit 23114fbccad849249b4b7200e3d085a9ac0e2e99
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 18 14:47:44 2006 -0800

    Align the driver to the CH7009[AB] spec.
    
    With this, the driver works at 640x480 and 1280x1024 on my panel.

commit 633d718f6fb019844304228a81c84a8605da004f
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 18 13:59:17 2006 -0800

    Clean up a bunch of log noise from ch7xxx startup.

commit 3167bc6b24bd74c50ca4c4d361b14aa24d77cfa3
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 18 13:45:55 2006 -0800

    Fix DVO mode valid function to not throw out all modes.

commit 4ca92da5b93b07f0bff51843f8fb5d04a2a29443
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 18 13:45:34 2006 -0800

    Add save/restore to ch7xxx to avoid segfaults on server start.

commit 31849edb3b503ade659981dfa36babf5ad8757c5
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 18 13:32:21 2006 -0800

    Move the ch7xxx code to the style I've been settling on for output code.

commit 1975fa5b010100196af201e40f43b30a149b7750
Author: Eamon Walsh <ewalsh@tycho.nsa.gov>
Date:   Mon Dec 18 14:08:55 2006 -0500

    Revert "Convert callers of LookupWindow() to dixLookupWindow()."
    
    This reverts commit 08575331ac75783c9910cfb6e78db701a29983ac.

commit 2d0ca2202cb0d780bb4387bbe04e5caa6512e3b1
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 18 10:37:33 2006 -0800

    Bug #8786: Treat pictures with no color data as non-component alpha.
    
    This is an un(der?)-documented part of the render protocol: If the mask is
    alpha only, then the component alpha flag is ignored on it.

commit 65cd18b97bc533b24031d6eb882fd3074779ceba
Merge: bf43f8c... 6823ca8...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Dec 17 17:32:24 2006 -0800

    Merge branch 'modesetting' into crestline

commit 6823ca87f3b1ef3b28ed167254dcfce2a80467df
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Sat Dec 16 21:12:47 2006 -0800

    Follow mode setting order in RestoreHWState.
    
    Add delays after output and CRTC disable. Restore panel fit register before
    PLLs are restarted. Move all VGA restore code last. Shuffle various register
    writes around and add delays to match PipeSetMode code.

commit 86558cc622b516b568cc26efdf9b64d4b660f50f
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Sat Dec 16 21:09:31 2006 -0800

    Prefer earliest CRTC when mapping to outputs.
    
    For some reason, the code was preferring the last possible output when
    mapping outputs to crtcs. Use the earlier CRTC instead to make the i830
    driver consistent with BIOS usage.

commit 8e6ab99b3195325f9fe5432725fe328591c0c7e2
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Sat Dec 16 21:06:36 2006 -0800

    Not restoring active outputs. Wait for input sync before enabling outputs.
    
    Oops--looks like a typo to me; the code was callint set_target_output
    instead of set_active_outputs.
    
    BIOS loops waiting for the SDVO input to sync before enabling outputs, this
    makes sense to me.

commit bffd611b0a1cb05868e0f93e6ff9357a3116eaa6
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Sat Dec 16 21:03:15 2006 -0800

    Follow BIOS order in writing DPLL/DPLL_MD registers.
    
    965 BIOS writes DPLL and then DPLL_MD.
    945 BIOS writes DPLL twice.

commit 9b1a1b170befae2e705c23ce295837d0d13b60c0
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Sat Dec 16 16:53:49 2006 -0800

    reorder restore writes for 965 VGA

commit 08575331ac75783c9910cfb6e78db701a29983ac
Author: Eamon Walsh <ewalsh@tycho.nsa.gov>
Date:   Fri Dec 15 17:44:44 2006 -0500

    Convert callers of LookupWindow() to dixLookupWindow().

commit 60411bc4d0b3c53850c73b7246d5f7ed5c2d4084
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Thu Dec 14 18:36:44 2006 -0800

    Follow BIOS PLL write protocol (disable,enable,enable).
    
    This gets VGA output and text restore working, but SDVO is still not working.

commit 082519f34b468d0c5aa08db74ff2b51cf411d743
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Thu Dec 14 16:51:48 2006 -0800

    Turn pll/pipe/plane on in crtc_set_mode
    
    Instead of delaying pll/pipe/plane enables to the dpms function, turn them
    on right away in the crtc_set_mode function. To avoid rewriting these
    registers in the subsequent dpms function, check each register written there
    to see if the enable bit is already on and don't rewrite.

commit 55e7a32096a58f7bb2380b04df6b3dd9dc8e5b6a
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Thu Dec 14 16:50:26 2006 -0800

    Respect Virtual in xorg.conf
    
    Instead of growing virtual to fit our desired sizes, if it is set in the
    config file, use the value as the virtual size and make the default
    configuration fit within that size (if possible).

commit d4142abc68888178a8f6c54fdcece91e898bc9f5
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Dec 14 13:49:08 2006 -0800

    Set frame buffer size ranges in xf86_config.
    
    Initialization and default configuration code needs to know the range of
    legitimate sizes for the frame buffer.

commit 2b5a5542ad7d1c558d1684a0a69b66bab6e9d001
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Dec 14 13:43:50 2006 -0800

    Change TV modes from Preferred to Driver.
    
    This avoids having the artificial TV mode size drive overall screen size.

commit 3fe802453a85183a69c36a098639895f49b17df1
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Wed Dec 13 13:15:14 2006 -0800

    Move xf86CrtcConfig to ScrnInfo private.
    
    Pull xf86CrtcConfig out of the driver private structure and allocate a
    ScrnInfo private index for it. Also, make the arrays of outputs and crtcs
    dynamic instead of fixed.

commit 0f6addc8a6aeb9bd041d0f8e8e5850e76764ba51
Merge: 001e272... 3fa5b39...
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Wed Dec 13 12:10:31 2006 -0800

    Merge branch 'modesetting-origin' into modesetting

commit 001e272437a0247ffbc4b9ff8a3f2b437cf4c533
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Wed Dec 13 12:08:58 2006 -0800

    Auto-detect working TV output by checking TV regs functionality.
    
    We can't figure out which chips are supposed to have TV out, so instead we
    prod the TV_DAC register to see if it will hold the value written to it, if
    not, we assume the chip doesn't have TV out.

commit 3fa5b3998353518c40e2fb0c28b425ee22c8d625
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 13 11:54:36 2006 -0800

    Add magic double-write of the dpll register to fix mac mini cold boot.

commit e27372e85a007d8a7e31678dbdb62755c22918bf
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 13 00:26:27 2006 -0800

    Add some caution with PCI write posting and DPLL delays to i830_crtc_dpms.
    
    While it doesn't specifically help/hurt my test case, we've seen enough
    mysterious behavior that caution is probably warranted.

commit df0a5a25aa72563a33731f8063602dd7faad8459
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Wed Dec 13 11:38:18 2006 -0800

    Rename outputs to TMDS-1/TMDS-2, LVDS, TV and VGA.
    
    These names are reasonably short and describe the connector rather than the
    target media, but we don't appear to have any way to determine what is on
    the other end of the wire. More importantly, they're all unique now.

commit e3604fc63243ab0f31673a923d20e23131b607f6
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Dec 13 15:42:53 2006 +0000

    Delete ChangeLog

commit 4cdcaac26b3f425ec8fcc2fd3eaa9bfb7a137422
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Tue Dec 12 23:26:00 2006 -0800

    Write dpll_md register while updating dpll as that appears to be required.
    
    SDVO multiplier on 965 is in the dpll_md register; for some reason, that
    needs to be written along with the dpll value or the multiplier doesn't get
    set correctly.

commit 9dd1520421dcb8c7f36a684f3d2ffb6b42a6671a
Merge: d57a258... 63bf484...
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Tue Dec 12 22:52:59 2006 -0800

    Merge branch 'modesetting-origin' into modesetting

commit d57a25815398ae83eae8bdcb3a1b607760aa30b6
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Tue Dec 12 22:48:21 2006 -0800

    Elide duplicate modes in pScrn->monitor.
    
    xf86DDCMonitorSet dumps all of the DDC-discovered modes
    into the monitor mode list without checking to see if they
    are already present. This provides an ever-changing list of
    modes for outputs which have no DDC and which simply duplicate the monitor
    mode list.

commit 63bf48481d4e5e285fdfe7037ea4150283163a54
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 12 22:42:41 2006 -0800

    Correct typo in mac mini hack, and return modes when the hack is unnecessary.

commit 41444183b59ed84c09749ca89afbef036d42ec5f
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 12 18:08:57 2006 -0800

    Replace custom, partially broken DPMS implementation with a generic one.

commit 7ed1b05922c07ff45a5794a992fd3d59ab55aa73
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 12 16:03:52 2006 -0800

    Fix mac mini SDVO output: write the SDVO[BC] enabled register state twice.

commit 9776f6c68b3cdd5585e58e677c1b1318d9aedaf4
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 12 16:02:47 2006 -0800

    Flush the plane changes in i830_crtc_dpms()
    
    Otherwise, the changes may not have taken effect.

commit 54823ac39ce9666099d69196694643f04123cb4d
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 12 14:38:08 2006 -0800

    Move the SDVO sync detection to after we've turned the port on.

commit ec45d7274333cccd20ad080facc8e995ad7b26b0
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 12 13:54:49 2006 -0800

    Extend the error state reporting to cover ESR and decode PGTBL_ERR for 945.

commit 838af10b85ee8c085c6d2c4fbe18fd90b2be9d3f
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 12 13:45:41 2006 -0800

    Move PrintErrorState and CheckInheritedErrors code to i830_debug.c.

commit 668ae6ce3c3c4b93a58749fd44ef32451adb6f9c
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 12 11:39:40 2006 -0800

    Set the SDVO port to on before sending the SDVO output on command.

commit 91a538beadc17155be395ea2c8109a0958a969bd
Author: Eric Anholt <eric@anholt.net>
Date:   Sat Dec 9 15:58:47 2006 -0800

    More debugging output for SDVO.

commit ce54538b905eb329f45c1b9b15e95ddce4a7927f
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Dec 8 08:26:30 2006 -0800

    Add a hack for DDC on my Mac Mini.

commit c8c1fb64ccecfb88f9923ad65c9898aa44692260
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 11 16:02:29 2006 -0800

    Move the overlay mode switch status updates to when we enable/disable crtcs.
    
    This should help if we mode switch with randr during video playback, and also
    simplifies the code by moving the protection all to one place.

commit 3f3791ba2ece8e8a7aa3a5676f5f6361862a292c
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 11 15:20:15 2006 -0800

    Remove remnants of old savedCurrentMode hack.  Man, that was gross.

commit c21baa5a3044eb66f2518b018dae07eadb989aa1
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 11 15:15:01 2006 -0800

    Remove dead remnants of old clone mode support.

commit b3865f34669319f449f2da8f87a4eef6ec8e7804
Author: Joshua J. Berry <des@condordes.net>
Date:   Mon Dec 11 14:46:20 2006 -0800

    Include i830.h to get M_T_* compat defines for older X Servers.
    
    Not duplicating the defines ensures that we won't let the compat bits slip
    into the X Server when we move this code over there.

commit 24d9521c7ae72e146025f10ea85b07ebd7041716
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Dec 11 09:34:50 2006 -0800

    Add error messages for previous silent DRI initialization failures.

commit bf43f8ce736d91659c2757fb39b13e63bc5891a4
Merge: 684ea26... 9452321...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Dec 8 14:17:43 2006 +0800

    Merge branch 'modesetting' into crestline

commit 94523215127a3458a28d0f1217224a27c8870884
Merge: 75f4df2... fde52de...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Dec 8 14:15:06 2006 +0800

    Merge branch 'modesetting' of git+ssh://zhen@git.freedesktop.org/git/xorg/driver/xf86-video-intel into modesetting

commit 684ea26b740d07ec8f6b0d223c1171e70c073bfa
Merge: 64269de... 6b977f0...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Dec 8 14:03:10 2006 +0800

    Merge branch 'exa-i965' of git+ssh://zhen@git.freedesktop.org/git/xorg/driver/xf86-video-intel into crestline

commit 99f6f84076b25af69dc226e6d4704c74d207e657
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Dec 7 09:47:34 2006 +0000

    Bump to 1.7.3

commit fde52de870c84821ab457e17634c334a10cf71ab
Merge: 7dbe6c3... 85de8a0...
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Wed Dec 6 23:40:13 2006 -0800

    Merge branch 'modesetting-origin' into modesetting

commit 7dbe6c378d1bc0c06ed6be4c1f9ca38ac31a5571
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Wed Dec 6 23:39:14 2006 -0800

    Move vga restore to end of RestoreHWState.
    
    I was having consistent system lockups when the vga restore
    was first. Moving it to the end has reduced them to an infrequent
    occurrence (but, alas, it has happened once since). This does not
    make me happy.

commit 28c7002b1cf81e286a083384575d53021d3ce906
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Wed Dec 6 23:35:15 2006 -0800

    Use DOUBLE_WIDE mode on all hardware.
    
    DOUBLE_WIDE mode is needed when the pixel clock is > 90% of the core
    clock rate. The code guesses what the core clock rate is based on
    the bus (AGP -> 133MHz, PCI-E -> 200MHz).

commit 85de8a05804eaebcd61430793ef5406f196f9a95
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 6 20:26:53 2006 -0800

    Include render.h to get SubPixelUnknown define.

commit 64269de3c34db047e78b788dc5681abdc009f8aa
Merge: 8ddbc26... 182d2f5...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Dec 6 18:09:28 2006 -0800

    Merge branch 'modesetting' into crestline

commit 182d2f503a7a1be90d93a4a15059585a564fd3ce
Merge: 677c454... 6777d80...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Dec 6 17:18:58 2006 -0800

    Merge branch 'modesetting-origin' into modesetting

commit 6777d8044d5cc063698e05afb7a93a58a7a3b64a
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 6 17:10:06 2006 -0800

    Harmless warning fix.

commit c6ce8a3c3355e8a56e86856caa56baf1cd3c0231
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 6 17:07:48 2006 -0800

    Reduce dumpregs to X startup, after a mode set, and LeaveVT.
    
    While here, remove some other register dumping that is better done by
    i830DumpRegs().

commit b23dec37b28a76433ad5d537ab508294e843cabe
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 6 16:58:24 2006 -0800

    Save/restore registers around calls in PreInit with register side-effects.

commit d3c21c09e3904b3d32aca7563044194b061ac2fa
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 6 16:50:52 2006 -0800

    Remove stale i830_tv_pre_set_mode. Replaced by generic dpms hook call.
    
    Also replaced by not spamming unrelated ADPA register.  At least, it had sure
    better not be related.

commit 9c3e733aaa2068fcb0164577237ed70d177e9b5a
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 6 16:36:42 2006 -0800

    Save/restore more TV registers.

commit d5ec9d2160f47f21a6015c1cc05b57274cbb0471
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Wed Dec 6 14:44:40 2006 -0800

    Cannot modify DPLL register in output mode_set function.
    
    DPLL register contains clock setup, so it cannot be written
    from the output mode_set function or 'bad things' happen.

commit 5d345c13a949caef384a63769d7185885de6d26d
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Wed Dec 6 13:19:58 2006 -0800

    Clean up SDVO multiplier debug output

commit 6ee63364f5fabbc5578bcc9ded38c778595f5a6d
Merge: 56f7119... b75ecdb...
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Wed Dec 6 12:53:22 2006 -0800

    Merge branch 'modesetting' into nonrandr-setup
    
    Also, fix buffer overflow in i830_debug.c

commit b75ecdb48309a15eb7c52b279c7f8523a95bcd48
Merge: 1cb6311... b3bb10e...
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 6 11:59:33 2006 -0800

    Merge branch 'generic-mode-set' into modesetting

commit b3bb10e33e44c78f132d239e30931f97065a9fd6
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 6 11:53:40 2006 -0800

    Fix LVDS: Don't change bits in LVDS other than port enable/pipe select.
    
    This behavior matches what we did before when LVDS worked.

commit 47d07b1073c162ec00a8b173b8b6389dc4adbe88
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 6 10:56:38 2006 -0800

    More LVDS fixed mode fixing: use the EDID DTD's blank length.

commit 727bf1cbf72362edcbdd68001a3558fd2b2b4eca
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 6 10:12:49 2006 -0800

    Add missing newlines to new debug output.

commit 236c53be5d94798d55219651a6885fee32ce175b
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Dec 6 10:10:27 2006 -0800

    Fix LVDS fixed mode code after generic-mode-set.

commit 1cb6311c1182fe98d2b8d237cef42509c3178f9a
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Dec 6 16:31:00 2006 +0800

    fix typo in checking xf86CrtcScreenInit return

commit 56f71194157ef929b62fe34a89c840bd59e56301
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Wed Dec 6 00:13:57 2006 -0800

    Use xf86 structures for default config instead of RandR.
    
    To avoid requiring RandR 1.2 in the X server, use the
    xf86 Crtc and Output structures as the basis for the default configuration
    computation (and, eventually, the config-file based configuration as well).

commit 6b977f0eca388a295ca7348f5960bd8e0192cf1d
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Dec 6 13:24:44 2006 +0800

    fix Makefile.am

commit ffd8aacbe7c72b696ff7257609e3c1d45c057609
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Tue Dec 5 19:48:39 2006 -0800

    new server APIs are not in server-1.2 (version 7.1.99.2)

commit a73649611414cb92697575efa90addfc3cf91cf9
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Tue Dec 5 19:47:04 2006 -0800

    Capture VGA registers sooner so checks are more informative

commit 62fba80d3ea9c185ec8ae1e06c099c02bf844d8b
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Tue Dec 5 19:43:41 2006 -0800

    fix up misleading comment in i830_crt.c about border register

commit 041f0029c78620ca1b50e7e5d11f5d022e189641
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Dec 6 10:43:29 2006 +0800

    Formats fixes
    
    We should use card_fmt for src/mask picture, and use dest color
    buffer format helper. Also fix wrong name for G965 texture formats,
    and pict_x1r5g5b5 isn't supported by sampler engine.

commit 1d94ec7de3387b70815679977cfc5d88200efa99
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 5 18:22:59 2006 -0800

    Fix ordering of PIPE[AB]SRC debug output to be (x, y).

commit eee23fdd0dadd38a2b80525ec886120150f91077
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 5 18:19:49 2006 -0800

    Fix copy'n'paste-o of the ordering of h/v fields in DSP[AB]SIZE.

commit 58c247c6de56508b00eadf77b4c145c94134270d
Merge: 0b4c3e7... 2e8c927...
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 5 15:28:21 2006 -0800

    Merge branch 'modesetting-origin' into modesetting
    
    Conflicts:
    
    	src/i830_display.c

commit 0b4c3e7bff790e1e99ace5036a41e96046335b04
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 5 14:39:47 2006 -0800

    Add a bunch of per-register debug code to i830DumpRegs().

commit 7844e576e71c004ed495bbc31f7bbe890d18b8d9
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 5 14:39:09 2006 -0800

    Move reg dump from i830PipeSetMode to after we set up the modes with RandR.

commit e777d38ce98d7220621b049b09df1deca5a5df42
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Dec 5 10:01:31 2006 -0800

    WIP code to move mode set sequencing to XFree86 handlers.
    
    It compiles.  It definitely doesn't run.

commit 2e8c927f9308069a82f25b65bb0c62bc5a156832
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Mon Dec 4 14:02:30 2006 -0800

    Re-create RandR Crtc/output structures on server regen.
    
    RandR structures must be re-created when the server reinitializes,
    but the driver PreInit function is not re-invoked. Recreate them
    manually in this case during ScreenInit.

commit 583619cdb2b6a469299dd5bf658bf5b51ee999fe
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Dec 4 15:48:04 2006 +0800

    set correct default border color

commit f28d5fc30ccf60d72d5832bb6542522dc7f1c463
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Dec 4 15:47:31 2006 +0800

    fix typo in ps kernel
    
    fix corrupt in some subspans

commit 677c454469a6223460778033758e384e989cea47
Merge: 16f9a56... 8fcf9a8...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Dec 2 23:28:38 2006 -0800

    Merge branch 'modesetting-origin' into modesetting

commit 8fcf9a81179ee8577ddab5e904c58fbfd14cf59c
Author: Keith Packard <keithp@ukulele.keithp.com>
Date:   Sat Dec 2 22:58:31 2006 -0800

    DOUBLE_WIDE mode for high pixel clock 8xx. Rewrite PLL search.
    
    High pixel clock modes on pipe A of an 8xx chip require
    DOUBLE_WIDE mode. It's supposed to be modes > 180MHz or so,
    but the board I have requires DOUBLE_WIDE mode for clocks > 108MHz
    or so. The limit is related to the core clock speed of the chip, which
    can be found indirectly through PCI config space. None of the possible
    values explain why this board needs this mode for these relatively low
    clock rates though.
    
    Also, create tables of data for the PLL computation and use them
    instead of code. I think it's cleaner looking. It is also untested on
    9xx. It'll work. Really.

commit 81dde11d419c8f9198ab3502d9813d66d0bc6d6d
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Dec 1 10:37:19 2006 -0800

    Fix copy'n'paste-o from restructure-outputs that resulted in crashes.
    
    Our driver private is stored in the bus that we set up, not the DDC device
    that xf86 code does.

commit a504e31f0fefdec802ae403573f52fac3d577b65
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Dec 1 12:49:43 2006 -0800

    Don't try to write the read-only PP_STATUS register.
    
    Also, don't bother reading the PP_CONTROL register to try to get LVDS status --
    that's what PP_STATUS is for.

commit f21230d3e1cc5470e8f88404b5d9f1702bec44bb
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Dec 1 12:48:57 2006 -0800

    Add the [ax]4r4g4b4 source picture formats.

commit 8ddbc26b276016b922487f7b1e8997998b655a7d
Merge: 93975a5... 16f9a56...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Dec 1 10:57:16 2006 -0800

    Merge branch 'modesetting' into crestline
    
    Use new TV output condition (all 9xx except 915g)

commit 16f9a56070a01c7ada8e566d9b73fcf7900136e0
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Dec 1 10:50:27 2006 -0800

    TV output exists on all 9xx chips except for 915G

commit 93975a526086432cdeb8d7ead721a862d632c1e7
Merge: 08b6569... e603cd0...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Dec 1 10:28:58 2006 -0800

    Merge branch 'modesetting' into crestline

commit e603cd0c73344ef137d3276b5cfcbcf4df340778
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Dec 1 10:08:36 2006 -0800

    Leave detected TV status alone when no free CRTC is available.
    
    Yes, this means not detecting TV hotplug when two outputs are
    already running. An alternative would be to turn off one of the other
    outputs temporarily, but that would cause flashing. Something to consider.

commit ec30356d950199903978265076b8a4e3960cf84f
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Dec 1 10:06:29 2006 -0800

    Do output detection before any crtc allocation.
    
    Some output detection requires a crtc for load detection, perform all of the
    output detection before allocating any crtcs so that there will be a free
    crtc for any load detection. Avoids losing TV detection when two monitors
    are connected.

commit 7642da82781826cb3b45078750cc54d8f592893a
Author: Keith Packard <keithp@ukulele.keithp.com>
Date:   Thu Nov 30 23:21:39 2006 -0800

    When CRTC is disable through RandR, the mode is NULL. Don't dereference it.
    
    Correctly interpret mode == NULL as CRTC disable, make sure the CRTC is
    disabled in this case.

commit de50ca9ed9e78c17be1badec62e35ed5e4d62b05
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 30 17:56:47 2006 -0800

    Tristate the clock/data pins during GPIO when released while getting values.
    
    While the register is laid out suggesting that you can read a low value while
    driving the output high, and the I2C spec seems to indicate that you should be
    able to as well, and on some hardware this works successfully, on the i865 and
    perhaps some other chips it doesn't.  So, if we're not holding the clock or
    data pin low during GetBits, tristate the pin so that we can successfully read.
    
    This fixes i865 analog (VGA) DDC so it successfully sees slave acks.
    
    Also, improve the I2C bit-banging debugging.

commit 8c44556408601db2be799b5ac5c4da1d92886d31
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 30 15:56:52 2006 -0800

    Preserve some GPIO bits that the docs tell us to.

commit 28401b25cc5c1afb272e506cef196ba3a1258bd3
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 30 15:45:13 2006 -0800

    Add debug code for the bit-banging I2C implementation.

commit ff64bc7397cafbec94e388e1625b3a1999f1aca7
Merge: b94b7c4... 16e01b1...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Nov 30 14:09:31 2006 -0800

    Merge branch 'restructure-outputs' into modesetting.
    
    Outputs and Crtcs now have a driver-independent representation which should
    permit generic code to control RandR 1.2 and startup configuration.

commit 16e01b117bb7ae90b150dd4f25a887dd895cf473
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Nov 30 11:55:29 2006 -0800

    Oops. Don't try to use xf86RandR names, use xf86RandR12 instead.
    
    Attempts to override functions in core server fail, so use
    new names instead.

commit bcf206ff17c6eca8212db72dd86fcd8fdc0162da
Merge: 27ca1c1... 2c8c310...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Nov 30 11:39:56 2006 -0800

    Merge branch 'restructure-outputs-origin' into restructure-outputs

commit 27ca1c17aab30670dd1d07e0809fd58cdecfc3b6
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Nov 30 11:39:37 2006 -0800

    Rename I830 randr functions to xf86 as they are becoming generic.
    
    Change function names, create separate i830_randr.h header file
    to contain definitions.

commit b94b7c4bcfdb7ba59ed818f72309b5060a2ab7ee
Merge: b6fc8df... 25e6e49...
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 30 09:15:30 2006 -0800

    Merge branch 'exa' of ../xf86-video-intel into modesetting
    
    Conflicts:
    
    	man/i810.man
    	src/Makefile.am
    	src/i830.h
    	src/i830_driver.c
    	src/i830_rotate.c
    	src/i830_video.c

commit b6fc8df9a52f5fe1b4d26ae06bc4d48235b44a67
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 29 15:06:32 2006 -0800

    Properly detect the GTT size on the G965.
    
    In the past, the GTT has always been sized just large enough to map the whole
    graphics aperture.  However, apparently on the G965 that isn't the case, and
    it is actually 512KB on hardware with a 256MB aperture.  This resulted in X
    not bothering to allocate memory for 256KB that it thought was already mapped
    into stolen memory, and thus garbage rendering (particularly visible in large
    video modes that displayed this unallocated memory).  The kernel happens to
    get the right answer by hardwiring a 512KB GTT size already, but that may not
    be true on future hardware.
    
    Instead, we use a convenient field in PGETBL_CTL that's specifically for the
    GTT size rather than the aperture size, which gets us the answer we want.

commit 359dc81c07901665da0f86c573c096fa1661cdd2
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 29 15:01:39 2006 -0800

    Revert "Don't allocate stuff in the first 256K of video memory (GATT?)"
    
    This reverts commit 997e8c9bb4235cab1fff4738387df9afcbea0a03.
    
    The GTT is definitely located at the end of stolen memory.  This commit
    apparently worked around mis-estimation of the GTT size.

commit db391e8e4c4d87bfe3ccad0de14dd5b47b69b8fe
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 17:16:46 2006 +0800

    shut up warning

commit 290f15cd4cda97727ebcaadacbbbf7650278934b
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 17:14:55 2006 +0800

    fix alpha blending state

commit 3d4edd325f3859c749ee42df102bb4239eac5287
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 17:05:32 2006 +0800

    Add in sf/wm program for mask picture without CA

commit a704120b15efae47344a90d972e7f3da64a202a6
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:52:44 2006 +0800

    misc cleanup for G965 vs/sf/wm states

commit e3c70c68e39183226e498271c44e98ef1b96a681
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:40:15 2006 +0800

    WM kernel needs scratch space

commit aa515c54f0cfd9025fc38dc4b7938ff17a8a13fb
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:37:06 2006 +0800

    Setup default border color for our samplers

commit b6eba96584bcd2c024f6443d9f3728eb65b234fb
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:30:53 2006 +0800

    fix vertex buffer size

commit 453842c9ff733af45fa665d9db6a35164f45c60a
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:24:24 2006 +0800

    clean up issue cmd to ring buffer
    
    Make it easy to track different part of ring state, and
    use rectlist primitive instead.

commit 18ad7d5cf04081d89a9f978ccc7794116f7c498b
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:04:16 2006 +0800

    remove wrong scale_units

commit 3d5bd0c14eea7951540f7a12eee257428f78e2d1
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 16:02:16 2006 +0800

    Rename exa sf/wm program files
    
    Also fix some minors in wm program.

commit a06beb5f80f097fac3b718e742742bb32f1c1194
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Nov 29 15:47:19 2006 +0800

    EXA state mem for G965
    
    Not split offscreen mem for exa, but alloc a dedicated one
    for G965 states.

commit 9e4e7d4fa25a64a2494e7531967599142e60e716
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Nov 28 16:36:09 2006 -0800

    Conditionally compile old-server compatibility code in.
    
    This also replaces calls to compat code with the real names of the functions,
    and slips #defines to an i830-namespaced version in when doing compat.
    The current server version (7.1.99.2) is still left as requiring compat code,
    since the version hasn't been bumped yet.
    
    This also fixes some failures to call the compat code, and some failures to
    actually compile the compat code.  Oops.

commit 8d9ba2405d1f1e58a0cfb570e83e9206af8525b5
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Nov 28 15:44:06 2006 -0800

    sparse cleanups (use NULL instead of 0 for pointers)

commit dbb8135e10e943a4d4e65f95853eeccc764ccf24
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Nov 28 13:21:31 2006 -0800

    Remove printing of the XFree86 screen mode list, and some other detritus.

commit e8fb40ab1063b18372be2b5996257eb69d3f15c4
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Nov 28 11:17:21 2006 -0800

    Replace custom DDC mode list code with a copy of the X Server's.
    
    The X Server now has most of the mode helper functions we want, and we can
    start removing compilation of our copies when the server is new enough.

commit 2c8c310bd8a105dbeda5c989dca31cc766eb6bb8
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Mon Nov 27 22:18:59 2006 -0800

    Driver-independent code tracks num_crtc itself, don't do it in driver.
    
    Now that driver-independent code manages array of crtcs, let it track
    the count and just have the driver compute how many there are in
    a separate variable.

commit c421724d8151d1d4578468abdbe8fe1120e373ca
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Mon Nov 27 22:15:40 2006 -0800

    Move #include "randrstr.h" from i830.h to i830_xf86Crtc.h
    
    As part of the separation of driver-dependent from driver-independent code,
    the interactions with RandR are moving entirely out of the driver, which
    means the driver shouldn't even know about RandR, while the
    driver-independent code does.

commit e8d1db326388c9a112f2b8e2eff5a81210b8d6e4
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Nov 27 12:01:47 2006 -0800

    Move crtc/output config to sub-structure.
    
    Place crtc/output in separate structure at head
    of driver private structure. Use this from the config code
    to make it driver-independent. Still lots of effectively driver
    independent code that continues to use driver dependent stuff,
    but that will change.

commit 72692ba2e0254460c4f5a8cd476f5748383390ae
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Nov 27 11:23:55 2006 -0800

    Postpone SDVO DDC bus creation until we've detected the SDVO device.
    
    This reduces log noise for those of us with no SDVO devices.

commit 5f38bc3e2a685da5c03efa8103a353f79c842aa7
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Nov 27 11:06:50 2006 -0800

    Reduce the severity of many informational log messages.

commit 85f404bc67d5ab54175c19e75aad406abfcf2133
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Nov 20 09:32:26 2006 -0800

    Re-indent ch7xxx driver.

commit a0518f5a440630365b1d935b7c2d0725f326ad51
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Nov 26 19:44:38 2006 -0800

    Remove mode setting from load detect CRTC allocation.
    
    To share load-detect CRTC allocation with TV driver,
    move it to the output driver

commit a47c549df036990e29f05bc3df80e1a2ab9f3b3c
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Nov 26 18:26:26 2006 -0800

    Clean up reworked data structure code so the server actually starts.
    
    Use i830GeLoadDetectPipe again (instead of missing xf86AllocCrtc).  Actually
    create new Crtc structures. Fix a few other NULL pointer dereferences.

commit 2529863a1ade782819d76be2d0dc16e89028c1e3
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sun Nov 26 16:44:17 2006 -0800

    Start output/crtc restructuring work. It compiles.
    
    Outputs and Crtcs are now split between 'generic'
    and 'driver specific' pieces in the hope that more code
    will be able to migrate to the xf86-generic layer.
    
    Right now, the code remains tangled together, significant
    work remains to tease the pieces apart. First the code
    needs to be made to actually work as-is though.

commit 9aca4e207440119f4280b78199a221f85d50c511
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Nov 22 15:52:32 2006 -0800

    Remove custom configuration code (which was #ifdef'd out).
    
    Multi-screen configuration is moving to generic code.

commit 850e3652f4d5bb57f3c4ccb9cf29e2c75fecba9d
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Nov 22 15:36:43 2006 -0800

    Note which pipe has failed to be configured for VBlank interrupt

commit 659e3db925de91954421f7f33c072576dfefcc4a
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Nov 22 15:35:59 2006 -0800

    Set up maximum screen size for clone instead of panorama.
    
    This avoids heading past the 8Kbyte stride limit of DRI so
    that 3D will be available by default.

commit 03c12f866529230df7a1503de61954cd5ade242e
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Nov 22 15:34:03 2006 -0800

    Limit DRI use to cases when pitch < 8Kbytes, not 4096 pixels.
    
    3D rendering pipeline is limited to pitch of 8Kbytes and not 4096
    pixels, which rather makes a difference at 32bpp.

commit 6781575f734f05547d7d5ceef4116fc157bba44d
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Nov 22 16:49:57 2006 +0000

    Be a little more verbose when rejecting modes.

commit e065324661ad08b3b359136f48090232f6138959
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Nov 22 16:49:36 2006 +0000

    update port attributes immediately when overlay is on.

commit a0a9d1ea2ac9a0c665e5a1de5b8b8358dee3b9b4
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Mon Nov 20 17:25:00 2006 -0800

    Set configured values for screen virtual size and initial frame.
    
    Computation for virtual size and initial frame origin is quite
    broken in xf86 common code.

commit d6a0f917e601ea36643c6ad857756e19d24ecd73
Author: Keith Packard <keithp@bouzouki.jf.intel.com>
Date:   Mon Nov 20 15:17:32 2006 -0800

    Enable second SDVO channel.
    
    Rework SDVO support so that it can deal with two channels correctly,
    also save/restore all connected output timings.

commit 08b6569dc663ddf38cb36a6875de6d4ab55acac9
Author: Eric Anholt <eric@anholt.net>
Date:   Sun Nov 19 16:15:45 2006 -0800

    Enable TV output on Crestline (untested).

commit 05202cabbd23f15330b811ae6b8d708ad042bc40
Merge: ee502dd... b945a65...
Author: Eric Anholt <eric@anholt.net>
Date:   Sun Nov 19 16:14:18 2006 -0800

    Merge branch 'modesetting-origin' into crestline

commit b945a650e952f98c2d101b71bd3ec0f390478da5
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sun Nov 19 00:54:30 2006 -0800

    Fix TV color key.
    
    Subcarrier defines were incorrect in header file leaving one of the
    DDA phases disabled.

commit 28224af3d90a1a08d54a865dfaf20184330fe8a4
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Sun Nov 19 00:40:46 2006 -0800

    Preliminary 945 TV output. Color key is broken. Fixed mode.
    
    TV output is generating video with this patch, but the color burst
    signal is incorrect somehow.

commit ee502dd92a3dfccdc2efcfb76fc652694bc89e3b
Merge: 15ff17c... 2fe6107...
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Nov 17 14:57:41 2006 -0800

    Merge branch 'crestline-origin' into crestline

commit 15ff17c756e42f392306820e3f7ffbdcc56b9892
Merge: 9cc2f33... 816fc1a...
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Nov 17 11:48:53 2006 -0800

    Merge branch 'modesetting' into crestline
    
    This works for analog, but SDVO output appears to not work yet.
    
    Conflicts:
    
    	src/i830_driver.c

commit 816fc1a76a5ac738e41b172ba8f43137c1521328
Merge: 9948d83... 7a7bb33...
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Nov 17 00:05:53 2006 -0800

    Merge branch 'modesetting-origin' into modesetting

commit 7a7bb331e10498e5b8ccec58130bb23334d36562
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Nov 16 21:19:20 2006 -0800

    Don't dereference null DisplayModePtr on disabled output.
    
    During initial configuration, outputs which are disabled have null
    modes.

commit 2fe6107ac68e86ed183d8602436633348340678d
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Nov 17 13:11:36 2006 +0800

    Rotation support for 965GM

commit c4508c1cadf323e9ef1d0e69dd77d5e841a6a978
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Nov 16 21:09:23 2006 -0800

    RandR-based initial output configuration.
    
    Using pre-init computed RandR information, make reasonable
    default choices for the output configuration at startup time.
    Either some preferred size or a size which yields 96dpi is chosen,
    from which other monitors are set to a similar size. The largest
    size sets the screen size.
    
    This needs to be extended to respect config file settings, but
    those have not been defined yet.

commit 9948d8377d70e898260c12210151b952b3fb8bf1
Merge: 45a27f8... b649f95...
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 16 19:47:24 2006 -0800

    Merge branch 'master' into modesetting
    
    Conflicts:
    
    	src/i830.h
    	src/i830_cursor.c
    	src/i830_dri.c
    	src/i830_driver.c
    	src/i830_video.c

commit 9cc2f3313d77487dea372e6ab32d6d9c06617ae3
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 16 15:12:43 2006 -0800

    Replace broken PCI resource size detection with pciGetBaseSize() call.

commit 45a27f80e1c783627f570c309e7a853dcc9af0c1
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Nov 16 13:38:35 2006 -0800

    Remove output options. Let outputs be connected to other crtcs.
    
    Output options will be replaced by properties.
    Permits outputs to be connected to arbitrary CRTCs (within hardware limits).
    No cloning yet.

commit 9aea79d1e954fe4fb5c101edcb7c2d0f706a5c4c
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Nov 16 11:40:26 2006 -0800

    Inverted boolean sense when selecting pipe for CRT detection.
    
    Pipes are available when they are not in use.

commit 4889b9f33336c92f07aac86d75f50316db6ef81a
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 15 15:26:31 2006 -0800

    Enable the LVDS if we find it and assign it to a pipe (oops).

commit 854ff826c0031a44e874239c0b0a3533f4d9e14b
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Nov 14 09:14:24 2006 -0800

    Disable setup of the second SDVO device until we fix it.

commit d51555fba4e57c059fd184c1e54822d7e5b62a2f
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Nov 10 14:40:40 2006 -0800

    Fix clock range for single-channel LVDS.

commit dd1dcfab0ab0f2d0c25077fa663209e2762f26e8
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Nov 10 11:08:02 2006 -0800

    Fill in some of the high bits of mode timings for SDVO.

commit 3955f044cfe1d592bcb36c43c539fb4a75840b8d
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 9 20:28:46 2006 -0800

    Expose the DDC-probed EDID data as the EDID_DATA output property.

commit 0f5886689d7ef7dbbef6425d5c855ac6b67d3350
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Wed Nov 8 23:19:59 2006 -0800

    Create RandR 1.2 objects in I830PreInit.
    
    Creating the objects early will allow the driver to use
    randr structures to select a reasonable configuration.
    That part has not been done yet.

commit 679c7bd82639a09cdce133becb8a08629ce3a4e9
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Wed Nov 8 21:39:28 2006 -0800

    ignore edited man page

commit 81b7b489afa2cab4d8614c64f4906be627f1d07e
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Wed Nov 8 21:38:00 2006 -0800

    Adapt to RandR updates that split object creation from screen association.
    
    RandR DIX code is preparing for xf86 drivers that want to allocate RandR
    objects at PreInit time. This patch adapts to that change without taking
    advantage of it.

commit 81bace0c316c3ed80201a34eca533254d12cd193
Merge: 713c5b0... beb8916...
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Wed Nov 8 20:23:20 2006 -0800

    Merge branch 'modesetting-keithp' into modesetting
    
    Conflicts in PipeSetMode were resolved to use the keithp changes
    that pushed more modesetting stuff into the per-pipe function.
    
    Switched availablePipes to num_pipes.
    
    Used modesetting default output configuration.

commit 713c5b0899428edfea7cea0780244488115dbe1d
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 8 19:55:31 2006 -0800

    Change the output and pipe "is it on/off" field name to "enabled".

commit ff77e9d84f2037b99a8e4ac55da0b0ac92ed6b9b
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 8 19:53:31 2006 -0800

    Clean up i830_crt_detect_load() a bit more.
    
    ADPA might not have been set right in some cases (DPMS-off monitor, for
    example), and a wait for vsync that the bios does was missing.

commit 9b267014b55f49d9362c1d432d6ba19ddd0ad95d
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 8 19:39:18 2006 -0800

    Go back to only setting up outputs that have a display connected.

commit 35ab689bbde5f74752598cd743d735640486b639
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 8 19:35:49 2006 -0800

    Fix i830DisableUnusedFunctions after pipe structure change.
    
    Using "pipe" instead of the index "i" meant pipe(3) got referenced instead of
    a nice small integer.  Oops.

commit b649f95ea6fd3555d073fdbf8f2f035dfe1afd33
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Nov 8 19:01:25 2006 +0000

    Disable some debug message

commit 75f4df278e9db360967d77cdba4756cbde622d56
Author: root <root@localhost.localdomain>
Date:   Wed Nov 8 13:56:32 2006 +0800

    855 fix

commit f1ff01e31eb8e9dc05190bf1a8b318d4f587f64a
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Nov 4 00:46:18 2006 -0800

    Eliminate operatingDevices member and PIPE_* values.
    
    operatingDevices and MonType1/MonType2 duplicate information already stored
    in the device structures. Eliminate them and replace uses with direct
    references to the appropriate other data.
    (cherry picked from 3ab7f9693217d8fe993bdc94c376b219b0082961 commit)

commit 0b2d36d4f038c4e8fa08632b6f1368627f010392
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Nov 3 23:29:12 2006 -0800

    Use pI830->availablePipes instead of MAX_DISPLAY_PIPES everywhere
    (cherry picked from e4bcec796e80e9fd66ab0c36394f5946915531f1 commit)

commit d0ef9e99acb9e999e1b6d3eb76edc6355555043b
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Nov 6 18:30:46 2006 -0800

    Restore PFIT_CONTROL before turning the LVDS back on in the restore method.

commit 94a3731c2b4f2ea2e696a8c87dccc0d214d41e8e
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Nov 6 18:26:48 2006 -0800

    Move PFIT_CONTROL disable for G965 up before post_set_mode.
    
    Also, remove setting of some other random registers that appears to have
    been spammed in at the same time, and don't try to disable on the I830, before
    this register existed.

commit beb89163d73376e70870e6e2a6b19863f3a058b1
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Sun Nov 5 19:06:45 2006 -0800

    DSPSURF must be page aligned. Place intra-screen offset in DSPBASE.
    
    DSPASURF/DSPBSURF can only take page aligned values, ignoring
    the lower order bits. So, place the offset for the output
    within the frame buffer in the DSPABASE/DSPBBASE registers instead.

commit 997e8c9bb4235cab1fff4738387df9afcbea0a03
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Sun Nov 5 18:56:33 2006 -0800

    Don't allocate stuff in the first 256K of video memory (GATT?)
    
    Letting the ring buffer or other objects be allocated within the lowest
    portion of memory appears to trash some memory mapping data; I'm assuming
    this is the GATT table on the 965. Just marking this out of bounds for
    allocation fixes this problem.

commit 5a355c72614ed77f2000e5ede45f3ff5990c79d9
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Sun Nov 5 18:51:28 2006 -0800

    Fix CRT output on 965 chipset.
    
    A few more register settings are needed to get CRT output working on the
    965 chipset, in particular the the SDVO/UDI clock multiplier register
    needed to get set to the default value (3). No, I really don't know what
    this does, but it does get the CRT running at a wide range of sizes.

commit 49a6bea7d969dbfd1dd542c0c3e02abc330d6850
Merge: 64447c7... fbb376b...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Nov 6 10:25:23 2006 +0800

    Merge branch 'master' into crestline

commit 68c3185046b27ab936ca6c92b924b443b3cd6fce
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Sun Nov 5 13:30:32 2006 -0800

    Avoid crashing when disabling sdvo output. XXX

commit 15ef08046bcc3e746453301379f7c5d1bf929ee1
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Sun Nov 5 13:29:56 2006 -0800

    Move remaining pipe mode setting logic to i830PipeSetMode

commit 7fcb555735a58e19ccc10875b211402983170a87
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Nov 4 00:52:21 2006 -0800

    Rename availablePipes to num_pipes

commit 3ab7f9693217d8fe993bdc94c376b219b0082961
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Nov 4 00:46:18 2006 -0800

    Eliminate operatingDevices member and PIPE_* values.
    
    operatingDevices and MonType1/MonType2 duplicate information already stored
    in the device structures. Eliminate them and replace uses with direct
    references to the appropriate other data.

commit e4bcec796e80e9fd66ab0c36394f5946915531f1
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Nov 3 23:29:12 2006 -0800

    Use pI830->availablePipes instead of MAX_DISPLAY_PIPES everywhere

commit b7262a9a9110dac66e1a92c39dcb3ab59d95d081
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Nov 3 23:24:07 2006 -0800

    Finish removing persistant vbe data

commit 4625073244d4f521a07e12adcf0609e85658acbe
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Nov 3 23:23:38 2006 -0800

    Oops, martian memset of randr modes pointer

commit 719ad68515be9b996a6314de5448843de1146b88
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Nov 3 19:41:41 2006 -0800

    Use VBE only temporarily to fetch BIOS rom image
    (cherry picked from 6a9386651785afc70a29e355255e8295b321f28e commit)

commit 27df2ff7908ea7ea2943a5f3445e12dbc24d97c9
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Nov 3 15:55:10 2006 -0800

    Report pipe status (and status mismatches) in i830DescribeOutputConfiguration()

commit ecbe73b940b2d642115de4b73c2f757eb46ff956
Merge: 561af00... 9681602...
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Nov 3 15:59:59 2006 -0800

    Merge branch 'modesetting-origin' into modesetting
    
    Conflicts:
    
    	src/i830_display.c

commit 561af007974b8cdad1eea907fb73ed9d430c21ac
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Nov 3 15:26:14 2006 -0800

    Add support for load-based CRT detection.

commit e416b426d83de031441ada7a77b6bd66cec8b5c9
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Nov 3 15:25:41 2006 -0800

    Print out modelines as info, not error (which had been used for debugging).

commit 282a9e073ea985cbf0d0f3f296d593af1426bad5
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Nov 3 13:46:09 2006 -0800

    Don't memset the modes pointer on init, which was dereferencing NULL.

commit 9681602177124e84a817a1e1d428f1779f2a45c9
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Nov 3 12:55:25 2006 -0800

    Create I830PipeRec to hold pipe-specific data. Remove unused I830 members.
    
    I830 contained six parallel arrays for pipe-specific data; these
    have been moved to a I830PipeRec structure instead.
    
    I830 also contained several unused members:
    
       unsigned int bios_version;
       Bool newPipeSwitch;
       Bool fakeSwitch;
       int fixedPipe;
    
    These have been removed, along with the code that set them.

commit 0510671a6c5233468ac20f0ec8096e084df03ce6
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Nov 3 10:58:23 2006 -0800

    Fix a pasteo in I965 register restore.

commit 2c9ab6e0594769274f2dbcdf7c00fe297fc385d5
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Thu Nov 2 13:44:55 2006 -0800

    set the v_sync_off_high to zero. XXX should check docs

commit 56f6d4f1bb67f447500af3f4f7fa557c3e887baa
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Thu Nov 2 13:42:17 2006 -0800

    Disable the panel fitter when not using it. Cleans up SDVO DVI output.
    
    The panel fitter appears to exist on the 965 hardware (at least) and
    causes troubles with DVI output over SDVO when enabled. This patch
    checks to see if the panel fitter is pointing at the pipe being configured
    and disables it unconditionally in that case. The LVDS driver will configure
    it correctly if necessary afterwards.

commit f22d9bcc25aea19ba38d35282367b591fd1b7ca0
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Thu Nov 2 13:34:45 2006 -0800

    Add another couple of new registers

commit a9eac38bcdb49df2ce1122b49bd8b1eb19e8cae5
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 2 13:24:54 2006 -0800

    Remove duplicated register defs that were just added.

commit 7887c76062b7c79e14fb8e4f13486aa592dcbce8
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 2 12:27:21 2006 -0800

    Add airlied's I2C code, ifdeffed out.
    
    I've gone back to compare our behavior to it several times, so I'll just keep
    the code in tree for now.

commit 87b15cfbf762468d4b8728b3e7a39c76654017de
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Nov 2 11:30:21 2006 -0800

    Remove dead specifiedMonitor field.

commit 2636d68663a02f6d9eaf36971706b67036ebf56c
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Thu Nov 2 11:57:11 2006 -0800

    Dump more registers for debug purposes

commit 786ec54c4c1540f4aced63ef21d567c3b9f3282e
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Thu Nov 2 11:56:50 2006 -0800

    Add a few more registers from the 965 spec

commit 85e32ad2dadcce1134fcadb14ece8ff30f3925f2
Author: Keith Packard <keithp@mandolin.keithp.com>
Date:   Thu Nov 2 11:56:12 2006 -0800

    ch7xxxSaveRegs receives real type instead of void *

commit ffbd6ca09bc2300bf967d7c248a559d85b8706e0
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 1 13:05:44 2006 -0800

    Remove dead VESARec struct.

commit 97c3a1b2421031e41f0b2b1630fde1dc4262d264
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 1 13:04:08 2006 -0800

    Remove the refresh rate appended to some mode names.
    
    This gets the SDVO and CRT outputs I have to have at least 1 common mode
    according to RandR.

commit 7971c401554c218c84a8c45335c9b31bbccfece7
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 1 12:42:56 2006 -0800

    Attempt to pull monitor physical size information out of DDC EDID data.

commit fb94c1210966f7875e5f034f10ea31c06c502c3a
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 1 12:23:50 2006 -0800

    Move mode lists from per-pipe to per-output.
    
    This should let RandR do the right thing in exposing the modes to userland.
    
    As a side effect of getting this working, the SDVO pixel clock range code
    was fixed and the mode valid tests for various outputs got extended.  Also,
    LVDS grew a get_modes for the fixed panel mode.
    
    Note that we now no longer do automatic enabling of outputs at xrandr -s 0,
    hotkey, or VT switch.  That will be left to generic RandR code later.  Also,
    generic modes and user-defined modes are once again not validated into the
    lists, so this is a regression there.

commit f30d7f912f36b110c3af7dc795e35456593781ab
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Nov 1 11:50:51 2006 -0800

    Update for the move of RandR phyiscal size information.

commit 64447c7a059775e7ea8649f4714df7565e932c60
Author: Zou Nanhai <nanhai.zou@intel.com>
Date:   Wed Nov 1 14:36:20 2006 +0800

    walk around to VBIOS bug in Crestline B0

commit 7195dfabd56239f08cdd8175a2ef3a66ef9600de
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 31 17:10:08 2006 -0800

    Give each output a get_modes function and expose those modes through RandR.
    
    The get_modes should return the probed modes only.  The driver should then
    append to the list (for example, compatible modes listed in other outputs,
    or standard VESA modes) to create the list to expose through RandR.  That
    isn't done yet.

commit cc3728be2481637dda321d3bc2e4e89a220699cd
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 31 15:00:36 2006 -0800

    Add compat definitions for M_T_PREFERRED and M_T_DRIVER for older X Servers.

commit a71f283650e8cb7b760e5a53c4db79202c4cc5c4
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 31 14:46:23 2006 -0800

    Connect output detection up to RandR.

commit 68cef9f4e028755bbf3e1862da2ef47d46ddaa6a
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 31 14:32:00 2006 -0800

    Move output connection detection to a per-output method.
    
    This will be used by RandR, and should let us clean up some of the initial
    display configuration, hopefully.
    
    Also, analog hotplug-based detection is now enabled on G965.

commit 9fd719fce27f916ab5120f6e1234affa14eaed9d
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 31 14:29:44 2006 -0800

    Move SDVOB_PRESERVE_MASK next to SDVOC_PRESERVE_MASK.

commit 4f5d4d8870fc2784192f95a561163cf4fc8737ac
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 31 13:37:23 2006 -0800

    i830SetLVDSPanelPower is now a static function in i830_lvds.c, so remove it.

commit 49bbdf16c02107c08169f8d2b6e9c6dbd7d8cd95
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 31 10:44:45 2006 -0800

    Fix many inconsistencies in the SDVO code compared to the spec.
    
    Also, fix some struct padding  so that the right bits are sent out.

commit e7d546cac06767ec58325396a3bb5780b2257c53
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 30 11:24:43 2006 -0800

    Remove some dead code from BIOS modesetting.

commit 2ca57040b0cd24ad3dbe693789091e28be4e69f8
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 30 11:19:19 2006 -0800

    Remove GetBIOSVersion().
    
    This info hardly useful now that we don't use the BIOS for mode setting.

commit 837b2f632062bc29268f109895a577bd90cabd6d
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 30 11:17:55 2006 -0800

    Warning fix.

commit bca9e6ccbd14eb8f2f103e8e64b28a623113d494
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 30 11:17:27 2006 -0800

    Remove SetPipeAccess and now-unnecessary VBE reinit.

commit 819a47b27cd4728feb269a08be32403304993ffa
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 30 09:50:33 2006 -0800

    Use the new fields for SDVO pixel multiply on the G965.
    
    This should fix display at resolutions/refresh rates in a different multiplier
    class than the console display (generally, high resolution modes).

commit 71545db4614cfc4650acc4325912474e777c3b36
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 30 09:46:10 2006 -0800

    Return and use valid status bits for i830_sdvo_get_trained_inputs().

commit c357eca10ca1c535d305e1f3028471a912ae4102
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 30 09:44:55 2006 -0800

    Clean up whitespace in i830_randr.c.

commit fbb376bd1a4daad4c86e349df98438989ce173f1
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Oct 30 14:15:12 2006 +0800

    Bug 8594: Fix Xv hang with G965

commit c0ee50c4ee5ff2c594fdf60c9cb8b952e25644de
Author: Thomas Hellstrom <thomas-at-tungstengraphics-dot-com>
Date:   Fri Oct 27 19:13:33 2006 +0200

    Add support for the new DRM memory manager.
    Some code are duplicated with the new libdrm.
    Once this code has been released with xserver,
    it can be removed.
    
    See the man page for new options and backwards
    3D driver compatibility.

commit 25e6e497824a23eb231fc6fd6e483f601d612cee
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 26 15:47:49 2006 -0700

    Major cleanup of 3D invariant state, fixing hangs with rotation and render.
    
    Now, the generic invariant state is always set while the X Server is active,
    and happens automatically when the X Server grabs the DRI lock.  More 3D state
    is moved to the generic code.
    
    Then, the 3D consumers (video, rotation, render) set last_3d to their enum
    entry, and can update their own invariant state when another consumer was
    active.

commit 0bdcce2e4541c6e441c44aad49254ad3093cedb2
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 26 14:30:46 2006 -0700

    Note alignment requirement for i915 3D (texturing).

commit c3666a968b1cfac61b7867874d5fbe2acd894720
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 26 14:30:25 2006 -0700

    Don't write unused values beyond the end of scale_units array.

commit 3ab9f5a4a8cd62c8a8c2a09d3d105adbe815a83d
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 24 00:26:09 2006 -0700

    Move vbeInfo out of the driver struct to the one place it's used.

commit df14838eb5d0a056f663d9f12bd8b5c25cf97330
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 24 00:18:33 2006 -0700

    Remove dead memsize reporting.
    
    The calculation no longer made sense, as we don't use the BIOS for mode
    selection.

commit 3a6104ab89b159241845314ccf88fa62da14cf7d
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 23 19:15:30 2006 -0700

    Remove disabled I830DetectMonitorChange().
    
    This used to be called when switching back in to X.  It might make some sense
    to detect monitors at this time (it happens to occur at resume time, when
    monitors are likely to have changed), but it should probably live in either
    userland policy with RandR 1.2 or RandR 1.2 XFree86-DDX generic code.

commit 88c12f577f80fa132ec45cdf456d8060f2ece4fd
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 23 18:57:57 2006 -0700

    Move LVDS initialization and blacklisting damage to the LVDS support file.

commit 2631014e9d5b2e64908ea413729eb5fd819b17fc
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Oct 25 12:21:44 2006 -0700

    Clean up the SDVO code.
    
    The main change is to send SDVO commands using data passed into the send
    command function, and receive responses into memory passed into the read
    response function, rather than stuff things in/out through dev_priv->sdvo_regs.
    This lets us use structures to represent some arguments, which results in a
    nice cleanup (and 100% fewer arguments named magicN as a side effect).
    
    Also, the mode set path is changed to not do any preferred input timing
    work.  We weren't doing anything legitimate with the results, since we didn't
    modify the CRTC timing appropriately, so now we just stuff the CRTC timing into
    both and hope for the best.  This should probably be revisited later.

commit ddb986e54f5320359abac06f512f2d3f446872db
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 24 17:47:58 2006 -0700

    Nuke trailing whitespace in SDVO code not already cleaned up.

commit cd2f0d948a6cae61b0d77d2c7184ed8d695be8c3
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 24 17:47:47 2006 -0700

    Clean up SDVO code, moving the private structure internal and cleaning up caps.
    
    All the SDVO code should now be in lower case rather than StudlyCaps.
    
    This also adjusts the I2C setup to create a bus per SDVO output we set up.
    The previous setup with shared buses was failing in some circumstances, which
    is probably due to the lack of refcounting in xf86i2c.c.

commit cd9c6e29146e1debaba4b0b9ad0d241f07bdbc14
Merge: c5cca4c... eec5580...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue Oct 24 16:53:46 2006 -0700

    Merge branch 'modesetting-origin' into modesetting

commit eec5580cefffc293bf547372ab63b2fedaef4a83
Merge: 53c28b3... a91c0cb...
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 23 14:52:55 2006 -0700

    Merge branch 'overhaul' into modesetting

commit a91c0cbab5de51885bfce7c7dce76f82c1b19553
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 23 14:30:38 2006 -0700

    Add work-in-progress integrated TV-out support.
    
    This is the TV connector on board for the 915GM and 945GM.
    
    It is currently not hooked up to output initialization as it's entirely
    untested.  However, I think this is a reasonable starting point for getting
    TV-out actually working.

commit 7d67324fa3a5b5cf0227550316c366752fe4abfb
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Oct 23 17:29:17 2006 +0100

    Add some MergedFB checks for accelerator limitations

commit 20d263805a365be548279758bc39d027d6e56d63
Merge: 8548fa5... 5ac927d...
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Oct 23 14:24:41 2006 +0100

    Merge branch 'master' of git+ssh://git.freedesktop.org/git/xorg/driver/xf86-video-intel

commit 8548fa53746c9886eccfb67d022136471d8f3316
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Oct 23 14:23:29 2006 +0100

    Fix manpage to report 8160 instead of 6144 for LinearAlloc.

commit 5ac927d6f05ba6f9608d7e758cbac66e8b3a9db1
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Tue Oct 17 13:27:40 2006 +0200

    Don't crash if SetCursorPosition is called with pScrn->currentMode == NULL.
    
    This allows the driver to work with servers that don't have the fix for this
    that was only recently pushed to git.

commit 8149681f2eac0af3b70a9457c5204e17da56142b
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 16 16:51:04 2006 -0700

    Add a per-output mode-valid method.
    
    This is currently disconnected, but will be used in more overhaul work.
    This should be where any output limitations, such as clocks, resolution,
    scaling limits, or other options, are validated.  Other limitations, such as
    chipset resolution limits, CRTC clock limits, etc. should be elsewhere.

commit c5cca4c20ae6b519e3b021a9d90809c1b3d1facb
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Oct 13 15:31:43 2006 -0700

    Advertise textured video adapter first

commit adae75ef2f8a655a699e982ca8f26b934dbe950a
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Oct 13 17:10:27 2006 +0100

    Make VIDEO_DEBUG into a configure option

commit 1d4cfaa391ac41099de11b8f3b21e5eb56543909
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Oct 13 13:55:10 2006 +0100

    Bump to 1.7.2

commit cd9e51cd3ab0b36d2f97dfc6d8850dafe169c221
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Oct 13 13:54:31 2006 +0100

    Ugh. Turn off debugging.

commit 334aa062c333f2c59bc40e1b9239d3ea71c88a8f
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Oct 13 12:59:30 2006 +0100

    Bump to 1.7.1

commit 8045a7a0af1b276cd7f46ce99d034fd5d503e67c
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Oct 13 12:53:53 2006 +0100

    Fix bug #8553 & #8542 - suspend/resume regression from 1.5 driver

commit 6596333b077a692c669f8cb4ae32e145f8da6731
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Oct 13 12:48:16 2006 +0100

    Fix some warnings

commit 1838671476875e9f5b3dde235eacf9fb43afb66c
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Oct 10 12:41:01 2006 -0700

    Only disable the output when marked disabled.
    
    Also, remove a couple of dead variables.

commit 4198f1216eb13b30d1e92d4395e98861f4324c38
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Oct 10 15:50:10 2006 +0800

    Mark current ps kernel is experimential with little test.

commit d485c1f2de11db92b515690fbe38b6aeb6207605
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Oct 10 14:11:35 2006 +0800

    Use sf_prog.h instead

commit 2591c1fcf15608d96031be4760cf08534461ca34
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 9 14:20:49 2006 -0700

    Fix LVDS restore path, and move pipe assignment for outputs to the right place.

commit 09e3d10b0ff69d180467fa9099d12da08e4f681b
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 9 13:09:18 2006 -0700

    Add a function for describing the output connection configuration.

commit 317cc119c575650c1aa8bf992a0f42bdfffcd7ba
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 9 11:49:18 2006 -0700

    Move per-output mode setting code to per-output methods.
    
    This is not a very clean interface, as a number of outputs require tweaks to
    the DPLL registers.  When possible, the DPLLs are just adjusted in the
    per-output post_set_mode, which happens just after the DPLL is enabled.
    However, this seems better than the previous method of having all outputs
    programmed in the same function.

commit 53c28b3980d2682de830e8f86553ccad71527ac1
Author: Adam Jackson <ajax@benzedrine.nwnk.net>
Date:   Sat Oct 7 11:18:26 2006 -0400

    Expand the check for AOpen Mini-PC.
    
    Just match on subsystem vendor, don't bother inspecting the subsystem device
    ID, since apparently they're all busted.

commit bf3820f1f505649ac0730add23d97d6de3f6d22c
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Oct 6 21:57:26 2006 -0700

    Compute LVDS resolution from server DPI and native panel size.
    
    I was unable to find the native LVDS panel physical size in the BDB
    information. I would prefer to report accurate information through RandR if
    possible though.

commit c7a23908a0ef45b14b438f656a5f15582bfcbc1c
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Oct 6 13:35:39 2006 +0100

    Fix server regeneration problem mapping the aperture

commit d649fb0d964a9b40b8e04314b5fc14bbbfd41bc3
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Thu Oct 5 22:46:07 2006 -0700

    Don't require MonitorLayout when two monitors are plugged in.
    
    With randr12 working, we can just leave the second monitor off for now.

commit 9bb7736ab36f172db58703c4664bb1b0cd7f80c3
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 5 16:02:02 2006 -0700

    Remove checks for output privates in various bits of code.
    
    Now, the output is only set up if it fully initializes, so it will never exist
    if the private it requires doesn't.

commit ada8f62da263d1e93e22df4e0b1149bf1dbe24d4
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Oct 5 15:55:07 2006 -0700

    Give each output type an init method in its file, making other methods static.

commit 0a5504e59f90abecedd81a8435b88a60fe098f29
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Oct 5 09:11:29 2006 -0700

    Fix DPI at startup in RandR 1.2 code.
    
    Use requested monitor resolution to compute the appropriate screen size when
    resizing the screen during RandR initialization.

commit 4ac81d58b7e0fbffbb4981deffe6a576be821a9b
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Oct 4 23:22:52 2006 -0700

    Remove mode origins, add preferred mode count.
    
    Just tracking changes in the 1.2 protocol spec.

commit 103b4edce7859ddf58f3e1fadeb427a5e85c7acd
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Oct 4 15:00:19 2006 -0700

    Move the save, restore, and DPMS per-output settings to per-output files.

commit 16988b27258acfe3d56fc2415aa9ade1ae8d03a9
Merge: cc4148e... 5a06000...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Oct 4 18:44:43 2006 -0700

    Merge branch 'modesetting-guitar' into modesetting

commit 5a060002487e16c53dc96e32af72cd1bfcf6a227
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Wed Oct 4 18:43:07 2006 -0700

    Add mode origins for randr

commit 07cdc60be8ebe5d0c21149f3cd2aeb8fed05022a
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Oct 4 11:05:30 2006 +0100

    Fix bug #5795, VT switching fails because of a bad test on some platforms.

commit 8da10d15f84ccc992b828546af5ba0d848e7263e
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue Oct 3 22:00:14 2006 -0700

    Enable XV_PORT attribute even when not in Clone mode.
    
    As Clone mode is now something that can change after server startup, always
    enable the XV_PORT attribute as we cannot change the list of reported
    attributes.
    (cherry picked from 1bc1cedbcdf6ea4d2a3e8b07b553ac50b3c126f4 commit)

commit cc4148e25dc226cb1365e090db21f01b77cb3cbe
Merge: 1bc1ced... 3e6f81f...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue Oct 3 22:00:41 2006 -0700

    Merge branch 'modesetting-origin' into modesetting

commit 1bc1cedbcdf6ea4d2a3e8b07b553ac50b3c126f4
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue Oct 3 22:00:14 2006 -0700

    Enable XV_PORT attribute even when not in Clone mode.
    
    As Clone mode is now something that can change after server startup, always
    enable the XV_PORT attribute as we cannot change the list of reported
    attributes.

commit 33629ed304b64e45d5640397bd1807c5a98907d1
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue Oct 3 09:39:22 2006 -0700

    Always register list of modes for outputs, even when disabled.

commit 3e6f81f70f65a5ba6b5c3a4e0eeaf67776a5f54d
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Oct 2 09:53:57 2006 -0700

    Move cursor base address register setting to a separate function.

commit f337eea9e73cbf5c71d07df50d2e5b661a1f34cf
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Oct 2 11:16:42 2006 +0100

    silence warning

commit 2b9bdd8a4021231e4b5f4c5831a46c9ff1e38081
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Oct 2 11:12:23 2006 +0100

    bump to 1.7.0

commit eca082ca0fec12973a4dbb0106b841136b5b6cdb
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Sat Sep 30 13:44:43 2006 +0100

    Missing gamma bit

commit cece9a455b54ab184a3277c164ee6dfa65b70f48
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Sat Sep 30 13:27:27 2006 +0100

    Fix issues with Xv locking up the engine. bug #7915.

commit 2013b839de3733fd12becb2cc3c1daadde329eb4
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Thu Sep 28 13:49:44 2006 +0200

    Always call I830UpdateXineramaScreenInfo() unconditionally, and document why.

commit 92c5020bbd31e02c7224798a8f094d237afa19a0
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Sep 28 13:55:52 2006 +0800

    Fix picture's transform checking

commit 518802843284973f1f86132afd805c0e662e1ba6
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Sep 28 11:15:33 2006 +0800

    Fallback in mask picture for now
    
    Do it later after finish wm kernel program.

commit 25ff5baad95c205c7c690da72fc0f252b3ed9289
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Sep 28 11:09:52 2006 +0800

    Fix compile, add wm header file.

commit c3a49b5123d094280b5ff358ceef961958319ce4
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Sep 28 10:36:00 2006 +0800

    Add simplest wm kernel program for no mask picture composite
    
    This is a try to use new gen4asm language, and will finish
    composite program for mask picture with or without CA case later.

commit 6ea16bf6b06c8b3aed4d2c98679ab28304d1b56c
Merge: fdb6de6... b970166...
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Sep 27 16:38:01 2006 -0700

    Merge branch 'master' into modesetting
    
    This reverts most of the mergedfb code.  This will instead be done in device-
    independent RandR code.
    
    Conflicts:
    
    	src/Makefile.am
    	src/i810_driver.c
    	src/i810_reg.h
    	src/i830.h
    	src/i830_cursor.c
    	src/i830_driver.c
    	src/i830_modes.c
    	src/i830_video.c

commit fdb6de663579d3b9f31bf9e8a93430b8505ca73f
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Sep 27 13:59:41 2006 -0700

    Re-disable broken load-based CRT detection.

commit 1407a42c7378706644fd8be554b43b0e7b581011
Merge: 25890ec... 4bd3b89...
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Sep 27 13:33:23 2006 -0700

    Merge branch 'randr-1.2' into modesetting

commit 25890ecda9fd00fad9bc53dea83fc58e0013fcdf
Merge: 965609f... 117ff04...
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Sep 27 13:33:17 2006 -0700

    Merge branch 'acpi-hotkey' into modesetting
    
    Conflicts:
    
    	src/i830.h
    	src/i830_driver.c

commit 117ff04b504578a24dff70659e2db1b81aaa1177
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Sep 21 17:03:34 2006 -0700

    Attempt to make the ACPI hotkey support a little more modesetting-compatible.
    
    Previously, we watched for the BIOS to have changed the layout, and repaired
    the resulting configuration.  Now, we request that the BIOS make no changes,
    but leave a note in a register for when the key has been pressed.  When we
    notice this, we reprobe monitors and turn on/off the things we find.
    
    This is a temporary solution until we can get the hotkey hooked up as an
    input key to external applications to control the change using RandR 1.2.  It
    is also untested as neither of my laptops do anything with the hotkey.
    However, this code does result in many fewer BIOS calls.

commit fe691953f08b4d299295f91450412404ba42810b
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Thu Aug 31 18:35:10 2006 +0200

    Store viewport limits of both pipes in SAREA.
    
    This allows DRI clients to determine which pipe they should synchronize buffer
    swaps of each window to.

commit 06c5f7bd076e9ba4b925e061a40b837714bc8267
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Wed Aug 30 19:45:33 2006 +0200

    If the DRM can handle it, enable vertical blank interrupts for both pipes.

commit 89cbc6e215a5f313ccc17370424c35630cf75892
Author: Michel Dänzer <michel@tungstengraphics.com>
Date:   Thu Aug 24 10:30:27 2006 +0200

    Only enable the IRQ after DRIFinishScreenInit.
    
    This makes sure we've been assigned a context ID, so the interrupt context
    won't mess things up if it grabs the HW lock.

commit 185df8a18102eea79b8c8e11304dfee148ac2002
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Sep 27 16:48:43 2006 +0800

    Add mask sampler state

commit 1422d4f04ac2d57899eee91f6522f8670f7263da
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Sep 27 13:54:14 2006 +0800

    change some src sampler states
    
    sampler for mask should also be set up, and fix
    default border texel.

commit 6614b4bda2e079fd1e56e0825894481b80e2df58
Merge: d6ca9fe... b3ddcf3...
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Sep 25 12:04:01 2006 +0100

    Merge branch 'master' of git+ssh://git.freedesktop.org/git/xorg/driver/xf86-video-intel

commit d6ca9feb78a9211758510751bbf47013caabff49
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Sep 25 12:03:27 2006 +0100

    Fix bug #7943 where video flickers when changing
    attributes. This code was a leftover from testing lockups
    and shouldn't be needed anymore.

commit 52a4f2a02b8f38108bfa866bf74b1596b8125512
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Sep 25 14:35:51 2006 +0800

    Add file for i965 exa composite
    
    This does not include ps program, which will be added
    in g4a form.

commit f272f0d811f9ee059e8f8617a516e6c8bff917a1
Merge: ff202f8... b3ddcf3...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Sep 25 14:15:21 2006 +0800

    Merge branch 'master' into exa

commit 4bd3b89c73b6c5aa9b0eb553ad5d553ee0e8a489
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Sep 23 16:41:38 2006 +0100

    Oops, duplicated CRT-redetect code.

commit c34490bbda6604a21809d15c798607806fa6c725
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Sat Sep 23 12:00:43 2006 +0100

    Construct default monitor description for hotplug non-DDC monitor.
    
    When detecting a monitor that doesn't support DDC, construct a default
    monitor with "sensible" values instead of using whatever the builtin LCD
    screen uses. Clearly we need a way to set the monitor parameters when we
    cannot detect them.

commit 965609f6fa63e28e5a28128f5bc44f8c4d7b9f68
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Sep 22 09:51:45 2006 -0700

    Restructure i830_bios.c so we don't leak a copy of the BIOS per generation.

commit c52242c22779a51aa12b18a7a589080ce44c8484
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Sep 22 09:41:07 2006 -0700

    Remove some dead code related to clock ranges.

commit c2446be9b444b16c95f78dab17bf130f9f491ee2
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Sep 22 09:38:11 2006 -0700

    Remove the GetDevicePresence BIOS call which just printed BIOS information.
    
    Because we aren't using the BIOS to set modes any more, what the BIOS thinks is
    present is probably even less important than before.

commit b6ba268d0d5f22c6a18ce45416452fce83438620
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Sep 22 09:31:37 2006 -0700

    Remove the no-longer-connected VBERestore option.

commit 20956a5d6f1eb518717a680e58938f31461ca5e4
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Sep 22 09:27:30 2006 -0700

    Remove unused display{Attached,Present} fields.

commit 2cd28be71472d67956f47c7d49283ebabefa089a
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Sep 22 08:55:55 2006 -0700

    Remove empty SAVERESTORE_HWSTATE code.

commit ff202f8e2ae4117b464c94047001023d5d0531cc
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Sep 22 15:02:19 2006 +0800

    Fix a typo to mark sync for XAA.
    
    This should fix the scrolling screen corrupt in
    XAA method.

commit d87d1f5bb0475c6f651fcb7e2cab2a7d46edcc69
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Sep 22 02:20:35 2006 +0100

    Remove BIOS from non-BIOS related names.
    
    Lots of names included BIOS for no apparent reason; as we try to eliminate
    BIOS calls from the driver, these only serve to confuse us.
    (cherry picked from 8e5d280d94ad3d3ba3c75871c17abec9da62ed34 commit)

commit b3ddcf3348365873aed4a2b8b2750b330fb4cf26
Author: A Costa <agcosta@gis.net>
Date:   Thu Sep 21 23:18:43 2006 +1000

    Typo fix in man page (Debian bug #364559).

commit 4820caf46e050761d9b347b8a440381e1b1f4727
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Sep 21 01:47:27 2006 -0700

    Make planeEnabled track pipes controlled by randr.
    
    Also add code to deal with disabling pipes.

commit c11c445bdeac34253b48192a5d406b55ff8b2be7
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Sep 21 01:23:10 2006 -0700

    Consistently use Cursor A on Pipe 0 and Cursor B on Pipe 1.
    
    Mixing random cursors and pipes didn't work very well. I'm left wondering
    whether the palette stuff will work on pre-9xx series hardware though; it is
    special cased everwhere else.

commit 4a8b9515e914369e1faf1dca6b11204b233c73ee
Merge: 18a510b... bdca869...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Sep 20 22:46:55 2006 -0700

    Merge branch 'modesetting' into randr-1.2

commit bdca8697cc6ac5a98e0548b2ce2e0032e9bcfa52
Merge: d9db5ec... daade50...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Sep 20 22:46:42 2006 -0700

    Merge branch 'modesetting-origin' into modesetting

commit 18a510bf9af2f288c0e94359f672775d6e9c9ab2
Merge: f6500e9... d9db5ec...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Sep 20 22:45:48 2006 -0700

    Merge branch 'modesetting' into randr-1.2

commit f6500e94fec0d6db8c1f1350bee1d137bf06a09e
Author: Keith Packard <keithp@guitar.keithp.com>
Date:   Wed Sep 20 22:38:55 2006 -0700

    Update driver for RandR 1.2 X server API.
    
    This is not entirely what I'd like to see, but it's at least functional.
    
    Limitations:
    	Can't disable/enable crtcs
    	Can't move outputs on/off crtcs
    
    But, it does handle monitor hot-plug, detecting changes in VGA and SDVO
    status on-the fly. Which makes for good demo material.

commit daade50ca271d1cdf236bbe84afade85d4111ac9
Author: Linus Torvals <torvalds@osdl.org>
Date:   Wed Sep 20 12:07:09 2006 -0700

    Add standard C headers to fix build on some systems after xf86_ansic.h removal.
    
    This appears to have been hidden for others by header pollution in X Server
    headers.

commit 1681fe6bb041385e5aefb11baa9afd1f614abc5b
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed Sep 20 09:36:02 2006 +0800

    Revert "fix default tex wrap mode with clamp"
    
    oops, we've set border color to all zero, which should
    give us transparent in RepeatNone case.

commit d9db5ec6866555ec13ba3ddabb1516eb45637afa
Merge: cbaf3cf... e3f4caf...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue Sep 19 16:03:04 2006 -0700

    Merge branch 'modesetting-origin' into modesetting

commit 5adb05f0b82ee3a168142d803ab3434f75cf15a3
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Sep 19 17:14:05 2006 +0800

    fix default tex wrap mode with clamp
    
    we don't set any 'default' border color,
    default tex wrap mode should be clamp to edge.

commit e3ab89b0327ef6ff790ab53bba29c721aef032cd
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Sep 19 10:27:36 2006 +0800

    shader program fix for component alpha set
    
    If CA is set and blend op needs src alpha, the src
    value is not needed and should be (src.A * mask.X).
    This is found in handling exa magic two pass composite.

commit 37429c3ecb97df8faf0f3f56128d7a2b22eb8a5e
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Sep 19 10:08:31 2006 +0800

    misc cleanup

commit e3f4caf40708478ef327b029d0a75944c51ea905
Author: Adam Jackson <ajax@benzedrine.nwnk.net>
Date:   Fri Sep 15 13:51:18 2006 -0400

    Add model-specific tweaks for some funky 945GM boards.
    
    For the Aopen Mini-PC, ignore the claimed attached 800x600 LVDS panel.
    Likewise for the Apple Mac Mini, but done slightly differently since it
    shares PCI IDs with the Macbook Pro.

commit bd758030a6a59af32f9d73655cb691e018e94a7d
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Sep 14 11:12:03 2006 -0700

    Add a compile flag to enable syncing after each operation in EXA.
    
    This replaces other debug sync options sprinkled around the EXA code.  It
    doesn't change the mis-rendering of text on the 915.

commit f46c70e877a3432ba23696e1a16d5906183876af
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Sep 14 10:05:51 2006 -0700

    Add a note on maxX/maxY for the 2D rendering.

commit ce00db054bf0b7f62ff0be312d7e3470141922dc
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Sep 14 10:00:06 2006 -0700

    Replace a couple of mis-uses of the screen's bpp when the pixmap's was needed.

commit 71c2dd63361be9616c77db80a93445307d63dd41
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Sep 14 09:54:19 2006 -0700

    Replace duplicated sync code in exa with a call to I830Sync.
    
    The I830Sync version has additional code for the 965.

commit 564c830a91afda76706a8c4c2f3287d0b8d514e9
Merge: bf49084... b970166...
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Sep 13 16:34:10 2006 +0100

    Merge branch 'master' of git+ssh://git.freedesktop.org/git/xorg/driver/xf86-video-intel

commit bf49084ad700f064b732bf39a163209eee1d6845
Author: root <root@jetpack.demon.co.uk>
Date:   Wed Sep 13 16:32:39 2006 +0100

    bump max Xvideo height to 1088 to cope with some players.

commit 59ce4180b95270432540624a1fdf7ae8dd18a7f3
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Sep 11 22:57:23 2006 +0800

    reimplement Solid function
    
    Replace COLOR_BLT_CMD with XY_COLOR_BLT_CMD, by which
    device would care for direction and provide a (x,y) coord
    interface. This fixes pixmap artifacts even in no composite
    case.

commit 2b9c87bbf8ee5f7f56631114eb98303cd80e4a48
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Sep 8 11:14:05 2006 -0700

    Remove xf86_ansic.h usage.

commit b970166eab95ac024ff481b0f5fd9aaf3644aabf
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Sep 8 11:09:19 2006 -0700

    Fix a compile failure from the last commit.

commit 2b7602847aa7ae9b4e88fbea070710695d2cb8a4
Merge: e4cdc42... b45f4b5...
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Sep 8 11:02:41 2006 -0700

    Merge branch 'exa-origin' into exa
    
    Conflicts:
    
    	src/i915_exa_render.c

commit e4cdc42a98dd1be74e5c2bf5d9566f7449523b14
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Sep 7 10:32:02 2006 -0700

    Remove another debug printf.

commit 099be52a3bb52516fb5e8d56c154a4d6b6707e09
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Sep 7 10:28:09 2006 -0700

    Re-remove xf86_ansic.h, and move copyright to the top of the file.

commit 4ad577f83f7190df4d64e66fbf7c515ee6f411ce
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Sep 7 10:24:23 2006 -0700

    Remove the UTS/DFS implementations that just match the fallback versions.

commit 8b9d7a5f8560ee55ca5cb5376517a4246cd79fb9
Merge: 6500a3a... 1e6e288...
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Sep 7 17:45:57 2006 +0100

    Merge branch 'master' of git+ssh://git.freedesktop.org/git/xorg/driver/xf86-video-intel

commit 6500a3aa134e11a75b7ddaf7fff253003b223241
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Sep 7 17:45:28 2006 +0100

    When in MergedFB mode, fix offscreen memory allocation.

commit c378328ece701756ddca966eb108e2b1f5c3ed6c
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Sep 6 11:15:17 2006 -0700

    Remove a debug printf.

commit 1e6e288b8826789f3b2520d12426ff7852a67ccd
Author: Eric Anholt <eric@anholt.net>
Date:   Fri Sep 1 16:47:17 2006 -0700

    Add a check for intel-gen4asm, and rules to compile {wm,sf}_prog.h using it.
    
    This adds assembly source for the two programs used in the textured video
    implementation on the 965, which should make them easier to modify in the
    future. The compiled versions are also included, so that intel-gen4asm isn't a
    build requirement for people that aren't modifying these programs.
    
    There are minor differences in the compiled versions of these programs compared
    to their previous versions which were compiled with a different tool.  I
    believe the changes should be harmless, and video continues to work on my
    system.

commit cbaf3cf74bd420533d299c4113761ec536097e33
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Thu Aug 31 18:25:21 2006 -0700

    verbose debug message for panel sync data

commit 1feb733eb8b09a8b07b7a6987add5149c53b0157
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Aug 29 14:54:15 2006 +0100

    Fix bug with probing info of DFP2 and LFP2 connected
    devices (Aaron Ridout)

commit 26e6c074c17b2d4e9b9f165468ad45a3b0ecc0ef
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Aug 28 11:55:38 2006 +0100

    Fix SetVBlank to operate all the time

commit b45f4b54b189a496255ddae12af38fc4c4408a51
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Aug 25 16:23:18 2006 +0800

    Making render log a little quiet in normal

commit 6f0d352b83fc9f39dd86edbda9af83243b50c764
Author: Ross Burton <ross@burtonini.com>
Date:   Thu Aug 24 18:16:42 2006 -0700

    Bug #7957: Fix distcheck.

commit cc79b3ec19a7e858972228a270ef774041eb8946
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Aug 24 10:28:59 2006 +0800

    Current 915 render operations for 915G/945G only

commit 078af29fa65653c5322b006404f7ad29aec24cce
Merge: 7458a6a... ea63e82...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Aug 24 10:23:22 2006 +0800

    Merge branch 'master' into exa
    
    Conflicts:
    
    	man/i810.man
    	src/Makefile.am
    	src/i830_accel.c
    	src/i830_dga.c
    	src/i830_driver.c

commit ea63e82ef417a9918e7d7105910a8ddeba2994f6
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Aug 22 16:40:08 2006 +0100

    fix typo

commit b7e57deebbda527e878326cf3e6358c0a48d7817
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Aug 22 19:38:13 2006 +0800

    pci id update for Crestline
    
    The "Crestline" banner should be replaced with official
    name later.

commit dc4128ea0781124984dee0cb41e7b6ee87e362a1
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Aug 21 12:13:42 2006 +0100

    remove GL* usage

commit dad0e7fc09fa7794f20278d9d99abd96a21b691e
Merge: 361c49a... 43daaec...
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Aug 21 12:08:01 2006 +0100

    Merge branch 'master' of git+ssh://git.freedesktop.org/git/xorg/driver/xf86-video-intel

commit 361c49ad3cfe58b9ab98dfb6e95de505c0d63730
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Aug 21 12:07:29 2006 +0100

    Fix bug #7930, i810 doesn't compile without DRI
    (Samuel Thibault)

commit 43daaec63929c1f0e54a5125375d8147629da4b9
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Aug 17 15:57:31 2006 -0700

    Bug #7905: Mark DRI state as dirty in 965 textured video, fixing hangs with 3d.

commit cdcc6f23e8cad797e6cfd57e2ff454ec8509b5ba
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Aug 16 17:16:28 2006 +0100

    Disable device check when mergedfb in operation.

commit a94c96abf90c691faecbebf0c8d08f8010bc67ef
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Aug 16 17:15:26 2006 +0100

    Fix bug #5150. Disable LVDS usage on i915G, i945G and i965G.

commit 2a4e486d2990af433e915cfa26dc57cae02e01b7
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Aug 11 11:07:08 2006 +0800

    Fix undefined alloc type for agp memory
    
    This shuts up the nonfatal warning that type 3 for alloc agp
    memory is undefined for intel-agp.

commit 4cfed93df6b23903704348cafe050a6546e84479
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Aug 10 15:41:32 2006 -0700

    Bump to 1.6.5 for release.

commit 38e7e48418cd48a46e48f5bc8a6547721db8f76d
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Aug 10 15:38:14 2006 -0700

    Fix README typos from in the generated file.

commit 975e60261088dee124b329d28c64e508bce1f90b
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Aug 10 13:49:43 2006 -0700

    Bug #7829: Fix reported driver version.
    
    The driver now reports itself as the PACKAGE_VERSION from autoconf.  The DRI
    DDX -> client interface version is dissociated from this so that we can do
    appropriate major/minor versioning of the interface that's not tied to the
    package version.  Bumped the i830 ddx dri version patchlevel to note the
    fix in the previous commit.

commit 820e9a22fdb759cbdaac4a488322825bc0908b0d
Author: Eric Anholt <eric@anholt.net>
Date:   Thu Aug 10 13:37:18 2006 -0700

    Bug #7835: Restore unused fields in I830DRIRec to avoid i915 DRI breakage.
    
    As it was, 1.6.4 broke compatibility with the released DRI driver.

commit caa3b35cd772fc75d65a7ff791f00addbb39a764
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Aug 9 16:11:30 2006 -0700

    Correct typos in README source.

commit 2a7426cf138e518a5eafb40f478359160a7ec98b
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Aug 9 15:47:09 2006 -0700

    Clean up warnings.

commit 24e59a0daa20b7c3e5028c9ca7972052801d02a1
Merge: bb60807... 32f1199...
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Aug 9 14:19:06 2006 -0700

    Merge branch 'textured-video', bringing in fixed-up i915 textured video.
    
    Conflicts:
    
    	src/i830_video.c

commit bb6080735efc40e103e92b65d0c2f1f729156632
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Aug 9 12:21:16 2006 -0700

    Bump to 1.6.4 for release.

commit 3ca14275d13b1261b69b0e3fda90a112cb567472
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Aug 9 10:35:57 2006 -0700

    Add missing headers to i810_drv_la_SOURCES

commit 309374f78df35207b1398e14bba986fb891f3643
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Aug 9 10:30:41 2006 -0700

    Use double quotes to avoid sgml syntax error

commit dca9f856ca21e63abeb87e4ef2c40944c26d4429
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Wed Aug 9 10:29:59 2006 -0700

    Reformat README

commit b19ea222727ed47b69d28a03242c09d3a6ab2673
Author: Eric Anholt <eric@anholt.net>
Date:   Wed Aug 9 10:01:29 2006 -0700

    Update the README.sgml file for the upcoming release.

commit f8b47f607297e0591b63e5f25296af07ee74f433
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue Aug 8 16:19:51 2006 -0700

    Update manual page to include i945 and later details.
    (cherry picked from 7833d0733bc146cf1ae7f588516c49797886b396 commit)

commit d150b53d102c511f3c9245ef1f6fd36c12b01ca3
Merge: bb65a4d... bc5f565...
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Aug 8 15:51:58 2006 -0700

    Merge branch 'i965', adding i965G support.
    
    Conflicts:
    
    	src/i830_cursor.c
    	src/i830_driver.c

commit bc5f56568021d8c63313e2b6bf30710e7516c04a
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Aug 8 15:48:04 2006 -0700

    Intel bug #49: Fix video output at 32bpp by using B8G8R8A8 instead of B8G8R8X8.
    
    While here, don't overallocate video memory for the i965G state.

commit c3b3d479788fcea7e543f29acf83c85b8b148fbe
Author: Alan Hourihane <alanh@tungstengraphics.com>
Date:   Tue Aug 8 15:28:14 2006 -0700

    Intel bug #35: Fix accelerator syncing with DGA.
    
    Fixes glitches seen with Mark Vojkovich's "texture" demo.

commit bc12208f6e145ec29c3ebe38ae04dc2ebca1b4cc
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Aug 7 13:27:00 2006 +0800

    Disable error register dumping in dri TransitionTo2d. This's for
    debug which might confuse QA.

commit bb65a4dc55b416437d61ccbee8b6056fe8e08357
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Aug 8 14:51:18 2006 +0100

    bump to 1.6.3

commit 37644293da751bfc7268c9fc74ecda1044607dee
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Aug 8 14:42:32 2006 +0100

    check for xineramaproto

commit 3661d4df86db012682ab4b393287aa02e9fc8453
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Aug 8 12:25:03 2006 +0100

    Re-enable monitor detect after a few fixups.

commit 995b142f510d1daab3914d336f3c0d017a043b41
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Aug 8 12:01:39 2006 +0100

    Disable detecting of new monitors on VT switch.
    It's doesn't always work. The modesetting
    branch will deal with hotplug displays correctly.

commit 8e5844bbf9c8880c9eb6eff29b6db2db06b01933
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Aug 8 11:43:10 2006 +0100

    bump to 1.6.2 to indicate mergedfb support

commit 421b415e23c1ddc78837cd222167d6ed71a3ef88
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Aug 8 11:28:42 2006 +0100

    Fix a build problem.

commit e4f63eaf5efb654121db148f2f8e32cc3b23b6b5
Merge: 633a683... e26f3e3...
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Aug 8 11:07:56 2006 +0100

    Merge branch 'master' of git+ssh://xorg.freedesktop.org/git/xorg/driver/xf86-video-intel

commit 633a683a4adcb9a44a54519fd7ff66aab2d12f97
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Aug 8 10:23:29 2006 +0100

    Ensure palette is updated in mergedfb & clone modes

commit 71e3e2d4e3b2a2c538fe6f1cea41f442fdb8d756
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Aug 4 20:39:50 2006 +0100

    Fix a problem creating the I2C bus for the SDVOC
    interface, due to a name match with SDVOB.
    
    Bus names must be unique.

commit 0fd4831fdcf4c8f43d80c66e43eff8942f89b324
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Aug 4 00:21:53 2006 -0700

    Disable dynamic front buffer mapping on i965.
    
    Moving front buffers should only be necessary for rotation.  Currently, the
    server isn't ready for it, and the method attempted to work around it caused
    crashes with DRI.  Since i965 doesn't support rotation yet, this should be
    harmless for now.

commit 8d0a5138503586cbf980eb9464f2db91b72509c7
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Aug 3 19:16:59 2006 -0700

    Add parenthesis so that IS_I965G doesn't make the test pass for 8-bit.

commit aa69018c01d2fa963fb940718dbd653d6ca2c9eb
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Aug 3 19:12:15 2006 -0700

    Turn off video debugging now that it appears to work fine.

commit d15f87110807111ab7d71f1254ebe3dfef1fee80
Merge: a79aa0d... d56ffa5...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Aug 3 19:08:34 2006 -0700

    Merge branch 'broadwater-video-rehash' into i965
    
    The previous merge wasn't done on a synced-up tree, and missed necessary
    changes.

commit a79aa0d7b27b0b9b032472776d7dda410fd66a98
Merge: 760021e... f9e94c1...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Aug 3 17:58:56 2006 -0700

    Merge branch 'broadwater-video-rehash' into broadwater
    
    Conflicts:
    
    	src/Makefile.am
    	src/common.h
    	src/i810_driver.c
    	src/i810_reg.h
    	src/i830.h
    	src/i830_accel.c
    	src/i830_cursor.c
    	src/i830_dri.c
    	src/i830_dri.h
    	src/i830_driver.c
    	src/i830_memory.c
    	src/i830_rotate.c
    	src/i830_video.c

commit 760021e3983f7783900075b8c9603bd4fbe7e0a2
Author: Alan Hourihane <alanh@tungstengraphics.com>
Date:   Thu Aug 3 17:08:39 2006 -0700

    Add current Tungsten Graphics code drop for i965 support.

commit d56ffa5f35e3cf4262d66469052b2122fdb24027
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Aug 3 16:03:50 2006 -0700

    Bump PS_MAX_THREADS to 32 now that the program doesn't fail.

commit 4525379d95ff292d7322e1a7a516c0bedd1f7543
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Aug 3 16:03:15 2006 -0700

    Make the sampler's payload be the WM payload rather than uninitialized data.
    
    The sampler's payload happens to be in the same format as the WM payload,
    though most of the fields are ignored.
    
    This appears to fix the program in the presence of multiple PS threads.

commit ad2c70b4121121f1fb53190ea49edf2323c804a9
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Aug 3 12:47:19 2006 -0700

    Remove some stale XXX-prefixed comments.

commit f9e94c17c55e4c75802d8574c908744e286e7843
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 21:18:19 2006 -0700

    Set the WM scratch space that we had already allocated.
    
    It appears to be required, even if the kernel doesn't use any scratch space.

commit aefa6fdfc5300546caeb64ace14a7854d3dc7dae
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 21:14:14 2006 -0700

    Clean up GRF allocation (which was wrong at 16-register boundaries).
    
    Also use PS_MAX_THREADS rather than hard-coding 1 thread, and remove the dead
    SF_KERNEL_NUM_URB macro.

commit 7a64e14624514ef31f6fa9f15e8804c45f930212
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 20:48:13 2006 -0700

    Crank down the SF allocation and comment on why this is a fine lower limit.

commit bc6a2bb7576a7c1e7971f6d1e0b893b2ada1aaa3
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 20:34:57 2006 -0700

    Remove the clip URB allocation.
    
    Previously, the VS was misconfigured and exceeding its allocation, which the
    (unused) clip was providing padding for.

commit defe2795429484ffe4c1438bafb86bb5e5469ba9
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 20:32:41 2006 -0700

    Correct the VS setup, and allocate a correct, minimal number of URB entries.
    
    The VS number of URB entries and URB entry size are always used, even when
    the VS is disabled.  Similarly, the cache enable bit is always used.

commit b57ccb682cb3dea3e26c6f1b0c709e63dfde0d31
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 19:46:15 2006 -0700

    Replace the SF max threads setting with a define for easier tweaking.
    
    Tweak it to 1 for now.

commit 82037a12758c41a304f2e0bbd033d3345cccbe1a
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 19:33:28 2006 -0700

    Remove CS URB allocation since we don't use any constants.

commit 1d45668d7a42bfa5d7f5bfb68d8bae38bda0936b
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 19:18:20 2006 -0700

    We only need 3 vertices to fit in the URB, since we only dispatch 3.

commit a076d35bed6f13cf943a0f8948176aa0c999e2da
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 19:16:03 2006 -0700

    No GS URB allocation is necessary when the function is disabled.

commit befa655168fb8dcb6806592eb44f7ac49f191822
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 19:11:38 2006 -0700

    Reduce URB_VS_ENTRY_SIZE to 1 as our vertices are under 8 floats.

commit 33acbdca0a0f82725e5bf7887b325726403a6ffd
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 19:09:19 2006 -0700

    Remove the VS kernel and binding table.
    
    The VS URB entries have to remain as they're used to store the VF output which
    isn't modified by a VS program.

commit aafa48cb85cd03c735fb968a4275c19e1a68cd02
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 18:26:26 2006 -0700

    Fix wm prog to correct the ordering of the Cr and Cb channels.

commit bc2c842d93de04d48c7de60482814db346bd0b78
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 18:10:01 2006 -0700

    Allocate space for the 965's state at the end of the video buffer.
    
    Fixes corruption in the first few lines of the video.
    
    Based on 1b506798d98d911be733543da2c40cb451a28912

commit 524460ea1f02bb6e8e2239d7763334666012cec4
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 17:47:55 2006 -0700

    Updated WM kernel to load video and do colorspace conversion.

commit ba896c779c697e1d7458028798ec49013bd9da9f
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 17:47:37 2006 -0700

    Updated grf/urb state for WM.

commit e5c572f841b626b8b6f21a6966a33956d3b0b35b
Author: Adam Jackson <ajax@benzedrine.nwnk.net>
Date:   Wed Aug 2 20:47:12 2006 -0400

    Fix a braino in mode list pruning.
    
    Interpreting the size of the display in centimeters as the size in pixels,
    and then clipping the modes list based on that, rarely does what you want.

commit 21b62df7c34217be5dd95985c35e33be11c25846
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 17:36:49 2006 -0700

    Move the WM kernel to a separate file.

commit 5d3424492f9586a4c5a28962a9757f48f2c12e83
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Aug 2 17:34:12 2006 -0700

    Replace SF kernel with the one from broadwater-video HEAD.

commit 7458a6adb5ea62f56bb3d4ab19ad7d1aa6ad2d19
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 31 10:09:17 2006 -0700

    Move MAPSURF_XBIT settings into the texture formats structure.

commit 7ea74843bbdbf54b6804727be9b41d26832c8f76
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 31 10:06:34 2006 -0700

    Whitespace cleanup.

commit e71108f1e05b7a8d8edd174eb64edd6cccacbcdc
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Jul 28 10:32:12 2006 +0100

    Fix DGA with MergedFB
    Turn off rotation support when MergedFB enabled

commit a91a4f95c664f6905fef61dab251707bf2548bb8
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Jul 27 16:11:48 2006 +0100

    Fix pipe reversal for Xv

commit ac3ad32f667b306e771617d784648f7111743f1a
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Jul 27 15:28:42 2006 +0100

    Calculate allowable refresh rates on the private
    mode data for each independent screen in mergedfb.
    
    Lots of other fixes too.

commit 30952e58ed83e2e18d1007f662d2cc9a773c876c
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 26 13:42:12 2006 -0700

    Limit drawing to the destination pixmap's boundaries, not the screen's.
    
    This shouldn't matter, as miComputeCompositeRegion shouldn't giving us
    anything that would draw outside the bounds, anyway.

commit cffd2cd36d0437b38ac8164d66ea71be50b19330
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 26 13:22:51 2006 -0700

    Fix hangs when compositing with a mask.
    
    The modify bits in the mask field for sampler/map state appear to actually
    be enable bits.  So, prepare the state values in I915TextureSetup,
    then write the sampler/map state out all at once in PrepareComposite.

commit 96754b822df7ac110a70b2d08dda2ebb299772be
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 26 13:19:12 2006 -0700

    Fix a couple of typos from code review.

commit e786e2f9f3a4df31702736db6f68a44c9ebba546
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Jul 26 16:45:38 2006 +0100

    When detecting new monitors in mergedfb renew the modepool.

commit 8e6e990db34d63174670512f494fa9adb44786f5
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Jul 26 10:48:47 2006 +0100

    Update Xvideo to deal with MergedFB modes.

commit e26f3e30b30a57ab4aad0267d689a9a5d7a5e877
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Jul 26 09:17:52 2006 +0100

    Fix a build problem

commit b919db75d2f6dc1019f981534b0d5d87c6029727
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Jul 26 09:07:19 2006 +0100

    Bump to 1.6.1

commit 9c93d1498fa2363c52ef7fbe97d781560f67acf5
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jul 25 21:17:05 2006 -0700

    Oops, partial revert of last commit.  Some were obviously not NOOPS.

commit 38d1a5e0dbe059f5c01bd5120a108a386ff10718
Author: Eric Anholt <anholt@leguin.anholt.net>
Date:   Tue Jul 25 21:09:12 2006 -0700

    Replace some OUT_RING(0)s with OUT_RING(MI_NOOP) to remind me why they're there.

commit fd19b12793f09b6714468556ace875ef36ed9e1c
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jul 25 11:14:11 2006 +0100

    Add mergedfb support to the intel driver with
    additional pseudo-Xinerama support.

commit aec88cf4c66833f89afa5f8fa4f8bcf30b2b6b4b
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Jul 24 15:46:19 2006 +0800

    remove crap blit in UploadToScreen, we should find a more
    efficent way and implement blit correctly.

commit 32f1199937e92b9100aba52cbbb97157014e3182
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon Jul 24 15:42:15 2006 +0800

    remove an extra '-'

commit 02c5c4cd1dd44058d80ec23cccfd45a13bc3bb2c
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Jul 21 12:54:06 2006 +0800

    add copyright info

commit 4f0ad337098eb0bacb1c11bc61d780ac18041e1d
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Jul 21 11:59:04 2006 +0800

    fixup segfault in xaa when xaa not initialized in i830WaitSync.

commit 914327f40d07a3f7c069752ce005bf8e21352b03
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Jul 20 17:58:07 2006 -0400

    Disable drawing to PICT_a8, and turn on support for non-extended repeats.
    
    We don't know what COLOR_BUF_8BIT does, so it's disabled for now while we're
    stabilizing the code.
    
    The non-extended repeats appear to be working according to the rendercheck
    tests on a8 and a8r8g8b8 sources.  Masks continue to hang the card, as before
    this change.

commit 45cb032e2b7ac1e4c765fc29a2e4dd0cef19066d
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Jul 20 17:34:50 2006 -0400

    Use MT_8BIT_A8 so PICT_a8 expands to (0,0,0,a) not (a,a,a,a)

commit fd6d825ae0780f3daf436f4224bf5f177cb8630e
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Jul 20 17:25:31 2006 -0400

    Move ss6 setting with other immediate state, and ensure that stencil is off.

commit d6d6a44c66446f34b57394e5ea9a8e32917f7569
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Jul 20 11:23:05 2006 -0400

    Try to fix up the basic RepeatNormal and RepeatNone support.
    
    With RepeatNone, access outside of the drawable should return 0 alpha values,
    which is done by using the border color.  For RepeatNormal, we use the wrap
    mode (which requires that we use normalized texture coordinates).

commit 2b2173c618c080b1678990d65fe49b52bd8001b4
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Jul 20 11:15:18 2006 -0400

    The pixmap's drawable x/y coordinates are always 0, so don't bother using them.

commit 9f1cec83e0aef36c7d3482e62e8f01595f1fd076
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Jul 20 11:05:49 2006 -0400

    The vertex data are all floats, so write the dest coords as floats.

commit 4737955a62c39177e7a7ce7749a2f20e111afc68
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Jul 21 01:02:38 2006 +0800

    move i830 default coord set into I830EmitInvarientState

commit a7e30bb051bc03063fe699473610a57054a64973
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Jul 21 00:56:58 2006 +0800

    Take from i915, blend ctl code cleanup.

commit ac34a37cb60d763cbd99b6e2f6fdcb639592b99b
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Jul 21 00:52:59 2006 +0800

    Take instruction fixes into i830, with indent changes.

commit 3e86bf4273241daa23645f5a8104913e4205a74b
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Jul 20 13:43:27 2006 +0800

    remove i915 default ctx setup.

commit 5c945bf9eb9f5bedd34d98dcc7abc3f1ea3cb962
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu Jul 20 13:40:39 2006 +0800

    Revert "Fix several size error with STATE3D_LOAD_STATE_IMMEDIATE cmd."
    
    This reverts commit 433cb6ba82698676f6f72e09834aba4d64611d54.

commit d5243d1b35ab1db608c81889819e4d4d87048154
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 19 19:27:53 2006 -0400

    The height and width of texture maps are one more than the programmed values.

commit 13e372c2095fde94ae41bea959fba0ad95a59c08
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 19 16:42:57 2006 -0400

    Fix the texture map pitch setting as documented, and as used by the 3d driver.

commit da5efb09d55291ce5bcabff7db8d1490bb5e838b
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 19 16:36:52 2006 -0400

    Fix the alignment padding fix (didn't bump BEGIN_LP_RING count).

commit 36aa43bf73ee1268f0a250788eb637a4123f08eb
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 19 16:22:46 2006 -0400

    Force texture alpha channels to 1 if not present.

commit adce6bd0fc9533156da09da7d029ba0d76606b4f
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 19 16:21:49 2006 -0400

    Add a trailing MI_NOOP to frag shader output for alignment if necessary.

commit 4e409ea44180f7ef2780d70c9d2f54629bbd0fc3
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 19 15:57:09 2006 -0400

    The map bits per pixel must come from the drawable, not the visible screen.

commit 449e4be503c8b938d5bd46ee810244f8bcf54ceb
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 19 13:34:06 2006 -0400

    Correct the DWORD count of several 3D instructions.

commit f1b62d890ca22e12d61f7ef67bc4e35d68cde019
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 19 13:02:24 2006 -0400

    Replace hand register setting with new i915 fragmet program API.

commit 76a316d0cec92a04c8735926a76e76c21f960d7e
Merge: 433cb6b... 8480516...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 19 12:31:36 2006 -0400

    Merge branch 'master' into exa
    
    Conflicts:
    
    	src/Makefile.am

commit baf65ce98abcdd21dff2531a43bb9c5044732c28
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jul 18 19:42:37 2006 -0400

    Re-convert i915 video to new fragment shader API.
    
    Although in the history of this branch it had happened before, this time it's
    for real.

commit bb81e8d6c777a5e16b8193c07667fbee8e21203e
Merge: 2a1b3cf... 8480516...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jul 18 19:23:21 2006 -0400

    Merge branch 'master' into textured-video
    
    This moves the i915 textured video implementation into i915_video.c to avoid
    conflicts in register definitions with i830_reg.h when we use i915_reg.h.
    This also means that i810_reg.h's i915 3D regs definitions are removed and
    replaced with i915_reg.h usage.
    
    Conflicts:
    
    	src/i830_rotate.c

commit 84805167ab8a422966355b9753bfcb4dad802413
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jul 18 18:27:10 2006 -0400

    Convert i915 rotate code to the new fragment program API.

commit 5176d62ba58c100c87f75a4f333d00129d780c99
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jul 18 16:18:18 2006 -0400

    Add an API for programming i915 fragment programs.

commit 148ef9bdd9e0ef3e7ac86b56a8662b53a3ea9168
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 17 22:32:25 2006 -0700

    Convert magic numbers to symbolic names in i915 rotate code.
    
    This doesn't cover the fragment shader yet, which we need to make a sensible
    set of macros for (at least the basic bits).
    
    Reviewed by:	md5

commit 433cb6ba82698676f6f72e09834aba4d64611d54
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Jul 18 17:00:50 2006 +0800

    Fix several size error with STATE3D_LOAD_STATE_IMMEDIATE cmd.
    Issue texture coord set with proper scale value.

commit 855a9f13cb7fd4f6c489ff280bf389475bbd9bbe
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Jul 18 10:02:47 2006 +0800

    fallback in 'repeat' case for now

commit a6d438ebe3cf141a0331e0cd55eb9b5e137a5e37
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Jul 17 14:11:19 2006 -0400

    Disable spread spectrum clock usage.
    
    The spread spectrum clock generator that improves EMI characteristics for
    laptop screens lives in an external chip that is programmed over an i2c bus.
    Without correct programming, attempts to use this mode for the LVDS can
    result in a DC signal being sent to the panel.
    
    Until we find programming information for this external chip, we should
    leave this mode disabled.

commit 16d6263e6518a4a05562e2842ff2d0fdb4710304
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Sun Jul 16 20:39:52 2006 +0100

    whoops, reverse part of that.

commit 2f50f6d1b1b3fa4fbec98bd8fa5818df890070e7
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Sun Jul 16 20:17:38 2006 +0100

    move ContextMem out of XF86DRI

commit c7083a267209c93b2a91ef00dea2ca840400d160
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Jul 14 13:23:40 2006 -0700

    Bug #7404: Only save/restore VGA fonts and not other VGA regs.
    
    This fixes a hang on the i945 during restore.  It appears that saving/restoring
    the VGA registers is not important, as we're correctly saving/restoring the
    registers we touch within the driver anyway.

commit 49b827605628d3e1a6d4d41447cf46c5f38cc0c2
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Jul 14 14:23:04 2006 -0700

    Add a register restore implementation so we don't crash on LeaveVT.
    
    We shouldn't ever need to save/restore the hi/lo frequency regs, as they're
    read-only.

commit 6a92a779646ec03a03a3b1f45170b2e705ce8934
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Jul 14 14:20:41 2006 -0700

    Don't try to probe on more pipes than we really have.

commit 04d1584737fd0d14e99608a97281fd7b1549ae0e
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri Jul 14 16:14:18 2006 +0800

    Current exa render implement for i830 and i915, test on
    865GM and 915G. There is issue in picture 'repeat' support.
    And also stop recursive behavior in I830WaitLpRing to allow
    server to abort instead of system hang.

commit de470aaf5c47f4d2b0f477ac678039ef43af773d
Author: Adam Jackson <ajax@benzedrine.nwnk.net>
Date:   Thu Jul 13 19:10:11 2006 -0400

    In I830xf86SortModes, catch cases where two modes are equal in only one
    dimension, by comparing the areas of the modes.  Otherwise, 800x600 would
    sort before 1024x600 if it was added later.

commit 22843830ebdd14247aa76d19f89494a56e2ac887
Author: Adam Jackson <ajax@benzedrine.nwnk.net>
Date:   Thu Jul 13 17:20:17 2006 -0400

    Fix a thinko; would only inject the FP native mode if a mode list was already
    found, which is never the case when there's no xorg.conf.

commit 05bcbadd130524694e11e372d54cb419cea566cc
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jul 11 14:05:38 2006 -0700

    Avoid NULL dereference if cursor position changes during a mode change.

commit b65f18b05a5fba506b71293b495cab95197037ac
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jul 11 13:29:57 2006 -0700

    Bug #7443: Respect the user's Modes configuration, and make it more useful.
    
    Now, mode names generated by DDC get names of the form "WIDTHxHEIGHTxREFRESH".
    The matching for user Modes lines takes the user Modes as the prefix that
    needs to match, rather than an exact string match or "WIDTHxHEIGHT" match.  So
    one can, for example, specify "1024x768" to get any old 1024x768, or
    1024x768x60 to get one of the modes named 1024x768x60.

commit 5a2e04bd1b700a8a6e26136b8831ef5e4d11b565
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jul 11 10:21:51 2006 -0700

    Fix crash with DDC when there are no user modes to add.

commit f9499a68da0ce459fed0b29b998678fd81898a51
Author: Luká\u0161 Hejtmánek <xhejtman@mail.muni.cz>
Date:   Tue Jul 11 10:13:18 2006 -0700

    Make gamma settings apply to the cursor as well, and fix clone-mode gamma.

commit 7068468ac1951bfca0071bb9b1a99df4f37368a0
Author: Luká\u0161 Hejtmánek <xhejtman@mail.muni.cz>
Date:   Tue Jul 11 09:51:26 2006 -0700

    Add support for adjusting saturation value of overlay video.

commit b1c2ea653502dd8547079e7014b698f241433dff
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jul 11 08:13:30 2006 +0100

    whoops, revert some unnecessary changes

commit 8a44a7acfcadbba2410dca750afc9d32bc83706e
Merge: 584b544... e7723a4...
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jul 11 07:41:27 2006 +0100

    Merge branch 'master' of git+ssh://git.freedesktop.org/git/xorg/driver/xf86-video-intel

commit 584b544987be5cf23dce29ddaf3130e59cfe6fa8
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jul 11 07:40:40 2006 +0100

    Add an additional check before rotating

commit b912bf5673e38e03b0b25c2f5d05fe7e26994ba1
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 10 18:35:20 2006 -0700

    Clean up warnings in sil164 module.

commit d75490701cdbf2ab6eab82eaa078790a5fe0aea0
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 10 18:21:04 2006 -0700

    Hook up SiI164 mode setting (just a matter of turning the chip on).
    
    Also adds register dumping in case this turns out to not be enough, and fixes
    a couple of prototypes.

commit 426d26ea446d646fa8f561ea0e03c8e4a2c0c315
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 10 18:19:51 2006 -0700

    Fix prototype for SaveRegs.

commit 8d7987d00242020d29a2574ac0c8b6e55cc22112
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 10 17:34:57 2006 -0700

    Move to 4-space indents in sil164.

commit f5a01a2ef02125611d5fb74c20d53d52e544701a
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 10 17:17:51 2006 -0700

    Make DVO code light up my sil164-based DVI output, when already set up by BIOS.

commit 23a0ee73bce12f9e0b881af420413aeec4c0517f
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 10 17:16:18 2006 -0700

    Fix modelist with a configured monitor to not begin with all unvalidated modes.

commit 48ba9273ddfb36d3525e19238b94b18c56667c4d
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 10 15:01:51 2006 -0700

    Fix validation when the first mode is thrown out, and print hsync in modelines.

commit 3924ffb7d7b71cb9c6ab9eeb12d0f1b2c26244c0
Merge: 5a8f6a4... f76f94a...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 10 12:12:38 2006 -0700

    Merge branch 'dvo-merge' into modesetting
    
    Conflicts:
    
    	src/i830_driver.c

commit f76f94a743505da16e121992eb789c1f74eb7673
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 10 12:04:09 2006 -0700

    Supply proper NULL-terminated symbol lists to avoid crashing.

commit 5a8f6a486d79f50d2d659e615283289d59f9caa4
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Sat Jul 8 15:26:19 2006 -0700

    Improve output bus setup to include LVDS setup for pre-i915.

commit df333cc9a848bc2299a52a7613fe4ffdff8038a2
Author: Eric Anholt <anholt@leguin.anholt.net>
Date:   Fri Jul 7 13:41:33 2006 -0700

    Initial add of DVO support code.  Probes my sil164.
    
    This is a mostly-untested merge of airlied's work.  The I2C modules are intended
    to be moved into the core server or a separate driver module when they're
    functional and we're happy with the API.

commit e1064f52b0ff69ea7937897b8c951cc3e32cd752
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 5 16:00:03 2006 -0700

    Don't try to probe modes on an SDVO device with NULL sdvo_drv.

commit ffa6ecc18bc54151061d9956f1d12575fc057da3
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jul 5 14:41:08 2006 -0700

    More fixes to "choose closest mode for the pipe" code to select correct refresh.

commit dfd7fef457c048c9f0d826e37d91453d9e1485b9
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 3 12:01:57 2006 -0700

    Bug #7375: Don't double-free the current XF86 mode after a randr reprobe.

commit 5d07ebdf4f23e16fb8f60eafeadc947701e7877c
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jul 3 11:59:21 2006 -0700

    Only override display size with the XFree86 mode's for actual panel scaling.

commit 48f27ac62128251640a9b1ca54f63376676b47eb
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jun 28 15:07:01 2006 +0200

    Replace i830InjectModes with i830DuplicateModes usage.
    
    The remaining functionality of DuplicateModes was OBE, and the name was bad.

commit ce5bd108c55d2378db072617c380514a39672603
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jun 28 14:21:49 2006 +0200

    Validate and insert user and VESA standard modes for DDC or configured fallback.
    
    This isn't really tested because I lack a good CRT to test against currently.

commit 367f69f8e7710e53dcd286f1b62506a3276e80f9
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jun 28 13:10:02 2006 +0200

    Replace xf86ValidateModes usage with a set of custom validators and pruning.
    
    This moves us to maintaining MonPtrs per pipe instead of using the EDID
    structure "xf86MonPtr", which is closer to what we want to be looking at when
    doing validation.  The new validation isn't enough yet -- particularly, we
    aren't importing and validating the custom modelines to the pipes when
    applicable, but this will be easier than (for example) trying to make flat
    panel modes pass xf86ValidateModes through various gross hacks.
    
    Hotplug turn-on/off also happens at SwitchMode time now, instead of at randr
    probe time.

commit 9fbd3d8f4befb75ed6f6bd9a9ffe0175626e8785
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jun 27 23:31:40 2006 +0200

    If the panel power registers are all zeroes on Mobile parts, disable LVDS.
    
    This is the case on the Mac mini, which is an i945GM but has no LVDS attached.
    Powering on with the power timing registers zeroed would probably be a bad idea,
    even if there was a panel attached.

commit 56f7aedd0ad1f5645a90a5509b1263ec6b7b7ee1
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jun 27 00:37:56 2006 +0200

    Fix randr current mode reporting and mode loss/mis-configuration on re-randr.

commit b85f268051a785f90e4c55bd1cac80d673388f16
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 16:26:58 2006 +0200

    Fix remaining warning.

commit 6a3f89f4b6035534c7b93a4c05fd704305349785
Merge: 3cdc537... e7723a4...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 16:25:58 2006 +0200

    Merge branch 'master' into exa
    
    Conflicts:
    
    	src/i830.h

commit 3cdc53797bf6fdbfbcb53e07b269a5071f5ec97d
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 16:23:55 2006 +0200

    Fix build with new EXA headers.

commit e7723a4e5725147d3bd9ba22c5a3314b0556e440
Merge: 5111b88... dae9cb7...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 16:04:33 2006 +0200

    Merge branch 'origin'

commit 7104b915da412a26661bab7b5a940e935e8cbc8a
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 15:11:13 2006 +0200

    Clean up warnings.

commit 21dc3edfc41987bb8cf0f8d265fba9775cbe8cdb
Merge: f113e90... 5111b88...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 15:06:42 2006 +0200

    Merge branch 'master' into modesetting
    
    Conflicts:
    
    	src/i830.h

commit 5111b883480a5a9cc82200f2684cba67b515aa73
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 14:53:10 2006 +0200

    Turn on extra warning flags for GCC, and clean up the resulting fallout.

commit f113e9002cf53510e30984f816d44b06f1e71216
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 12:54:30 2006 +0200

    Fix the plane/pipe disabling and turn off missing outputs when no longer DDCed.

commit 0e5cda3796ba0164496f0814eb57d1dfa7ab9257
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 10:30:46 2006 +0200

    Fix FP scaling by using the desired mode to get at the real [HV]Display.

commit 51d14f803aae6d0a738520c3cad110289ee444db
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 10:21:23 2006 +0200

    Add a function to turn off unused outputs, DPLLs, planes, and pipes.

commit d2c18d8d79596513149273e4a0d322f04bf27e80
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 10:15:11 2006 +0200

    Fix DDC probing after last (untested) commit.

commit 6d1d105d68d9c25890c3fd2ebad1367529c2a991
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 10:14:27 2006 +0200

    Unset pipe current mode on EnterVT, so we reprogram the mode for sure.

commit 52e8231a19f28bd4744f983aee2197a18c20aa3a
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Jun 26 07:46:28 2006 +0200

    Major cleanup of mode reprobing:
    - Don't mess with pScrn->monitor->Modes, and instead make our own availModes.
    - Don't re-program the pipe with the same values (no flicker at xrandr)
    - Move a bunch of stuff that should be exposed through the public API (probably)
      to i830_xf86Modes.c
    - Use a table with established modes plus GTF to come up with modes from EDID,
      instead of trying to walk and find one in pScrn->monitor->Modes.  I think
      this is correct.
    - Reset clone state if we've detected new pipes, which should turn on the
      cursor.

commit f5e5f8aeddb3e0d6d073471aeff6176fb54576e2
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Jun 23 23:29:55 2006 -0700

    WIP to allow re-probing and validation of modes for new heads at "xrandr" time.
    
    Now, DDC modes always end up being preferred to custom modelines, even if
    smaller.  This should probably be fixed by inserting custom modelines into
    the probed mode list if they're valid according to the probed parameters of the
    monitor.
    
    Too much code is lifted from static functions in xf86Mode.c, and those should be
    made unstatic if possible.  Using xf86ValidateModes is also rather hacky, and
    I want to break the function down, but this is a first step.

commit 89791914d2a78f19f4f60ca370d387e5b1ccfb46
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Jun 23 18:21:17 2006 -0700

    Split probed modes out per pipe, and union them into the available modes.
    
    This is the first stage of getting runtime monitor attachment.  The old i830
    GTF code is returned to use to provide suitable modelines for xf86ValidateModes
    in the LVDS case, even though the LVDS doesn't care about the modeline and just
    always programs its fixed values.

commit dae9cb7712d5d8f88697ca83808c59af08364c0e
Author: Alan Coopersmith <alan.coopersmith@sun.com>
Date:   Thu Jun 22 15:07:16 2006 -0700

    Provide definitions of __FUNCTION__ for non-gcc compilers

commit bb4810521633b6c3db2fc7d01ddc71325583d265
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Jun 22 09:38:27 2006 -0700

    Move FP mode validation next to other mode validation code.

commit 66d9a1be302ad34573de98de21cbdf6419592092
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jun 21 17:11:54 2006 -0700

    Detect SDVO display presence at startup and default to displaying to it, too.

commit 72e25a7488c2eabcc92e9e0769a89dee687f52fd
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jun 21 16:04:18 2006 -0700

    Fix SDVO output at low pixel clocks.
    
    I had interpreted the docs as saying that the multiplier setting would further
    divide the clock and stuff dummy bytes in.  Instead, we have to set the DPLL at
    the higher clock rate, and the pixel multiplier just controls the stuffing of
    dummy bytes.  Also, we have to set the multiplier both in the graphics chip and
    on the SDVO device on the other side.

commit 726443309d72134341cff1f6db978aa1d6e3ce52
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Jun 21 15:38:19 2006 -0700

    Add decoding of SDVO command names for debug output.

commit 5a1b68993f3a3a2e8dcd428a7118e29c36703cd6
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Jun 21 08:41:16 2006 +0100

    Fix build without DRI

commit 16b310823bacab6be4947da234b3a081b0a3cd62
Author: Matthieu Herrb <matthieu@deville.herrb.com>
Date:   Wed Jun 21 00:12:27 2006 +0200

    Fix build without DRI

commit 896ffe78fe96469cdd3ade77c8e68e1503967223
Merge: 89c2c4b... 52243d4...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jun 20 15:10:35 2006 -0700

    Merge branch 'modesetting-origin' into modesetting

commit 89c2c4bc40b8c032915ccb3ed4f3c143c3d8db12
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jun 20 15:10:19 2006 -0700

    Add #if 0-ed code I've been using for CRT detection debugging.

commit be08661e3126907c50c54485042fcde00b0da2b4
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jun 20 14:48:03 2006 -0700

    Only default to enabling CRT or LVDS output if they're actually detected.
    
    Still, if we haven't detected any outputs automatically (including CRT through
    DDC), default to CRT anyway.

commit b454c9601f005c69c11556a558150403378d34d9
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jun 20 14:32:40 2006 -0700

    Add support for CRT detection using DDC.
    
    This method is slower (~5ms), but works on older chipsets.  Also, load-based
    detection is disabled, as it can be fooled by other outputs on the pipe being
    active, such as LVDS.

commit 0b76646666e9d330e77c6f81af8b91e34623be92
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jun 20 13:57:26 2006 -0700

    Add CRT detection function by testing for load, and clean up hotplug version.

commit e4584a4f44a70d746396ed48b8e40033504d68b2
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jun 20 10:39:28 2006 -0700

    Remove dead DisplayInfo option.

commit ab60e34dcfc52ab5f22a82145d5b4db51b4c62c5
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Jun 20 10:07:47 2006 -0700

    Add debugging info for pipe/display plane size.

commit 8a6edba33213911cc2210b5e903428b81d45862f
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Jun 19 13:47:28 2006 -0700

    Set vblank interrupt configuration to match pipe configuration
    
    New i915 drm ioctl (in version 1.5) allows the X server to select
    which pipe drives vblank interrupts. Use this to drive from the 'preferred'
    pipe. Yes, per-window vblanks would be nice in a shared fb environment.
    Maybe someday.
    (cherry picked from 2fb375b665f4802819b89f2277fd6154006c11ee commit)

commit 52243d407cad93283956660de4771097ac0b4b2d
Merge: 2fb375b... 34f6a82...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Jun 19 13:28:09 2006 -0700

    Merge branch 'modesetting-origin' into modesetting

commit 2fb375b665f4802819b89f2277fd6154006c11ee
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Jun 19 13:24:57 2006 -0700

    Set vblank interrupt configuration to match pipe configuration
    
    New i915 drm ioctl (in version 1.5) allows the X server to select
    which pipe drives vblank interrupts. Use this to drive from the 'preferred'
    pipe. Yes, per-window vblanks would be nice in a shared fb environment.
    Maybe someday.

commit b5acc6b3a3a3a109014d6b971f4722d0f0a4c29a
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Jun 19 13:22:17 2006 -0700

    Add backlight control to DPMS logic.
    
    Turn backlight on and off in response to DPMS state changes.

commit d7e5d996aa123e52857362fa8a1e69f709bfe218
Merge: 89a5a00... a73ab7f...
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Jun 20 01:22:53 2006 +0800

    Merge branch 'master' into exa

commit a73ab7f0e6e3b0462e05c0031ffd602ed3e2bcd4
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Jun 19 11:35:42 2006 +0100

    additions for rotation fixes

commit 1fe3dd38eb613475d62140850e64767defed7d34
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Jun 19 11:27:28 2006 +0100

    Set some invarient state, cures some problems with
    rotation at startup.
    
    This mimicks the 3D drivers setup.

commit 89a5a0024a7e077a0726ffe1427e573df3bcbef5
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Sun Jun 18 00:25:34 2006 -0700

    Fix crash with EXA during randr, when XAA structures were being accessed.  EXA
    shouldn't have any issues with there also being pixmaps in framebuffer while
    rotation is active.

commit f2ab3aa3199e1c4b0edec72b5acea6d725cc514a
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Sun Jun 18 00:32:01 2006 -0700

    Fix DRI in EXA mode: Don't attempt to use XAA symbols (use the driver's internal
    ones for EXA support when available).  Also, add an abstraction of XAA/EXA
    MarkSync and WaitSync functionality so we don't need to sprinkle the ifdefs all
    over, and correctly use them.

commit 3592b432b48d51d2273c1e1064f85e656fbba130
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jun 13 21:42:53 2006 +0100

    fix 8bpp & 16bpp rotation modes for i8xx
    series chips

commit a50610b7719bfe800c3496c17d0ba77739167b35
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Jun 12 13:53:20 2006 +0100

    Use 800x600 mode to double check

commit f02268b2091c9a785d26e82bcb35a8b713463072
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Jun 12 12:16:58 2006 +0100

    Don't rely on register check to find out
    if we're resuming - it's not reliable.
    
    But then, neither is the BIOS, but it's
    the best we can hope for until Eric's work
    is complete.
    
    Try setting another mode to cater for some
    broken BIOS' too.

commit 672c3d18dbb405095e465126053ff887d891409e
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Jun 12 10:02:06 2006 +0100

    Only mark rotation flags after initial screen setup.
    Fixes bug #7053

commit 34f6a8204f1edec015283fc6b5f196e47897e3de
Author: Keith Packard <keithp@mactel.(none)>
Date:   Sun Jun 4 00:15:06 2006 -0700

    Get sDVO output working on mac mini.
    Add lots of register debugging to track delta from BIOS settings.
    Fix various mode settings to mirror BIOS sDVO values.
    Disable analog/lvds output on pipe with sDVO.
    Borrow Dave Airlie's I830xf86ValidateDDCModes code.
    Fix various sDVO I2C messages to mirror Dave's code.

commit 6812b5382077e5d3f421aceeeb2f337e9b3f570e
Author: Dave Airlie <airlied@linux.ie>
Date:   Fri Jun 2 12:22:14 2006 +1000

    intel: fix VT switch DRI locking
    
    The DRI locking is incorrect at VT switch, due to reference counting
    inside the driver. Just call the DRI directly.

commit 3f158fd610a3363a23daa7205bcd9f213686cf1c
Author: Keith his master's voice Packard <keithp@bw.jf.intel.com>
Date:   Mon May 29 18:05:57 2006 -0700

    Nice texture coordinate gradient, broken slightly in y

commit bb0ad04d46eba2fed57a888ff960d2436ec7d70d
Author: Keith his master's voice Packard <keithp@bw.jf.intel.com>
Date:   Sun May 28 22:59:58 2006 -0700

    Ok, finally something sensible up on the screen.
    Replace PS kernel with constant data source (pink).
    Dodge g0/g1 so URB data doesn't land on top of thread data.
    Flip source/dest coordinates (dunno why they're fetched this way).

commit ddf3e5b2737399dca6d401f91db51a51f93b6373
Author: Keith his master's voice Packard <keithp@bw.jf.intel.com>
Date:   Sun May 28 21:03:39 2006 -0700

    Using tiny rectangle, still locks up in pixel shader program somehow

commit 2e16c79dc2f24b0a04111aa6236a44870c6c64df
Author: Keith his master's voice Packard <keithp@bw.jf.intel.com>
Date:   Sun May 28 20:31:23 2006 -0700

    Lots more debug code. Appears to execute pixel shader thread now though. hurray!

commit 79a514412bda7e38e018c105a603970c4a9d758a
Author: Keith his master's voice Packard <keithp@bw.jf.intel.com>
Date:   Sun May 28 16:09:59 2006 -0700

    dump out piles of debug. Create VS thread just to see how it works

commit 9c111d89fe19f1773af2eefb000e1c2389b4b6e1
Author: Keith his master's voice Packard <keithp@bw.jf.intel.com>
Date:   Sat May 27 19:52:13 2006 -0700

    Push all of the obvious Mesa state setting into the video code

commit 01101196b16010ac3dadab647bfe7000a53fa94d
Author: Keith his master's voice Packard <keithp@bw.jf.intel.com>
Date:   Sat May 27 01:05:09 2006 -0700

    flesh out cc state. set cull mode to none. enable sf kernel

commit 462a860af89ed855fe2b718342fcaf9c169af3fb
Author: Keith his master's voice Packard <keithp@bw.jf.intel.com>
Date:   Sat May 27 00:17:25 2006 -0700

    Rename BRW instructions, check video instruction generation. Doesnt lock up, but doesnt display anything either

commit 9ec7cf22e3f03c13524bb2d15711699dfcc02984
Author: Keith his master's voice Packard <keithp@bw.jf.intel.com>
Date:   Fri May 26 21:30:55 2006 -0700

    Use broadwater video code on broadwater hardware. Pad ring to even length. compute state base as address rather than offset

commit f5fe700b9a943c956bcfcc3a0d2de13c23b978bc
Author: Keith his master's voice Packard <keithp@bw.jf.intel.com>
Date:   Fri May 26 13:47:39 2006 -0700

    Prepare real SF kernel and fake WM kernel

commit 1549accb6f52498fef3dcbd87bb72d89fcd5bccd
Author: Keith his master's voice Packard <keithp@bw.jf.intel.com>
Date:   Thu May 25 16:10:31 2006 -0700

    Scale video source vertices. Allocate space for kernels

commit c1c46f882f9a11c383c8d1d1ce393be8fda55ed0
Merge: 1e2da24... f2967a2...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon May 22 10:42:24 2006 -0700

    Merge branch 'master' into modesetting
    
    Conflicts:
    
    	man/.gitignore

commit 1e2da2450d7213c0aa4d4bd1fba5723dcda13ddf
Author: Lukáš Hejtmanek <xhejtman@mail.muni.cz>
Date:   Mon May 22 09:48:09 2006 -0700

    Replace VBE call to do DPMS with native code, and fix screensaver in clone mode.

commit 2a1b3cfccb7de53f7ce8f9e4816e4278afb1fcab
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon May 22 10:32:13 2006 -0700

    Use RECTLIST instead of TRIFAN for video so we get horizontal shearing instead
    of diagonal.  Also remove the unnecessary vertex elements that were being
    emitted.

commit bc42dbe07cbd61b357d8eed02608e026c4cf4485
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Mon May 22 11:22:03 2006 +0800

    fix a typo

commit bce209cd3f60cb5d51aadc5fc8ec1a4151435ec3
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 19 17:13:37 2006 -0700

    Put in code for idling accelerator on subsequent cliprects.

commit 3640117bd9f2073ff54dc474f0cdefff49742584
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 19 17:10:04 2006 -0700

    Set up the state buffer in framebuffer.

commit e70d99d51edc39ea53536c2f4d62ac622ba3e0d9
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Fri May 19 15:47:19 2006 +0800

    revert wrong setting for memorySize, which should
    be at the range of pI830->Offscreen.

commit de06cd70a9edb8b56d05d3f505137f7c7f083c2f
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu May 18 18:27:11 2006 -0700

    Checkpoint for filling out more 3D state.

commit ad7ec6a24b436d5492d38e4fa56845b229cf5fb8
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu May 18 15:26:28 2006 -0700

    Checkpoint of BW textured video work, filling out vertex submission stuff and
    some more other state.

commit 291770efc691a02650e3c580ca40c2f9fce3896c
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu May 18 10:43:07 2006 -0700

    Start laying out some of the bits that need to be done for BW textured video.
    Headers taken from TG code drop.

commit b3d79ad9ecc70e9f841092fc75b7e23576b685dd
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu May 18 16:31:40 2006 +0800

    oop I830FALLBACK define error

commit 1bc2a8f7a20b2ea9251e93157c0f2342fdbb951c
Author: Dave Airlie <airlied@linux.ie>
Date:   Thu May 18 16:58:22 2006 +1000

    fixup I830SDVOGetActiveInputs to use return values not args

commit 33ad959323f70f76c494c66ec35a04d7d839f612
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu May 18 11:32:59 2006 +0800

    Add DEBUG_I830FALLBACK for easier tracking

commit 52af679c94a25c0c6e5df5f3647f62fdd256c826
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu May 18 11:31:14 2006 +0800

    Check alignment require in PrepareSolid, noticed by Eric,
    as pixmap offset align set is violated in Solid.

commit fdb52a8c6da0f3d3f4cfbf1583b2dc4d91f7e933
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Thu May 18 11:24:46 2006 +0800

    Solid planemask in PrepareSolid/Copy might be 0xffffffff
    or bits up to the depth. This should save some fallback
    case, noticed by Eric.

commit bc51d6525a12c748d0a293b7e560f6dcea33eecb
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed May 17 13:42:51 2006 -0700

    Turn off overlay video on BW until we have stable PCI IDs so we can know whether
    the hardware supports overlay.

commit f97895efd5532cca145b6f224f9615739b1e8f26
Author: Dave Airlie <airlied@linux.ie>
Date:   Wed May 17 14:46:37 2006 +1000

    fixup chipid override
    
    This makes the ChipID override work so that we actually override the pci id
    that gets used everywhere in the driver.

commit 011a1c99d49c1c69b5fa81ade6a2ed73e84276ae
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Wed May 17 11:16:00 2006 +0800

    Fix memorySize to enable offscreen mem manage.

commit b0ac5303f33f75dc607cf0c705c23db1da836983
Merge: 4c72725... c2cd10e...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue May 16 15:21:17 2006 -0700

    Merge branch 'textured-video' into broadwater-video
    
    Conflicts:
    
    	src/i830_video.c

commit c2cd10e1fba0e75c0ed3db5d17211bddf7ab1e33
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue May 16 10:08:58 2006 -0700

    Flag the 3D state as dirty when we draw textured video, which should help
    
    rotation (I have other issues with rotation anyway).

commit 63a72e46fa20a4a4ba74efed386f6c3c167be5b5
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue May 16 08:54:43 2006 -0700

    Turn debugging back off.

commit 01c043de0393170e98515169f8239fef4d3e2053
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue May 16 08:53:40 2006 -0700

    Use linear min/mag blending.

commit db3683907d15959e79adfb8f0cd94e861fae5c36
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue May 16 08:40:53 2006 -0700

    For textured video, disable double buffering and sync before uploading new video
    
    data.  Allows more videos to play simultaneously.

commit 29a8e88ed01c9e15a2ceba5eb62b19773e14c1f8
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon May 15 17:19:33 2006 -0700

    Relax the alignment requirements for textured video.

commit c9be11459bc2198b435c97c5a3432425246c4d2d
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon May 15 17:04:27 2006 -0700

    Enable overlay and/or textured video at runtime according to hardware
    
    capabilities.  Sets up 16 textured-video ports.  Left in one hack (disconnected
    but advertised BRIGHTNESS and CONTRAST atoms) which may actually not be
    necessary.

commit f268979a0c779641c84e8d5b763acbda131474cf
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon May 15 10:05:19 2006 -0700

    Correct drawing issues with planar formats when top or left != 0, and Y didn't
    
    get its offset.

commit b09fd42d7088ead6c23e040ac4b71114f62de82b
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon May 15 09:29:43 2006 -0700

    Fix the planar formats to display correctly in textured mode. Still has issues
    
    with clipping, and some sampling differences between ximagesink and xvimagesink.

commit dd48790f4600a880fc4907c6e3b1cd51e9c0f0b7
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 12 13:27:33 2006 -0700

    Divide width by 2 in planar-to-packed conversion loop, since each pass through
    
    the loop writes two source pixels.

commit eec5e996ec9361099bf81d8d3b66933d5981c5a8
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu May 11 20:26:26 2006 -0700

    Merge textured-video-wip to textured-video-planar-full.

commit 4154a2f74811b91c0ef5bef32a919d6f8baf1a70
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed May 10 12:09:00 2006 -0700

    Experimental work to use a full pixel shader for planar to YUV conversion, which
    
    also doesn't quite work.

commit 3e0a9c9082942eb6f52612235d84b8408e1e03e9
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue May 9 16:57:19 2006 -0700

    Do a separate BEGIN/ADVANCE_LP_RING set in the planar vs packed blocks, so I
    
    can adjust the planar code more easily.

commit 3af4a967e73b367bb531f2760b4803db1388bcf9
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue May 9 16:50:48 2006 -0700

    Add a couple of macros to simplify writing of video pixel shaders.

commit 06e62ec521ed3f7ed232ace8e188891bedb53097
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue May 9 12:04:58 2006 -0700

    Commit a WIP implementation of the planar video shader that does the
    
    planar-to-packed conversion for us.  Unfortunately the documentation is unclear,
    and I haven't managed to get any implementation of it working correctly.

commit b1090a42b200710628dd8b0c7ced15db7bbe71a1
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon May 8 14:22:00 2006 -0700

    More magic number reduction in rotation code.

commit 3a2d8af214a79591322ce6e5546f856a1ee41736
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon May 8 09:42:40 2006 -0700

    Add initial textured XV support for i915, which can do YUY2 and UYVY, but fails
    
    on I420 and YV12 currently, doesn't support the composite extension, and should
    break XV support on non-i915.

commit 66875c1559bc20b531ab72e5d6b921d9f50b29f3
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 5 10:15:23 2006 -0700

    Convert magic numbers in i915 rotation 3D state to symbolic names.

commit 4c727254da354cfd6f35148a334d046d67a50e99
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 12 16:26:58 2006 -0700

    Remove the local, renamed copy of lnx_agp.c.  The diff between lnx_agp.c and it
    appeared to be removal of bugfixes.

commit a115c4b872a385530dcf94b7e7f2fa9b3b7e3155
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 12 16:11:29 2006 -0700

    Remove the code that changes our behavior based on whether a magic file exists
    with magic contents in /tmp (created by some install script).

commit 0cb251fadca1cbb3d4c5b97982cd0d8c2fc3e840
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 12 16:10:02 2006 -0700

    Do a couple of reverts to get the DRI code building.  At this point, the whole
    driver builds.

commit 78b95386b630039864b31954ebcd02ec8829b0c8
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 12 16:09:40 2006 -0700

    Remove intel_randr.c and stick with the previous code.  Broadwater shouldn't be
    changing our randr, and the new version didn't compile.

commit 2e58aa401dfbab438752038a9034df571c8f8bde
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 12 15:54:37 2006 -0700

    Make the intel_acpi.c code non-modular and make it compile.  I think we'll end
    up nuking this code anyway, as keithp (and I, as well) disagree about how ACPI
    should be handled, but the goal is to compile at the moment.

commit 2cd6c8fa2321ca217ef89db1027dbe9e716ad7aa
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 12 15:37:44 2006 -0700

    Revert internal shadow module changes back like master, along with RandR
    initialization.  RandR initialization retains the no-rotation setting for BW.

commit 88558ebeed12d6cefd73bba0ddac3c043861ac89
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 12 15:00:17 2006 -0700

    Start fixing up the build and remove a regression from master (I think) in
    rotation.

commit 9e387ef92be9b38c68bda8a6a28b0d9eb98d53a4
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 12 13:41:38 2006 -0700

    Re-add authorship note in i830_driver.c accidentally left out of last commit.

commit af2432322ba1d561057c34ab185561a8e799e8cd
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri May 12 13:32:38 2006 -0700

    First pass of integrating the Tungsten Graphics driver for Broadwater.  This
    patch is based off of diffing from the branchpoint to the supplied code, but
    with many chunks containing reversions of commits removed.  Won't work yet.

commit fbba4312e7cb326fdcf6a71194c4fc4a7a9b5488
Author: Dave Airlie <airlied@linux.ie>
Date:   Fri May 12 18:44:27 2006 +1000

    add sdvo capability reading support
    
    This reads the SDVO cap bits and uses them to figure out the input/output
    to save/restore

commit f2967a2f5f47b636b2445fa69dbc3ec79e065c90
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue May 9 13:51:25 2006 -0700

    Video overlay gamma bounds checking must be done bytewise.
    Also, pend bound computations to register writes to allow
    updates to individual values that are 'out of spec' so
    the client can update multiple values.
    (cherry picked from 190f9ad0606e96e684e0b028d576d822dc9aa3cf commit)

commit 190f9ad0606e96e684e0b028d576d822dc9aa3cf
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Tue May 9 13:51:25 2006 -0700

    Video overlay gamma bounds checking must be done bytewise.
    Also, pend bound computations to register writes to allow
    updates to individual values that are 'out of spec' so
    the client can update multiple values.

commit fb10966e9f43f44488097b0daf2fbe10c6a804dc
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu May 4 18:52:08 2006 -0700

    Use xf86int10Addr() when calculating an address to read the video BIOS from, out
    
    of int10's copy.  Fixes a crash on FreeBSD.

commit a66f2c01f7d557d860883346671fb864807dbdca
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon May 1 12:35:21 2006 -0700

    Stop doing the BIOS memory size tweaking now that we don't ask the BIOS about
    what modes are available.

commit 99b0e53244aa49f4e7461a1c96aba69453b3516f
Author: Matthieu Herrb <matthieu@reactor.herrb.com>
Date:   Mon May 1 10:47:09 2006 +0200

    Fix non-dri build.

commit 86f0119f47d8be975016ffdea850f0227e32eebc
Author: Matthieu Herrb <matthieu@reactor.herrb.com>
Date:   Mon May 1 10:41:10 2006 +0200

    Fix non-dri build.

commit fcec956807038a2e90287850df8b4410b1f8b3c2
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Sat Apr 29 10:55:25 2006 +0800

    Save initialize EXADriverPtr, and free it in failure.

commit 0be9bc604420e4433697cc31e8ac58c9f36185e1
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Sat Apr 29 10:54:02 2006 +0800

    I830CheckDevicesTimer() sync should be in I830_USE_XAA case.

commit a00a3d198aee7c173c2c36858f4447e13c86eb7f
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Sat Apr 29 10:52:45 2006 +0800

    fix I830BIOSAdjustFrame() sync in I830_USE_EXA case, use exaWaitSync() helper.

commit c94cc67bcc507e8256ae4b51b84dfe3f4aa12ab5
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Apr 28 15:33:57 2006 -0700

    Update to EXA 2.0 API.

commit a4a4ced50cc235e79013ce8dd78e35c6eb4c98ca
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Apr 28 14:59:52 2006 -0700

    Get it to compile.

commit 941a49f91eac02e256706d8821a2cb069ff7ffef
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Apr 28 14:57:03 2006 -0700

    Commit what applied from Jesse Barnes's i830-exa-latest.patch.

commit a555e28e5afc81969ef7b28482e654cc26b3a446
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 24 16:55:44 2006 -0700

    Correct some SDVO-related register definitions.

commit cc70e6b789a1901bbe4e3501b6b654542d3cdc20
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 24 16:49:48 2006 -0700

    Save/restore the output's SDVO reg.  Note that we might be programming the other
    SDVO reg instead of the one assigned to the output.  When trying to fix that, I
    ended up getting no output at all.

commit b498d2b1d1170123595ada65353428578b59a361
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 24 15:42:46 2006 -0700

    Start trying to save/restore SDVO state on VT switches.

commit 56c1f8b0de9b6acc50f51561caf14d3e6bac09ec
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 24 14:10:20 2006 -0700

    Clean up some argument passing, and remove extra SetTarget{In,Out}Puts that had
    no effect.  Note that we are currently trying to program both outputs of any
    SDVO device the same way.

commit 9ba5319b36e7286e33cf0dcdd804dfc0458a81f5
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 24 13:55:05 2006 -0700

    Only write out as many arguments as the commands need, and fix up the numbers in
    some cases.  Pretty-print the return status.

commit d32514aee4b00b035652830e8b5e6c0b43cf159c
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 24 12:21:45 2006 -0700

    Start trying to implement DDC over SDVO.  It's slightly tricky because the
    control bus will reset from DDC mode to internal-registers mode after every
    Stop afer a Start on the DDC bus.  The xf86 DDC code causes multiple Start/Stops
    in one probe.  So, we create a wrapper bus that does the control bus switch at
    every Start.  It's not working yet on my hardware, but I'm pretty sure this is
    the right way to go.

commit effab21c3d108fac7a4e28ae4dabb0b5f74a5380
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 24 11:42:24 2006 -0700

    Set displayWidth to a sufficient value for the modes we come up with for LVDS.
    
    Reported by:	Lukáš Hejtmánek

commit bcb441225d1365435bc3373901180de944298e86
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 24 10:54:45 2006 -0700

    Simplify the i2c code by using the GetBits/PutBits interface rather than
    reimplementing it.

commit 47bd9059431eadfd8824e496eb91bb50efa0e282
Merge: 729c373... 32a0ad5...
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 24 10:36:24 2006 -0700

    Merge branch 'lukas-resume'

commit 1dbb19059f5dd5cd2ad386c4f73498095987b943
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Apr 20 10:43:19 2006 +0100

    fix bug 6365

commit 729c373121ce2bbb0d813cc923f1254e8b37a025
Author: Dave Airlie <airlied@linux.ie>
Date:   Thu Apr 20 13:34:55 2006 +1000

    move sdvo output setting
    
    we have to set the sdvo register a lot earlier in order for them to sync
    properly otherwise my monitor doesn't sync unfortunately, also
    disable the sdvo while tweaking the PLLs.
    
    This also comments out a setting that seems to break my system here for
    Eric to look at later.

commit 0ba7b13fb4410c6a48b2fb098d2033e040eca6d2
Author: Dave Airlie <airlied@linux.ie>
Date:   Thu Apr 20 12:29:06 2006 +1000

    fix type 0 instead of O

commit 2991d81a3b643161babab6b8f44c057aaaf351c3
Author: Dave Airlie <airlied@linux.ie>
Date:   Thu Apr 20 12:27:47 2006 +1000

    correct height parameter in sdvo packet

commit b5f099e03a9f58b6b99933fb06526bce4db72bd3
Author: Dave Airlie <airlied@linux.ie>
Date:   Thu Apr 20 09:50:36 2006 +1000

    cleanup sDVO for device on C only
    
    This destroys the i2c device properly if the device isn't detected,
    and allows sDVO to work on GM chipsets, and doesn't initialise
    the i2c bus twice for sDVO.

commit 2909802de63756972b38651a496b4ff1b36ac8a2
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Apr 19 16:29:06 2006 -0700

    Clean up SDVO initialization, include config.h, and make it check the right
    slave address on the first device as well.  This gets me to the point of
    bringing up some modes on my device.

commit 32a0ad570d9c010e7d26d980830f719782d9f2f3
Author: Lukáš Hejtmanek <xhejtman@mail.muni.cz>
Date:   Wed Apr 19 19:43:45 2006 -0300

    Add  more registers to save/restore. Save/restore palette as well

commit 132dc0599cf44389c4cc03919f1da8d3a0762b44
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Apr 19 15:04:17 2006 -0700

    Whine if SDVO I2C device init fails, rather than be silent.

commit 88bb4b578857588f34ac84b7a20577139eccab6d
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Apr 19 14:23:45 2006 -0700

    Add more SDVO code.  It's taken from airlied's driver, but with magic numbers
    replaced by symbolic names in many places.  I tried to restrain myself from
    functional changes in airlied's code in this pass.

commit d8f7dfac769d7b03f069306b1296bb2e1e08b009
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Apr 19 10:45:13 2006 -0700

    Start bringing in some SDVO code, mostly from airlied.

commit a371a04a57620b7128e3c4395bc7c2ac55effe19
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 17 14:10:50 2006 -0700

    Use the IS_I9XX macro intead of >= i915G, since by PCI ID number, 855GM > 915.

commit 33413a3cf34b06e3207fe1cdb733d586d55a4337
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 17 13:42:57 2006 -0700

    Remove some dead code and one particularly useless debug printf.

commit a85be820033af8bf30d1fec4a899349af35a6ef6
Author: Ian Romanick <idr@localhost.localdomain>
Date:   Mon Apr 17 12:52:30 2006 -0700

    Add missing new-line character in log message.

commit 365b4a53ee965002a5452e6f6016b528e51cee69
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 17 01:12:28 2006 -0500

    Disable the BIOS dump-to-file since it's a trivial local DOS, and I can just ask
    people to turn it on and recompile when I need to.

commit ee7be006b63b6b1ce7f786b045fb8f26d337433c
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Sun Apr 16 13:13:42 2006 -0500

    Bug #6589: Use alternate offsets to successfully get at the panel data for
    some broken video BIOSes.

commit 786ee3df1726f08953167d05f7fa1930452703bb
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Sun Apr 16 13:05:35 2006 -0500

    Add a standalone program for parsing VBT.

commit 62652127cd12f5a0fc9364285b81d2661372148a
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Sat Apr 15 12:16:46 2006 -0700

    Check for LVDS BIOS tables exactly once at startup.  While there, dump the BIOS
    data to /tmp/xf86-video-intel-VBIOS, for offline debugging.

commit 830fa81792a613fe2127a2b89a3eaa326f56114c
Author: Alan Hourihane <alanh@jetpack.demon.co.uk>
Date:   Wed Apr 12 21:55:31 2006 +0100

    fix typo

commit 3c9bc19db63a317db9e2d67a5bc15b1de1a1060a
Author: Alan Hourihane <alanh@jetpack.demon.co.uk>
Date:   Wed Apr 12 21:54:50 2006 +0100

    fix typo

commit d6edffee7d987ef551e1a94d9fac21beb72a9598
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Apr 12 12:16:51 2006 -0700

    Initial support for pre-i915 PLL programming. Untested.

commit 59f88955f57cf0f98458b57418dae25cf53ca180
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Apr 12 11:11:14 2006 -0700

    Automatically enable clone mode if we detect two active outputs.

commit a797a6626a8117cd16456a206ed96300e4a0ceeb
Author: Wang Zhenyu <zhenyu.z.wang@intel.com>
Date:   Tue Apr 11 16:44:42 2006 -0700

    Fix a broken test that resulted in page flipping always being enabled, not just
    when the user enabled it.

commit 66d216da3bfe7c143d681b610130e6daf6dfa52f
Author: Eric Anholt <anholt@leguin.anholt.net>
Date:   Tue Apr 11 16:37:10 2006 -0700

    Replace .cvsignore with .gitignore.

commit 185b5251419724fa9377421d67981daa674908c8
Author: Eric Anholt <anholt@leguin.anholt.net>
Date:   Mon Apr 10 20:25:13 2006 -0700

    Add missing MIT copyright licenses, which should have been on all versions.

commit c0a2dc608d95f92b0f5a151c623745f09df3afc5
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Apr 10 20:09:37 2006 -0700

    Save/restore PFIT_CONTROL. Eliminate compiler warnings

commit 498abf474b90b04bc4085397a209cc493d98d15c
Merge: c26f073... 3de82ff...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Apr 10 19:41:50 2006 -0700

    Merge branch 'modesetting-origin' into modesetting

commit c26f0737e2c0f000f67f21ef6007b351160036a4
Merge: 11ad8a5... 692a4a4...
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Mon Apr 10 19:41:41 2006 -0700

    Merge in master to modesetting

commit 3de82ff3938c6559c90079be0c28dc507d62f79e
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 10 15:10:15 2006 -0700

    Improve LVDS modes when outputting a CRT+LVDS combo at larger than the LVDS's
    panel size.  This is a hack until we get better clone mode, but it correctly
    displays a subset of the root on the LVDS by using a correct pixel clock and
    pipe/display size.

commit 692a4a4bafd4cab197b761cda22368581b78f996
Author: Adam Jackson <ajax@freedesktop.org>
Date:   Mon Apr 10 11:27:25 2006 -0700

    Bump to 1.6.0.

commit 43c93057c044f33c20b1dd639eaeabefc0901589
Author: Aaron Plattner <aplattner@nvidia.com>
Date:   Mon Apr 10 11:26:33 2006 -0700

    Add a DrawablePtr argument to the XV functions to pave the way for redirected
    video.

commit 39bdfbb4c23c9ba2a44888f22330a892c4becedc
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Apr 10 11:26:06 2006 -0700

    x86_64 warning fixes

commit 11ad8a590d65849be00e1be4e9dd52c1159a4f24
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 10 09:39:24 2006 -0700

    Remove the int10 POST on EnterVT.  It has been reported to cause crashes now,
    and I believe it is the responsibility of the kernel to bring the device back to
    a mostly-sane state on resume anyway.

commit 4217ce18cec257cad435adf9ddc9258a3c8164ec
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 10 09:37:02 2006 -0700

    Warnings cleanup.

commit 334512e0604c208ffec914374a76d85720c1dcf9
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 10 09:32:45 2006 -0700

    Don't try to use LVDS by default on chipsets that won't have an LVDS attached.
    The BIOS tables may still exist, so we can't rely on their presence to indicate
    LVDS attachment.

commit 69083a2fc3ca4a3d06c1985c8a630d5628c1110c
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 3 16:29:14 2006 -0700

    Remove BIOS save/restore code, fixing VT switching. Removes some other dead
    code, too.

commit 2e5d85fb83def483ab1fd96877aae4a89a962b7f
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 3 16:27:24 2006 -0700

    Turn off the VGA plane when we're setting our native modes.

commit ceb08d28f4a4e9f42c9417938b8541bf1b4e8245
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 3 15:32:41 2006 -0700

    Remove the hacky-looking Set640x480. I'll be removing things it depends on
    (setpipe), and I suspect we'll end up with different hacks for resume, anyway.

commit 1f0ba458d02f7d4777c1669aae02138f3a6628c1
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 3 15:28:47 2006 -0700

    Remove more BIOS stuff, particularly Get/SetDisplayDevices. Now, if there's no
    hardcoding in the config file, we default to LFP if we detect it from BIOS, and
    LFP or CRT if we can get EDID out of them.

commit b20b466aaed54708ae9e4676623c8c394a6f00d5
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 3 14:28:55 2006 -0700

    Remove the now-unused displaySize and pipeDisplaySize.

commit d960c3ca1512a58a53b5c24702cb5c97124817ee
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Apr 3 14:12:29 2006 -0700

    Remove more BIOS modesetting stuff.

commit 4e3a4827007d624aa3da1a9f5a299837bd601a33
Author: Keith Packard <keithp@neko.keithp.com>
Date:   Fri Mar 31 14:05:46 2006 -0800

    autodetect LVDS dither. Fix 16bpp depth selection

commit 8d27f8246ed5a73f7a78043e128b47be784186c0
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Mar 28 13:49:41 2006 -0800

    Clean up (and I believe fix a couple of bugs in) the divisor selection code.

commit e45581cd073b23a62719f20783d617bd35316fec
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Mar 28 13:40:32 2006 -0800

    Fill in clock information from VBT table, so that a good clock value gets
    requested for choosing divisors.

commit 33977d23830b5f9bb7d9e2e9c141f91cb127b7de
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Mar 27 18:50:53 2006 -0800

    Port code from radeon driver for panel mode validation, which will hopefully get
    the right mode chosen on the VAIO.  Untested.

commit febdfa967dbe1df487db71ba5f677ef37450bf7a
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Mar 27 15:19:52 2006 -0800

    Remove some VBE DDC code that I believe is OBE.

commit f86892c9163473a683ab591adeb9fb1c0be2ef99
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Mar 24 16:00:30 2006 -0800

    Make auto panel fitting work by pulling LVDS timing EDID info out of the static
    BIOS table, and always using that.

commit f6a3243f40074aee471ec1cda2cc8e5f05116284
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Mar 24 13:49:10 2006 -0800

    Add more VBT reading, so we find the panel size.

commit 64756e215016730b5cc2e174f08d47c0288c0ba4
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Mar 24 11:55:01 2006 -0800

    Start interpreting VBT information with the goal of pulling out LVDS timings
    for panel fitting.

commit c2d554be671f5368bd98867b8ecf9428e4560a81
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 23 14:33:04 2006 -0800

    Save/restore a couple of important VGA plane registers, and have vgahw
    save/restore everything it knows about.  Also moves the save to just after the
    other reg saves, above the VBE save stuff which may have side effects.

commit 8411c126ae66239f8b3a2261e338a723c36aa44f
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 23 11:31:24 2006 -0800

    Update to newer airlied DDC code, and do some cleanups as well. Now tries DDC
    on LVDS, though my current LVDS gives no results.

commit 6414ad89b9d368a032adf2358a65404f5443ef35
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 23 09:48:18 2006 -0800

    Add enough of airlied's DDC/I2C work to pull EDID info from my CRT.

commit 5215e19af58f5c2746c8d281e33ecee86e55f0a5
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Mar 13 10:29:51 2006 -0800

    Add some register information for VGACNTRL, and do the reg-debug thing on it.

commit b77bdc2c15640a3b15233f2190179d66bc8b2a4b
Author: Eric Anholt <anholt@debian-sony.jf.intel.com>
Date:   Wed Mar 8 15:08:06 2006 -0800

    Move the PFIT enabling before the enabling of the pipe, as the specs say we
    should.  This doesn't work yet, as we apparently need to adjust the pipe to
    output at the full resolution of the panel, not the displayed image size,
    because PFIT controls scaling between the display planes and the pipe.

commit de4a9e4a7891daa1488d17bf4c22283759f97373
Author: Eric Anholt <anholt@debian-sony.jf.intel.com>
Date:   Wed Mar 8 12:54:14 2006 -0800

    Add a couple more bits to panel auto-fitting, though it isn't working yet.

commit 02341aa68cf2171e037196019f2553f0d1b1bd0d
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Mar 6 13:23:29 2006 -0800

    Make the reg-snapshot code work, add a couple more registers, and use it on VT
    switching to hopefully help point out where we aren't restoring enough.
    Currently doesn't reveal anything.

commit 2b6fc7ddb020a5511f6f599a2f5c37db27eddbcc
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Mar 3 15:42:15 2006 -0800

    Add missed save/restore of DSP*SIZE registers.

commit 12ce799818722473dde2f82739d50ba4ec7f6ecd
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Mar 3 15:38:31 2006 -0800

    Add some untested debugging code to for helping figure out VT switch issues.

commit 585cc5f256b8e91460414a26409d0e484a86718c
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Fri Mar 3 10:37:26 2006 -0800

    Add more integrated LVDS support code.

commit 33c62e8e654fa2228bc3fd31ec0fe010703f363a
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 2 17:53:38 2006 -0800

    Change the order of reg writes for restore, possibly increasing chances of
    success.  Also save and restore ADPA.

commit 7f4dc09dcafc7f0423b7f3e970a0b19fbbf515dd
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 2 15:55:18 2006 -0800

    Remove some dead VBE code.

commit f3ec8653ab4c9b26d249bcf4393326de37ac8321
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 2 14:31:39 2006 -0800

    Include config.h, fixing many issues with reading from pI830.

commit 84fc3971d76f78546a0bb7dd57dba52dd893a921
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 2 13:35:40 2006 -0800

    Turn off panel power before poking pipe B, and turn it back on if we're doing
    LVDS.  Also, refuse to do LVDS on pipe A, as the docs say you can't.

commit aca0f942f377d997c5c0b5be790ee7f255d6e046
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 2 13:31:51 2006 -0800

    Fix prototype for i830DetectCRT.

commit df6347139bc9de22af981f776d711ac9d44fad1c
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 2 12:52:19 2006 -0800

    Use DISPPLANE_32BPP_NO_ALPHA for depth 24, else the empty alpha channel results
    in a black display plane.

commit 8e819ced8397f0330fd44efa60fef89bd10ff70e
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 2 11:55:00 2006 -0800

    It appears from the specs that you have to wait for vblank after disabling the
    plane, not the pipe.

commit ee2410b965321e3d9d64fc500fdcfa6d6dc3a039
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 2 11:43:41 2006 -0800

    Move display base setting to a separate function and use it from both mode setup
    and AdjustFrame.  Rename AdjustFrame to reflect the fact that it doesn't touch
    the BIOS.

commit 980fb78e759b752a6cae3c87d188c50ab131ba80
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 2 10:49:31 2006 -0800

    Correct capitalization of i830SetMode.

commit 2b842c7ee3f9c33cabf16561f11bf1c3a2502d4a
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 2 10:08:20 2006 -0800

    Start implementing support for setting modes for multiple output devices,
    particularly LVDS.  Untested.

commit a09d9cf27af7016bbd9e562c7b1c338154fd3d40
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Mar 2 09:05:13 2006 -0800

    Replace I830VESASetMode with simpler i830SetMode, which is all native and
    doesn't have BIOS-setup workarounds.  Multihead behavior may be wrong, and it is
    all untested.

commit 7edb25789bd13f26134e8f5bf493897c8df322e0
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Mar 1 14:02:51 2006 -0800

    Start making i830SetMode aware of multiple pipes.

commit b5915ac77a3887cd3aa4ce0bb77b8a36e1aa5a1b
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Mar 1 13:12:25 2006 -0800

    Clean up a couple of warnings.

commit c20e15fbe4daeb7288f5c56cf5467eed13686080
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Mar 1 13:08:38 2006 -0800

    Disable I830VESASetVBEMode on restore, since I've removed that code. Note that
    this means that VT switching is broken.  We're fine with that for now, but at
    least now we get a bad display rather than X crashing about an undefined symbol.

commit 7d37c5036956609d0c7ae874d0dc1c616f76f849
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Mar 1 13:06:04 2006 -0800

    Re-disable chatty debug code.

commit 2538cbeb5014e40280a3ae782a755512b1dc85fa
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Mar 1 13:01:52 2006 -0800

    Enable -Wall on GCC, and do a cleanup of existing warnings.

commit 7746da3b346968ab8d2534fc158d026da67cc7b5
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Wed Mar 1 12:49:06 2006 -0800

    Move LVDS panel power state setting to a separate function, and reduce magic
    numbers.

commit 142bc4f91a5d776e7ab44cc5fb2328e3f7267557
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Feb 28 18:50:57 2006 -0800

    Write the ADPA (CRTC) register on mode setup. Obtained from airlied.

commit 6877f532c5f41a445d41eb6a9982bf6bcf691bf2
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Feb 28 15:56:06 2006 -0800

    Add untested CRT detection code.

commit a085813714818a23aa8d326804f642cd699e0f17
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Tue Feb 28 15:16:59 2006 -0800

    Add adjustments of PLL divisor limits for "Almador".

commit 2d4415ff1729554537b20be2b6c878444485e406
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Feb 27 16:57:43 2006 -0800

    Remove the hacked local xf86SetModeCRTC now that xf86SetCrtcForModes is taking
    effect on all of our modes.

commit 611264ab9b82bca6648a9b27e5ba4b7457c46aa6
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Feb 27 15:44:11 2006 -0800

    Remove more VBE stuff and start using xf86ValidateModes. Guessed some params to
    xf86ValidateModes.

commit 9838f639911e8c165ab615fdd9a00e02fa4b3f8a
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Feb 27 14:12:50 2006 -0800

    Always ErrorF output debugging info when doing BIOS calls, including file/line.

commit 767944e3782f9941e9fc72a6705cc3115a6e24ac
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Feb 27 13:08:46 2006 -0800

    Replace a few magic numbers with symbolic names. Reviewed by md5.

commit 4955cd267e7f8ed70e90b2a3de6f93de2ef859c8
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Feb 27 09:37:47 2006 -0800

    Add untested save/restore code, and starting on not using VBEValidateModes

commit 73496b765c9783a8a271b4774a44fa263dd47684
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Mon Feb 27 09:26:51 2006 -0800

    Change an if statement to a more obvious but equivalent case statement.

commit 9fe316da7390918dd88940087567314b6f253981
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Feb 23 13:49:31 2006 -0800

    Add the manpage's possible names when generated.

commit 1555229f29fa7479d6a7a51f451d04a5ef3460bd
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Feb 23 13:48:26 2006 -0800

    Move .cvsignore to .gitignore

commit 139d33ac807fb0fc35c37c3689a6e80238199442
Author: Eric Anholt <anholt@FreeBSD.org>
Date:   Thu Feb 23 13:46:30 2006 -0800

    Initial add of native CRT modesetting code.

commit 35e4756645891bfc85f25f1ab60c287eba9ef749
Author: Dave Airlie <airlied@linux.ie>
Date:   Wed Apr 5 07:12:00 2006 +0000

    Fix some argument inversions in xf86DrvMsg function calls

commit 6e5f9b026372eea295c390b18fc41f7018e0e797
Author: Kristian Høgsberg <krh@redhat.com>
Date:   Tue Apr 4 18:22:32 2006 +0000

    Add more missing #include's, in particular assert.h.

commit fdfce49c54dabf0f6b0d20aa7e5eeb62b5b57eda
Author: Kristian Høgsberg <krh@redhat.com>
Date:   Wed Mar 22 23:24:03 2006 +0000

    Drop libc wrapper; don't include xf86_ansic.h and add includes now missing.

commit 58817c9909ba659d0070afab0ff7f4e26f722403
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Mar 10 13:07:00 2006 +0000

    Enable gamma for hw cursor when ARGB cursor in use (Lukas Hejtmanek)

commit ab4c2f3bf4b26fdd597ea7b7a726ae77778617b2
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Mar 3 16:27:37 2006 +0000

    Check the version of shadow being used and turn off rotation if it isn't the
    right one.
    Bump the Xvideo resolution support from 1920x1080 to 1920x1088.

commit be6216cd8c6a47dd053240f7a5d1445b61f79038
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Feb 20 03:25:50 2006 +0000

    Fix a rotation problem when DRI is disabled

commit 073c4a6a18e98e2dde114756b5d787b13bb2b7a5
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Feb 20 03:22:26 2006 +0000

    Fix a rotation problem when DRI is disabled

commit 7cca2ae73e0114a9df2152ed5ed5b66fc44f65dd
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Sun Feb 19 00:04:49 2006 +0000

    fix another build problem

commit 2e01277da0be55687ca901efadcaf5c919826824
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Feb 17 16:16:10 2006 +0000

    fix build failure

commit 86fa25369353471dc9a1041df74e66e9029863a7
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Feb 15 18:31:22 2006 +0000

    a little more of a workaround until we unplug the frontbuffer from libdri

commit 32f97e02ac3611fd5e3870826dedf701f3b69a51
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Feb 10 21:59:37 2006 +0000

    temporary workaround until DRI frontbuffer mapping code is removed from
    libdri.a

commit 50e5c2696389cb4d5907a822aa79d5e0e03cee8c
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Jan 26 09:55:15 2006 +0000

    update Changelog

commit 91d2ba5743041077754de3bd3565df930b036c7d
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Jan 26 09:05:50 2006 +0000

    add changelog

commit 076971b95ed3b89e1a333adbffceab1c2a5b7743
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Jan 25 22:22:42 2006 +0000

    When going dual head only take a portion of memory for the second head
    instead of doubling the requirements.

commit 77d1c579f3031789031dd203175d3c9555226f79
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Jan 25 22:17:00 2006 +0000

    Fix a glitch in a dual head fix from #3105

commit d8d749080923e88376db1aa18ae2ad722d5113d9
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jan 24 15:20:34 2006 +0000

    Bump version to 1.5.0.0
    Add Intel 945GM support
    Add RandR rotation support (full 3D acceleration, HWcursor & Xvideo rotated too)
    Remove shadow framebuffer rotation code
    Add a new LinearAlloc option to allow more offscreen memory to be allocated
    for XVideo applications. This allows HDTV movies to be played via Xvideo.

commit 919d36b6717e9a7d930c5120309778da7b0fe16c
Author: Kevin E Martin <kem@redhat.com>
Date:   Wed Dec 21 02:30:00 2005 +0000

    Update package version for X11R7 release.

commit 92962f32fccac6df751268190928d8becb558b64
Author: Adam Jackson <ajax@nwnk.net>
Date:   Mon Dec 19 16:25:53 2005 +0000

    Stub COPYING files

commit d2ef609211306b6bd3861c0e5f6d3a9af3e145fb
Author: Alan Coopersmith <Alan.Coopersmith@sun.com>
Date:   Mon Dec 19 09:07:50 2005 +0000

    Typo fixes, mailing list & url updates, and other changes to prepare for
    X11R6.9 & 7.0 releases.

commit 1c51ff5c652690d66d1f7cba803c0bb26208b509
Author: Kevin E Martin <kem@redhat.com>
Date:   Thu Dec 15 00:24:17 2005 +0000

    Update package version number for final X11R7 release candidate.

commit c5007a4b46ffb66f5d98abe8bcae6df8c6eb1b31
Author: Kevin E Martin <kem@redhat.com>
Date:   Tue Dec 6 22:48:35 2005 +0000

    Change *man_SOURCES ==> *man_PRE to fix autotools warnings.

commit 15df4215347854604fd3f6795ac5f971444cf39d
Author: Kevin E Martin <kem@redhat.com>
Date:   Sat Dec 3 05:49:33 2005 +0000

    Update package version number for X11R7 RC3 release.

commit c50cd5a7f5af7d45550f25f173b512eb89bf41c5
Author: Kevin E Martin <kem@redhat.com>
Date:   Fri Dec 2 02:16:08 2005 +0000

    Remove extraneous AC_MSG_RESULT.

commit da2c00c0e85a284e3fbd237f3a77212f9647da37
Author: Adam Jackson <ajax@nwnk.net>
Date:   Wed Nov 30 18:47:54 2005 +0000

    Bump libdrm dep to 2.0.

commit ca36f1da4e254c779b38df30fd655533e548a294
Author: Adam Jackson <ajax@nwnk.net>
Date:   Tue Nov 29 23:29:59 2005 +0000

    Only build dlloader modules by default.

commit 0b337390d6919e9a3d31ca654c8bc44b30756862
Author: Alan Coopersmith <Alan.Coopersmith@sun.com>
Date:   Mon Nov 28 22:04:09 2005 +0000

    Change *mandir targets to use new *_MAN_DIR variables set by xorg-macros.m4
    update to fix bug #5167 (Linux prefers *.1x man pages in man1 subdir)

commit 159bea027893ce5996a452a6f493372792e95122
Author: Eric Anholt <anholt@freebsd.org>
Date:   Mon Nov 21 10:49:14 2005 +0000

    Add .cvsignores for drivers.

commit e62939e30e664592085ce394680fd8e7f3d31339
Author: Kevin E Martin <kem@redhat.com>
Date:   Sat Nov 19 07:15:38 2005 +0000

    Update pkgconfig files to separate library build-time dependencies
    from application build-time dependencies, and update package deps
    to work with separate build roots.

commit 08f03e4237ce9a54f0dffa37307af402b0bd2e55
Author: Kevin E Martin <kem@redhat.com>
Date:   Wed Nov 9 21:31:20 2005 +0000

    Bump version numbers for X11R6.9/X11R7 RC2.

commit a600e89a1547908f2018de96b5ecb814e2427b34
Author: Kevin E Martin <kem@redhat.com>
Date:   Wed Nov 9 21:15:15 2005 +0000

    Update package version number for X11R7 RC2 release.

commit f73c23b4c588c2f5dbc3c36a2f43b8bbb1e0f36a
Author: Kevin E Martin <kem@redhat.com>
Date:   Tue Nov 1 15:08:53 2005 +0000

    Update pkgcheck depedencies to work with separate build roots.

commit 25a63bfefda420f85b3cba89bdae4b35ef80c84f
Author: Adam Jackson <ajax@nwnk.net>
Date:   Fri Oct 21 18:40:19 2005 +0000

    Bug #4829: Remove some useless DRI symbol checks.

commit 53c122fa162709f618be26d5940e3488c0cbbafa
Author: Kevin E Martin <kem@redhat.com>
Date:   Wed Oct 19 02:48:03 2005 +0000

    Update package version number for RC1 release.

commit 4b97a544cac9fb507b4a2a7c8017607ea2cac1bb
Author: Alan Coopersmith <Alan.Coopersmith@sun.com>
Date:   Tue Oct 18 00:01:53 2005 +0000

    Use @DRIVER_MAN_SUFFIX@ instead of $(DRIVER_MAN_SUFFIX) in macro substitutions
    to work better with BSD make

commit c7b7ece6330561b3745f0e1136b57575eadec5ad
Author: Adam Jackson <ajax@nwnk.net>
Date:   Mon Oct 17 22:57:33 2005 +0000

    More 1.7 braindamage: define EXTRA_DIST in terms of @DRIVER_NAME@ instead of indirectly

commit 0586dbe1c5d0432e8d8da2f3576ac2ccbe139919
Author: Alan Coopersmith <Alan.Coopersmith@sun.com>
Date:   Mon Oct 17 00:09:03 2005 +0000

    Use sed & cpp to substitute variables in driver man pages

commit 1317f2d1f35241969dcf376abd106ffe3f918432
Author: Søren Sandmann Pedersen <sandmann@daimi.au.dk>
Date:   Tue Oct 4 20:01:03 2005 +0000

    Check in generated README files

commit bd48e0531a16bdf27fc8549826cc1123ba12d5bd
Author: Søren Sandmann Pedersen <sandmann@daimi.au.dk>
Date:   Mon Oct 3 21:22:07 2005 +0000

    - For all drivers that have a <driver>.sgml file, add code in their build
      system to build the README file at make dist time
    
    - in util/macros/xorg-macros.m4, add a new XORG_CHECK_LINUXDOC macro that
      will check if the required tools and files exist, and if so set a
      conditional.
    
    - util/modular/symlink.sh
      - Link all the <driver>.sgml to xf86-video-<driver>/README.sgml
      - Add all the README.<driver> to the list of excluded files
    
    - xc/programs/Xserver/hw/xfree86/doc/sgml/SiS.sgml: Various changes
      to make it spew less warnings when the text file is built.

commit 6fda4e886c30669e346f7f30a38b93a77004a7f6
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Oct 3 09:39:17 2005 +0000

    Bug #4353: Fix lockup when suspend and resume when playing video.
    Shutdown the overlay on LeaveVT.

commit 154724cc4be1e951649c29e4abdbde964a8c112e
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Sep 27 08:58:23 2005 +0000

    Put back the print code to display the DDC information, and remove some bogus
    DDC messages.

commit 2174848266940e1896970c12717e106a4742dcbc
Author: Adam Jackson <ajax@nwnk.net>
Date:   Sat Sep 24 18:45:45 2005 +0000

    Disable the {Open,Close}FullScreen DRI protocol.
    Remove empty FullScreen stubs from drivers, comment the non-empty ones.

commit b6443515e9d485b1ab8ee266c5b21750d2a5a551
Author: Alan Coopersmith <Alan.Coopersmith@sun.com>
Date:   Thu Sep 22 01:58:17 2005 +0000

    Don't build xvmc module if DRI support is not present

commit 76033c2c885524c2116ccf0bdd30c89fa2636150
Author: Eric Anholt <anholt@freebsd.org>
Date:   Thu Sep 15 06:04:59 2005 +0000

    Bug #4458: Check for the xvmc proto package, since it's required to build these.
    (Joshua Baergen)

commit 50f0bf51a67c89bf445a682f8fec34c52ff909a8
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Sep 8 14:51:40 2005 +0000

    fix another possible crash

commit 521e357c1846960b48e83fb97f77025f6f91e638
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Sep 8 09:31:04 2005 +0000

    Fix a crash situation

commit e8c46c897564f038744b9274949482568d654ecc
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Sep 6 10:31:33 2005 +0000

    Fix DirectColor visual colormap issues at 16bpp in the i830 driver.

commit bf6fef41935ebf624cc1ae6faa084dfa0a7eee72
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Sep 6 10:23:57 2005 +0000

    Sync the accelerator before calling AdjustFrame to avoid lockups.

commit 5fc5f02d76e077b09bf3ab1c7deeb1263033d57a
Author: Dave Airlie <airlied@linux.ie>
Date:   Mon Aug 29 12:06:13 2005 +0000

    Add i810 XvMC support, it passes distcheck for me.

commit 86e6935bd50b129519b24ee3d694a3f75b8d4f1c
Author: Dave Airlie <airlied@linux.ie>
Date:   Mon Aug 29 12:02:29 2005 +0000

    Fix include paths for i810 XvMC add config.h to driDrawable.c

commit 6f1406753da102ccce1898b3f160d6eaaccc9b7c
Author: Kristian Høgsberg <krh@redhat.com>
Date:   Fri Aug 26 15:32:40 2005 +0000

    Added i830_io.c, which just includes i810_io.c with BUILD_FOR_I830 set.

commit 219beaca91b88dabfe05b8e756d558269f7a5148
Author: Daniel Stone <daniel@fooishbar.org>
Date:   Sun Aug 21 06:26:33 2005 +0000

    Fix typo in debug ErrorF.

commit fdc6997f2edf4dfdcfd877152028bff2a0306999
Author: Daniel Stone <daniel@fooishbar.org>
Date:   Thu Aug 18 09:03:47 2005 +0000

    Update autogen.sh to one that does objdir != srcdir.

commit 461d43be78f49e6cb965b7a206c77f6fe1622601
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Aug 15 07:30:05 2005 +0000

    Egbert's 64bit fixes for mixed 32/64bit clients

commit 95bd8dbee69b4b35e4c37e19d15e0449c38726b6
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Aug 12 21:23:59 2005 +0000

    add missing i830_shadow.c

commit 7476d0413f161ddb3f3cc4a77c3f2a2912d17e60
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Aug 8 09:17:06 2005 +0000

    Enable gamma correction bit even for 8bit modes.
    
    The pipeconf register handles the real enablement.

commit a89f89a2423aecb199d5f4af2e9430e180aa1131
Author: Ian Romanick <idr@us.ibm.com>
Date:   Fri Aug 5 23:04:33 2005 +0000

    I have resolved this by making all the "Direct rendering disabled" messages
    X_WARNING and all the "Direct rendering enabled" messages X_INFO.  Ideally,
    we need to factor some of this stuff out to common code.  There is a *LOT* of
    duplication among the *_dri.c files under programs/Xserver/hw/xfree86/drivers.
    
    I'm trying to clean up as much low hanging fruit as I can and got tired of
    waiting for ajax. :P

commit fd6d7d7f7ea03961c5ecf7db029f12ece93d414a
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Aug 2 16:22:42 2005 +0000

    Adjust newPipe code for BIOS's starting at 1200

commit da7b85176fc061995e1b04fa22dc736b6c9353e6
Author: Adam Jackson <ajax@nwnk.net>
Date:   Sun Jul 31 17:19:29 2005 +0000

    Post-merge fixups:
    - Disable building the gamma driver
    - Fix numerous Imakefiles to get header paths and subdirs right
    - Symlink client-side GLX lib source from Mesa
    - Add new shader subdirs to the Mesa core build
    - Tweak the DDX drivers to not ask for "xf86dri.h"; they don't need
      it, since they don't generate protocol, and it was breaking the
      build.

commit 1561ec3ca4f0d774f2664e9354d537061a0102d1
Author: Kevin E Martin <kem@redhat.com>
Date:   Fri Jul 29 21:22:43 2005 +0000

    Various changes preparing packages for RC0:
    - Verify and update package version numbers as needed
    - Implement versioning scheme
    - Change bug address to point to bugzilla bug entry form
    - Disable loadable i18n in libX11 by default (use --enable-loadable-i18n
      to reenable it)
    - Fix makedepend to use pkgconfig and pass distcheck
    - Update build script to build macros first
    - Update modular Xorg version

commit d165b7dc4ec3793e921363cdeb1ad41c0a3653d6
Author: Søren Sandmann Pedersen <sandmann@daimi.au.dk>
Date:   Wed Jul 27 21:23:29 2005 +0000

    Add xf86driproto to dependencies for drivers with DRI support. Patch from
    Donnie Berkholz

commit 0cd371c6e57f899c34c4d2e2a8531ef7ce3967a4
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jul 26 21:55:42 2005 +0000

    Bump the DDX version to 1.4.0 to indicate the removal of drmAddress.
    Thus allowing 32/64bit clients to cohabit.

commit adef005c2f96395d396834f2173125f0c06d40cb
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jul 26 08:07:37 2005 +0000

    Bug #3850: <https://bugs.freedesktop.org/show_bug.cgi?id=3850>
    Fix non-DRI builds.

commit 09e871b1b4a67cfe818613bc012d72965b449f1c
Author: Søren Sandmann Pedersen <sandmann@daimi.au.dk>
Date:   Tue Jul 26 00:41:42 2005 +0000

    Build system for i810

commit ac920dae7c22ed3956e4f31a0d3baf1909762b76
Author: Adam Jackson <ajax@nwnk.net>
Date:   Mon Jul 11 02:29:51 2005 +0000

    Prep for modular builds by adding guarded #include "config.h" everywhere.

commit f90f661652e5fe0986eb804f8dff3eeffe0af820
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Sat Jul 9 21:19:11 2005 +0000

    Copy mode strings upon mode copy

commit 8fced5b648b0666ca88221e37bc1131ab5c2072d
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jul 5 09:25:03 2005 +0000

    Fix Xvideo when operating in one line mode and video is pushed off the top of
    the screen. Also some fixes for Xvideo skew in certain resolutions.

commit 68bc259fa1082f7780e524fc703e926a27fc7f9a
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Jul 4 20:45:39 2005 +0000

    NULL check

commit 83c3e3ee49a0aa3ceaf52e2408cc253fc5dc8af4
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jun 28 16:13:02 2005 +0000

    Add support to check the in-built VESA mode list.

commit 0d64e9e1f5494cff633a1499545d55a0edd0d92e
Author: Adam Jackson <ajax@nwnk.net>
Date:   Sat Jun 25 21:16:55 2005 +0000

    Bug #3626: _X_EXPORT tags for video and input drivers.

commit 67174d67e740b9082ed0a65a79f08b5df3b4fcfb
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Jun 13 12:15:25 2005 +0000

    commit missing piece from resume patch

commit ddab0558d584fb906cc0dfb383cc0e7a122d5336
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Jun 9 09:26:03 2005 +0000

    Bug #3496 <https://bugs.freedesktop.org/show_bug.cgi?id=3496>
    Remove a bogus check for DRM 1.2 for resume functionality as it's
    been present since 1.1

commit 7f49513afe9d4490bdfdac182d50383c089875e0
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed Jun 8 17:50:32 2005 +0000

    Fix the mode validation such that using function 5f05 to set the refresh rate
    works again.

commit f8de9b4b9a5ce2756652c6b9ec1e84aedbc3519a
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jun 7 18:54:10 2005 +0000

    Fix text restoration when display switching has been activated and we could be
    potentially on a different display than the initial one.

commit 1f538007e9da7d4ad30ec4d4d281fb07ef300ddb
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Jun 6 09:47:29 2005 +0000

    missed a hunk

commit d8a32bf4274ad91cc2b9ca425f5b0a017c2dd293
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Jun 6 09:40:23 2005 +0000

    Bug #3436 <https://bugs.freedesktop.org/show_bug.cgi?id=3054>
    Fix some offset, pitch and overlay scaler size problems with
    the video overlay. Solves various spontaneous lockups.

commit 005d121d280ff4502f4d6e3d3d585ff0175367bb
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue May 31 20:29:01 2005 +0000

    and another. sheesh.

commit 27f86d693c32e550d9ebf4d6ff05c2d827754c8b
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue May 31 20:27:24 2005 +0000

    missed hunk

commit 27feb0f3474c1e21557225e10b13558e002c0ebf
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue May 31 17:58:26 2005 +0000

    Add Intel(R) 945G support

commit 2d10e8dc8184b0514e8ac9f835a06b85d609bb1b
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Wed May 25 09:10:44 2005 +0000

    Change the sequence on how refresh rates are set in the i830 driver. This works
    much better with custom modelines.

commit 89ec4ac201c09329d5d732323bdce6250b8592fe
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri May 20 15:24:02 2005 +0000

    Bugzilla #3292: https://bugs.freedesktop.org/show_bug.cgi?id=3292
    Add shadowFB support to the Intel driver (Dima Dorfman)

commit df0964ea8f92c6b278dd87b95380dbc3ada625e5
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri May 20 13:24:02 2005 +0000

    Bugzilla #2339: https://bugs.freedesktop.org/show_bug.cgi?id=2339
    Bugzilla #1064: https://bugs.freedesktop.org/show_bug.cgi?id=1064
    Bugzilla #3055: https://bugs.freedesktop.org/show_bug.cgi?id=3055
    Much better display switching support for mobile chipsets using
    the Fn+F? combination keys.
    Add DirectColor support.
    Add gamma correction support.

commit b99ef9cd59fce0e02e8829210c7cb8aadb6a3499
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri May 20 11:56:45 2005 +0000

    Bugzilla #2585: https://bugs.freedesktop.org/show_bug.cgi?id=2585
    Support the Intel E7221 server chipset.

commit 3b87fac327b5549678f91a9c961b9fe5c0bf8a37
Author: Adam Jackson <ajax@nwnk.net>
Date:   Wed May 18 17:47:35 2005 +0000

    Bug #3163: Create new DRIINFO_*_VERSION macros to indicate the
    version number of the DRIInfoRec, disambiguating it from the XF86DRI
    protocol version number.  Modify DRIQueryVersion to return the libdri
    version number, which all DDXes were requesting implicitly.  Fix the
    DDXes to check for the DRIINFO version they were compiled against.

commit 72100ac7cff7485db3e869f1331caddb0bc21a24
Author: Daniel Stone <daniel@fooishbar.org>
Date:   Wed Apr 20 12:25:28 2005 +0000

    Fix includes right throughout the Xserver tree:
      * change "foo.h" to <X11/foo.h> for core headers, e.g. X.h, Xpoll.h;
      * change "foo.h", "extensions/foo.h" and "X11/foo.h" to
        <X11/extensions/foo.h> for extension headers, e.g. Xv.h;
      * change "foo.[ch]" to <X11/Xtrans/foo.[ch]> for Xtrans files.

commit c813bf655908cd72049f346919abbdff8365b944
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Apr 14 22:55:01 2005 +0000

    Fix initial DDC parameters when validating modes.

commit e637630908f40f42367c94344d44918b6cdb0eb2
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Fri Apr 1 14:17:24 2005 +0000

    Check the VESA BIOS scanline requirements and adjust the displayWidth
    accordingly. Fixes an assumption that the screen width was always used as the
    displayWidth.

commit 5090c8ba6778091aa4ce24b16b058d534ba78dc7
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Mar 21 21:20:39 2005 +0000

    a one line fixup to the UseDDC code

commit 8bc9b0d7da5de9a3294687f450afb50452898c7d
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Mar 21 18:57:39 2005 +0000

    Fix some bad alignment problems when allocating memory from
    the end of AGP space.
    Bugzilla #2764 (https://bugs.freedesktop.org/show_bug.cgi?id=2764)

commit 50a105e88cfdfc22fef8cfd2397fc5e9fae17663
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Mar 15 13:10:23 2005 +0000

    LFP's may exist on Pipe A in older i830's. Check that case so that Panel ID can
    be obtained and Xvideo is correctly setup for panel fitting.

commit eb8b5df739e7be4509423c2bf757a7df35ce02f6
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Mar 15 11:32:10 2005 +0000

    Enforce DDC monitor ranges usage if we have them and reject bad
    modes. Use NoDDC option to override DDC timings. We currently
    only use DS_RANGES, but could use other DDC information, as does
    the common layer, to deduce the h/v ranges.

commit 49dcbacf7fa7f29d18c18eec7e2f99e859bf4c7e
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Mar 3 18:01:51 2005 +0000

    Limit the maximum refresh rate to 85Hz and remove the bogus
    100Hz and 120Hz settings as they don't match close enough and
    are really unsupported.

commit 7eaf88d00d7539fde68422ae6566f23993aa2633
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Mar 1 19:53:28 2005 +0000

    Fix an off by one error when scaling which caused occasional
    overlay color lines at the far right and bottom of the window.

commit 28d65bceaec3ef636f0f5bdd03b38fd76f87c8c6
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Feb 10 13:16:08 2005 +0000

    Fix unaligned YV12 videos that caused skew when playing.

commit 6352e65b9cd635e9f266e0e9ed64c5beae9e5c44
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Feb 10 10:41:20 2005 +0000

    Fix pixmap cache corruption when Xv was in use due to a memory allocator
    calculation problem.

commit f691f959213d3eb5c365edaf5a5a53fa96300491
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Feb 8 20:13:33 2005 +0000

    Setup the Xv atoms correctly.

commit 31a4191a97f538b2c6d4b8036796f06443f783c1
Author: Egbert Eich <eich@suse.de>
Date:   Mon Feb 7 11:56:31 2005 +0000

    Check the pixel clock choosen for a specific refresh rate
    against the maximally allowed pixel clock when choosing
    mode lines for VBESetVBEMode() and VESA BIOS version >= 3.0
    (Bugzilla #2486).

commit a103496e08f699b609be875827ecf1f3afa45e68
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Feb 1 19:47:32 2005 +0000

    Check return value of i830InitDma() and fail to initialize the DRI
    if that fails.
    Also, check the DRM module name that it matches i915 and not the
    older i830 driver which some people were still trying to use
    and was causing Dma Initialization failures and lockups.

commit 7ff7cec9220815eb5f74cfd95860aaa5f1f263bd
Author: Egbert Eich <eich@suse.de>
Date:   Mon Jan 24 15:02:17 2005 +0000

    Unmap XCursor AGP memory on VT switch to prevent system from lockup
    (Matthias Hopf).

commit d4c87adf6792ae9af641b9824c547d18cdd1e521
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Mon Jan 10 11:29:02 2005 +0000

    Revert some changes to TweakMemorySize

commit 076c5116ae5eda1822da70184cbcc8942b470541
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Thu Jan 6 14:43:14 2005 +0000

    Add:
    - Intel i915GM support to 2D DDX and 3D Mesa drivers.
    - PanelID identification
    - DRI suspend/resume support
    - Detection of monitor changes on VT switches
    - Support custom video modes if available in the Video BIOS
    - 3D enhancements:
    	* GL_ARB_texture_cube_map
    	* GL_EXT_blend_equation_separate
    	* GL_ATI_blend_equation_separate
    	* GL_ARB_point_parameters
    	* GL_NV_blend_square
    	* GL_EXT_cull_vertex
    	* GL_ARB_depth_texture
    	* GL_SGIX_depth_texture
    	* GL_ARB_shadow
    	* GL_EXT_shadow_funcs
    	* GL_3DFX_texture_compression_FXT1
    By Tungsten Graphics, Keith Whitwell & Alan Hourihane.

commit edb9b6fde0948bb1121a8456500ef9f55f734376
Author: Adam Jackson <ajax@nwnk.net>
Date:   Mon Jan 3 16:03:56 2005 +0000

    Bug #1488: Fix crash on i830 during startup.  (Eric Anholt)

commit 59cecb714b78f7f384c24bf159bd39c81e9c7ee1
Author: Markus Kuhn <Markus.Kuhn@cl.cam.ac.uk>
Date:   Sat Dec 4 00:43:09 2004 +0000

    Encoding of numerous files changed to UTF-8

commit c24b0e04f3a1b064412e0bea44c4af546ec9fb77
Author: Egbert Eich <eich@suse.de>
Date:   Tue Nov 2 08:54:53 2004 +0000

    Fixed KGA handling for i810. KGA handling for chips derived from C&T chips is
    slightly different. The changes make the code consistent with the C&T (chips)
    and i740 drivers.

commit 7ce4898ee319d149cf86e938e7257ea7490d327f
Author: Egbert Eich <eich@suse.de>
Date:   Wed Oct 27 09:52:15 2004 +0000

    Removing vtSema shilding of accel sync - should have been '&&' instead of '||'
    anyway.

commit 88714c3b2274fcfe50837631b1d38a7cd96f692a
Author: Egbert Eich <eich@suse.de>
Date:   Tue Oct 12 19:13:43 2004 +0000

    Change order of SetDisplayDevice(), HWRestore(), UnbindGART() and
    RestoreBIOSMemSize() to be exactly opposite to the Save procedure in EnterVT()
    (Matthias Hopf, Alan Hourihane).
    Fixed server crash on reset when a structure allocated in PreInit() was freed on
    CloseScreen().
    Fixed ring buffer lock ups that happened because the structure that contained
    ringbuffer data was not zeroed after allocation.
    Fixed numerous warnings due to signed unsigned comparisons.

commit 687298daed40aaade44e61342a9abe984088541b
Author: Egbert Eich <eich@suse.de>
Date:   Mon Oct 11 09:58:04 2004 +0000

    Checking if server isn't switched away before calling sync.
    Sanity check for possible bugs in aother areas of the code.
    Fixing default amount of of allocated video memory from AGP for i810: Use 16MB
    if less than 192MB are installed else use 24MB (Matthias Hopf).

commit d2866271b8d42a0d44b65e30667adab96ac8fd54
Author: Adam Jackson <ajax@nwnk.net>
Date:   Wed Sep 22 04:38:03 2004 +0000

    Bug #1252, #1253, #1255, #1256: Various typo fixes from Dave Jones.

commit 88fd270d23ed1a1761cfdb98367c89ca89735b12
Author: Adam Jackson <ajax@nwnk.net>
Date:   Fri Sep 17 03:04:51 2004 +0000

    Bug #1192: Remove cfb support from drivers where its use is an option.
    Delete xf24_32bpp, as s3virge was the last user.  Fix up some comments
    to refer to fb rather than cfb.

commit 9e8e19c6fde15fe5b9bb7532316dedeeca54b8d9
Author: Kevin E Martin <kem@redhat.com>
Date:   Mon Aug 30 03:19:08 2004 +0000

    Fix ARGB cursor problem on i810 (Bug #1195, Alan Hourihane).

commit 15c61546ea1a64d6c7dd60764164143ea7174123
Author: Kevin E Martin <kem@redhat.com>
Date:   Thu Aug 26 05:10:56 2004 +0000

    Fix i810 compilation without Xinerama (Bug #1180, Simon Schubert).

commit 828c0fb8050dcbed8026365cbcb17d4d4330c268
Author: Kevin E Martin <kem@redhat.com>
Date:   Wed Aug 25 00:30:41 2004 +0000

    Fix i810 driver startup on Sony VAIO laptop (Bug #1084, Dave Airlie).

commit c4626af83d760c2a6aae90ad478430eac1c4f4ea
Author: Egbert Eich <eich@suse.de>
Date:   Fri Jul 30 21:36:40 2004 +0000

    Do I810EmitFlush() during screen init to make sure 2D engine is in a sane state
    (Peter Kunzmann).

commit e0e01b7d6188a83c7539256ac1710ace04ce132a
Author: Egbert Eich <eich@suse.de>
Date:   Fri Jul 30 20:38:27 2004 +0000

    add i845 to the list of chips that allow memory size tweaking.

commit 199620cdc924e6aa98683e305843ea91c7e1771d
Author: Adam Jackson <ajax@nwnk.net>
Date:   Fri Jul 30 20:30:52 2004 +0000

    Bug #400 (partial): Driver fixes for the dlloader.  When using
    dlloader, all framebuffer formats except cfb and the overlay modes
    should work, and r128 and radeon need to be loaded from the ati
    driver (both issues to be fixed soon).  Tested on i740, s3virge,
    mach64, tdfx, vesa, and vga drivers.  elfloader users shouldn't be
    affected.

commit 54e644ffbb63290b7e2ec51b041f5b2df26e164b
Author: Egbert Eich <eich@suse.de>
Date:   Fri Jul 30 19:04:14 2004 +0000

    Removed bugs on TweakMemorySize() which prevented it from working at all.
    Initialized last element of BIOS version number string to 0 to avoid random
    problems.

commit 3a3b00f18ac5edd7dfef06a96342c95f3cb97f79
Author: Kevin E Martin <kem@redhat.com>
Date:   Fri Jul 30 04:44:13 2004 +0000

    Fix "DoLoadableServer NO" build

commit 986bc24892e7ce3784fc723fda54b1f89dd75b66
Author: Egbert Eich <eich@suse.de>
Date:   Tue Jul 6 14:37:47 2004 +0000

    Increase default video RAM size to 16MB when DRI is enabled and more than 128MB
    are available (Egbert Eich).
    Fixed lockups during mode switch. Problem was introduced when attempting to copy
    the behavior during LeaveVT()/EnterVT() but but forgetting to call
    I810DRILeave() before I810DRIEnter(). The entire DRILeave()/Enter() scenario has
    been commented out as it didn't seem to be necessary (Egbert Eich).
    Fix TweakMemorySize() (tested with i855/i865) (Egbert Eich).

commit b7310758e60956a7de14dcf968bb713dfc56738f
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jun 22 15:12:42 2004 +0000

    add CmdBuffer

commit 5ed7e6f8424236dd57d83f6ab1282693260969cb
Author: Alan Hourihane <alanh@fairlite.demon.co.uk>
Date:   Tue Jun 22 14:28:46 2004 +0000

    i915 support
    Dual Head support for i830, i855, i915.
    ARGB cursor support (including i810) for all chipsets.

commit a46e95722d3c2b9dfb9eacf9a390a7c47d427773
Author: Eric Anholt <anholt@freebsd.org>
Date:   Wed Jun 16 19:16:54 2004 +0000

    Mop-up from the DRI 20040613 import, taking care of some drm.h
    header location and type changes, and update the ChangeLog.

commit 35a5cf103e9e41d178f980f685307f8c8063a006
Author: Eric Anholt <anholt@freebsd.org>
Date:   Wed Jun 16 09:44:00 2004 +0000

    Merge DRI-trunk-20040613 changes in programs/Xserver/hw/xfree86/drivers, with
    the following notes:
    
    - Savage and Mach64 (= ati/ati*.[ch] changes) DRI not merged due to insecurity.
    - VIA driver converted to new drmContext and drmHandle names.
    - Radeon driver merge conflicted in many places, and MergedFB at least could
      probably use some checking at this point.

commit bec47f9369b6f02ce4537ab1ac547ba933609edc
Author: Eric Anholt <anholt@freebsd.org>
Date:   Wed Jun 16 09:26:18 2004 +0000

    DRI trunk-20040613 import

commit c5b1972b50a6dbe57c67d3cc88ae010386b908a6
Author: Eric Anholt <anholt@freebsd.org>
Date:   Wed Jun 16 09:23:18 2004 +0000

    DRI XFree86-4_3_99_12-merge import

commit 41eba03d0d62fe03a7b437c9c4914016c3125141
Author: Egbert Eich <eich@suse.de>
Date:   Fri Apr 23 19:35:55 2004 +0000

    Merging XORG-CURRENT into trunk

commit e27494f2a9262b6310c2f1e0a40c406f578fc693
Author: Egbert Eich <eich@suse.de>
Date:   Sun Mar 14 08:33:22 2004 +0000

    Importing vendor version xf86-4_4_99_1 on Sun Mar 14 00:26:39 PST 2004

commit 5ece535dc7f77185cc8c327a57ae3c02c8b9f918
Author: Egbert Eich <eich@suse.de>
Date:   Wed Mar 3 12:12:19 2004 +0000

    Importing vendor version xf86-4_4_0 on Wed Mar  3 04:09:24 PST 2004

commit ba904078dd22e013f4112479e7c2669c33e708a8
Author: Egbert Eich <eich@suse.de>
Date:   Thu Feb 26 13:35:53 2004 +0000

    readding XFree86's cvs IDs

commit 13ea363db30dc0010cd09df29df90074db77f646
Author: Egbert Eich <eich@suse.de>
Date:   Thu Feb 26 09:23:19 2004 +0000

    Importing vendor version xf86-4_3_99_903 on Wed Feb 26 01:21:00 PST 2004

commit 64b129e800d915f0d82a67ce0f8b1850e67012fc
Author: Egbert Eich <eich@suse.de>
Date:   Thu Jan 29 08:08:35 2004 +0000

    Importing vendor version xf86-012804-2330 on Thu Jan 29 00:06:33 PST 2004

commit 64d7bbf0ac060a57761aa2ecf21ddbe8169674c0
Author: Kaleb Keithley <kaleb@freedesktop.org>
Date:   Fri Dec 19 20:55:10 2003 +0000

    XFree86 4.3.99.902 (RC 2)

commit 418eaaee109acd3ea178b147dd29f90318d159f9
Author: Kaleb Keithley <kaleb@freedesktop.org>
Date:   Thu Dec 4 22:03:17 2003 +0000

    XFree86 4.3.99.901 (RC 1)

commit 72063c52b82faf80a0183f66d2fd5789def76d8f
Author: Kaleb Keithley <kaleb@freedesktop.org>
Date:   Tue Nov 25 19:28:37 2003 +0000

    XFree86 4.3.99.16
    Bring the tree up to date for the Cygwin folks

commit e04a1a8f862eb63b546fb74e73ee602fefb82e00
Author: Kaleb Keithley <kaleb@freedesktop.org>
Date:   Fri Nov 14 16:48:55 2003 +0000

    XFree86 4.3.0.1

commit 3ad0d9a73bc0a4f3edb858d5f3a7c36827b7a429
Author: Kaleb Keithley <kaleb@freedesktop.org>
Date:   Fri Nov 14 16:48:55 2003 +0000

    Initial revision
