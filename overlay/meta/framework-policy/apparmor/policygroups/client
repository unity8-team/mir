# Description: clients are allowed to use mir
# Usage: common
# Actual interface with clients!
@{CLICK_DIR}/@PACKAGE@/*/bin/mir-run ixr,

# This lets mir-run access client-platform libraries
@{CLICK_DIR}/@PACKAGE@/*/debs/usr/lib/ r,
@{CLICK_DIR}/@PACKAGE@/*/debs/usr/lib/*/mir/client-platform/ r,
@{CLICK_DIR}/@PACKAGE@/*/debs/usr/lib/*/mir/client-platform/* r,

# Socket to talk on
/run/mir_socket rw,
unix (connect, send, receive) peer=(label=@PACKAGE@_system-compositor_@VERSION@),

# For non-opengl apps
# https://www.kernel.org/doc/gorman/html/understand/understand015.html
/dev/shm/\#* rw,

# udev
deny /etc/udev/udev.conf r,
deny /run/udev/data/* r,

# this is an information leak until AppArmor implements kernel variables
owner @{PROC}/@{pid}/cmdline r,

# FIXME: these should be part of (hw-)assign, not this policy group
/dev/dri/card0 rw, # hardware acceleration
/sys/devices/*/*/*/drm/card0/uevent r,

# FIXME: this is too lenient, please adjust for specific accesses
/sys/devices/*/*/*/uevent r,

/usr/share/applications/ r,
